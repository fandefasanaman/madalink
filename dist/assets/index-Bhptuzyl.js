(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function pk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Jy={exports:{}},ou={},Zy={exports:{}},ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var So=Symbol.for("react.element"),gk=Symbol.for("react.portal"),yk=Symbol.for("react.fragment"),xk=Symbol.for("react.strict_mode"),vk=Symbol.for("react.profiler"),_k=Symbol.for("react.provider"),wk=Symbol.for("react.context"),kk=Symbol.for("react.forward_ref"),bk=Symbol.for("react.suspense"),Ek=Symbol.for("react.memo"),Tk=Symbol.for("react.lazy"),ng=Symbol.iterator;function Ik(t){return t===null||typeof t!="object"?null:(t=ng&&t[ng]||t["@@iterator"],typeof t=="function"?t:null)}var ex={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tx=Object.assign,rx={};function qi(t,e,r){this.props=t,this.context=e,this.refs=rx,this.updater=r||ex}qi.prototype.isReactComponent={};qi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};qi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function nx(){}nx.prototype=qi.prototype;function Tf(t,e,r){this.props=t,this.context=e,this.refs=rx,this.updater=r||ex}var If=Tf.prototype=new nx;If.constructor=Tf;tx(If,qi.prototype);If.isPureReactComponent=!0;var sg=Array.isArray,sx=Object.prototype.hasOwnProperty,Nf={current:null},ix={key:!0,ref:!0,__self:!0,__source:!0};function ax(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)sx.call(e,n)&&!ix.hasOwnProperty(n)&&(s[n]=e[n]);var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(n in c=t.defaultProps,c)s[n]===void 0&&(s[n]=c[n]);return{$$typeof:So,type:t,key:i,ref:a,props:s,_owner:Nf.current}}function Nk(t,e){return{$$typeof:So,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Sf(t){return typeof t=="object"&&t!==null&&t.$$typeof===So}function Sk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var ig=/\/+/g;function pd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Sk(""+t.key):e.toString(36)}function ql(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case So:case gk:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+pd(a,0):n,sg(s)?(r="",t!=null&&(r=t.replace(ig,"$&/")+"/"),ql(s,e,r,"",function(d){return d})):s!=null&&(Sf(s)&&(s=Nk(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(ig,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",sg(t))for(var c=0;c<t.length;c++){i=t[c];var u=n+pd(i,c);a+=ql(i,e,r,u,s)}else if(u=Ik(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=n+pd(i,c++),a+=ql(i,e,r,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function xl(t,e,r){if(t==null)return t;var n=[],s=0;return ql(t,n,"","",function(i){return e.call(r,i,s++)}),n}function Ak(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var vt={current:null},Hl={transition:null},Ck={ReactCurrentDispatcher:vt,ReactCurrentBatchConfig:Hl,ReactCurrentOwner:Nf};function ox(){throw Error("act(...) is not supported in production builds of React.")}ne.Children={map:xl,forEach:function(t,e,r){xl(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return xl(t,function(){e++}),e},toArray:function(t){return xl(t,function(e){return e})||[]},only:function(t){if(!Sf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ne.Component=qi;ne.Fragment=yk;ne.Profiler=vk;ne.PureComponent=Tf;ne.StrictMode=xk;ne.Suspense=bk;ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ck;ne.act=ox;ne.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=tx({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Nf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)sx.call(e,u)&&!ix.hasOwnProperty(u)&&(n[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];n.children=c}return{$$typeof:So,type:t.type,key:s,ref:i,props:n,_owner:a}};ne.createContext=function(t){return t={$$typeof:wk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_k,_context:t},t.Consumer=t};ne.createElement=ax;ne.createFactory=function(t){var e=ax.bind(null,t);return e.type=t,e};ne.createRef=function(){return{current:null}};ne.forwardRef=function(t){return{$$typeof:kk,render:t}};ne.isValidElement=Sf;ne.lazy=function(t){return{$$typeof:Tk,_payload:{_status:-1,_result:t},_init:Ak}};ne.memo=function(t,e){return{$$typeof:Ek,type:t,compare:e===void 0?null:e}};ne.startTransition=function(t){var e=Hl.transition;Hl.transition={};try{t()}finally{Hl.transition=e}};ne.unstable_act=ox;ne.useCallback=function(t,e){return vt.current.useCallback(t,e)};ne.useContext=function(t){return vt.current.useContext(t)};ne.useDebugValue=function(){};ne.useDeferredValue=function(t){return vt.current.useDeferredValue(t)};ne.useEffect=function(t,e){return vt.current.useEffect(t,e)};ne.useId=function(){return vt.current.useId()};ne.useImperativeHandle=function(t,e,r){return vt.current.useImperativeHandle(t,e,r)};ne.useInsertionEffect=function(t,e){return vt.current.useInsertionEffect(t,e)};ne.useLayoutEffect=function(t,e){return vt.current.useLayoutEffect(t,e)};ne.useMemo=function(t,e){return vt.current.useMemo(t,e)};ne.useReducer=function(t,e,r){return vt.current.useReducer(t,e,r)};ne.useRef=function(t){return vt.current.useRef(t)};ne.useState=function(t){return vt.current.useState(t)};ne.useSyncExternalStore=function(t,e,r){return vt.current.useSyncExternalStore(t,e,r)};ne.useTransition=function(){return vt.current.useTransition()};ne.version="18.3.1";Zy.exports=ne;var L=Zy.exports;const Af=pk(L);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rk=L,Pk=Symbol.for("react.element"),jk=Symbol.for("react.fragment"),Dk=Object.prototype.hasOwnProperty,Ok=Rk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Vk={key:!0,ref:!0,__self:!0,__source:!0};function lx(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Dk.call(e,n)&&!Vk.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:Pk,type:t,key:i,ref:a,props:s,_owner:Ok.current}}ou.Fragment=jk;ou.jsx=lx;ou.jsxs=lx;Jy.exports=ou;var o=Jy.exports,cx={exports:{}},zt={},ux={exports:{}},dx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,Y){var ee=$.length;$.push(Y);e:for(;0<ee;){var _e=ee-1>>>1,he=$[_e];if(0<s(he,Y))$[_e]=Y,$[ee]=he,ee=_e;else break e}}function r($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var Y=$[0],ee=$.pop();if(ee!==Y){$[0]=ee;e:for(var _e=0,he=$.length,Ne=he>>>1;_e<Ne;){var $t=2*(_e+1)-1,nr=$[$t],qt=$t+1,sr=$[qt];if(0>s(nr,ee))qt<he&&0>s(sr,nr)?($[_e]=sr,$[qt]=ee,_e=qt):($[_e]=nr,$[$t]=ee,_e=$t);else if(qt<he&&0>s(sr,ee))$[_e]=sr,$[qt]=ee,_e=qt;else break e}}return Y}function s($,Y){var ee=$.sortIndex-Y.sortIndex;return ee!==0?ee:$.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var u=[],d=[],f=1,g=null,p=3,_=!1,A=!1,P=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I($){for(var Y=r(d);Y!==null;){if(Y.callback===null)n(d);else if(Y.startTime<=$)n(d),Y.sortIndex=Y.expirationTime,e(u,Y);else break;Y=r(d)}}function N($){if(P=!1,I($),!A)if(r(u)!==null)A=!0,xr(O);else{var Y=r(d);Y!==null&&Rt(N,Y.startTime-$)}}function O($,Y){A=!1,P&&(P=!1,w(y),y=-1),_=!0;var ee=p;try{for(I(Y),g=r(u);g!==null&&(!(g.expirationTime>Y)||$&&!C());){var _e=g.callback;if(typeof _e=="function"){g.callback=null,p=g.priorityLevel;var he=_e(g.expirationTime<=Y);Y=t.unstable_now(),typeof he=="function"?g.callback=he:g===r(u)&&n(u),I(Y)}else n(u);g=r(u)}if(g!==null)var Ne=!0;else{var $t=r(d);$t!==null&&Rt(N,$t.startTime-Y),Ne=!1}return Ne}finally{g=null,p=ee,_=!1}}var F=!1,x=null,y=-1,E=5,T=-1;function C(){return!(t.unstable_now()-T<E)}function R(){if(x!==null){var $=t.unstable_now();T=$;var Y=!0;try{Y=x(!0,$)}finally{Y?b():(F=!1,x=null)}}else F=!1}var b;if(typeof k=="function")b=function(){k(R)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,rr=ce.port2;ce.port1.onmessage=R,b=function(){rr.postMessage(null)}}else b=function(){S(R,0)};function xr($){x=$,F||(F=!0,b())}function Rt($,Y){y=S(function(){$(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){A||_||(A=!0,xr(O))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function($){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var ee=p;p=Y;try{return $()}finally{p=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,Y){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ee=p;p=$;try{return Y()}finally{p=ee}},t.unstable_scheduleCallback=function($,Y,ee){var _e=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?_e+ee:_e):ee=_e,$){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=ee+he,$={id:f++,callback:Y,priorityLevel:$,startTime:ee,expirationTime:he,sortIndex:-1},ee>_e?($.sortIndex=ee,e(d,$),r(u)===null&&$===r(d)&&(P?(w(y),y=-1):P=!0,Rt(N,ee-_e))):($.sortIndex=he,e(u,$),A||_||(A=!0,xr(O))),$},t.unstable_shouldYield=C,t.unstable_wrapCallback=function($){var Y=p;return function(){var ee=p;p=Y;try{return $.apply(this,arguments)}finally{p=ee}}}})(dx);ux.exports=dx;var Mk=ux.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lk=L,Ut=Mk;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hx=new Set,Za={};function Ls(t,e){Ci(t,e),Ci(t+"Capture",e)}function Ci(t,e){for(Za[t]=e,t=0;t<e.length;t++)hx.add(e[t])}var Jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nh=Object.prototype.hasOwnProperty,Fk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ag={},og={};function Uk(t){return nh.call(og,t)?!0:nh.call(ag,t)?!1:Fk.test(t)?og[t]=!0:(ag[t]=!0,!1)}function zk(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Bk(t,e,r,n){if(e===null||typeof e>"u"||zk(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function _t(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){nt[t]=new _t(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];nt[e]=new _t(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){nt[t]=new _t(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){nt[t]=new _t(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){nt[t]=new _t(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){nt[t]=new _t(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){nt[t]=new _t(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){nt[t]=new _t(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){nt[t]=new _t(t,5,!1,t.toLowerCase(),null,!1,!1)});var Cf=/[\-:]([a-z])/g;function Rf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Cf,Rf);nt[e]=new _t(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Cf,Rf);nt[e]=new _t(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Cf,Rf);nt[e]=new _t(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){nt[t]=new _t(t,1,!1,t.toLowerCase(),null,!1,!1)});nt.xlinkHref=new _t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){nt[t]=new _t(t,1,!1,t.toLowerCase(),null,!0,!0)});function Pf(t,e,r,n){var s=nt.hasOwnProperty(e)?nt[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Bk(e,r,s,n)&&(r=null),n||s===null?Uk(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ln=Lk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vl=Symbol.for("react.element"),oi=Symbol.for("react.portal"),li=Symbol.for("react.fragment"),jf=Symbol.for("react.strict_mode"),sh=Symbol.for("react.profiler"),fx=Symbol.for("react.provider"),mx=Symbol.for("react.context"),Df=Symbol.for("react.forward_ref"),ih=Symbol.for("react.suspense"),ah=Symbol.for("react.suspense_list"),Of=Symbol.for("react.memo"),xn=Symbol.for("react.lazy"),px=Symbol.for("react.offscreen"),lg=Symbol.iterator;function va(t){return t===null||typeof t!="object"?null:(t=lg&&t[lg]||t["@@iterator"],typeof t=="function"?t:null)}var Re=Object.assign,gd;function Sa(t){if(gd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);gd=e&&e[1]||""}return`
`+gd+t}var yd=!1;function xd(t,e){if(!t||yd)return"";yd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,c=i.length-1;1<=a&&0<=c&&s[a]!==i[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==i[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==i[c]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=c);break}}}finally{yd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Sa(t):""}function $k(t){switch(t.tag){case 5:return Sa(t.type);case 16:return Sa("Lazy");case 13:return Sa("Suspense");case 19:return Sa("SuspenseList");case 0:case 2:case 15:return t=xd(t.type,!1),t;case 11:return t=xd(t.type.render,!1),t;case 1:return t=xd(t.type,!0),t;default:return""}}function oh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case li:return"Fragment";case oi:return"Portal";case sh:return"Profiler";case jf:return"StrictMode";case ih:return"Suspense";case ah:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mx:return(t.displayName||"Context")+".Consumer";case fx:return(t._context.displayName||"Context")+".Provider";case Df:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Of:return e=t.displayName||null,e!==null?e:oh(t.type)||"Memo";case xn:e=t._payload,t=t._init;try{return oh(t(e))}catch{}}return null}function qk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oh(e);case 8:return e===jf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function gx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Hk(t){var e=gx(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function _l(t){t._valueTracker||(t._valueTracker=Hk(t))}function yx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=gx(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function hc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function lh(t,e){var r=e.checked;return Re({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function cg(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=zn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function xx(t,e){e=e.checked,e!=null&&Pf(t,"checked",e,!1)}function ch(t,e){xx(t,e);var r=zn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?uh(t,e.type,r):e.hasOwnProperty("defaultValue")&&uh(t,e.type,zn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ug(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function uh(t,e,r){(e!=="number"||hc(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Aa=Array.isArray;function _i(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+zn(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function dh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return Re({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function dg(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(U(92));if(Aa(r)){if(1<r.length)throw Error(U(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:zn(r)}}function vx(t,e){var r=zn(e.value),n=zn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function hg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function _x(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?_x(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var wl,wx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(wl=wl||document.createElement("div"),wl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=wl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function eo(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var La={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wk=["Webkit","ms","Moz","O"];Object.keys(La).forEach(function(t){Wk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),La[e]=La[t]})});function kx(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||La.hasOwnProperty(t)&&La[t]?(""+e).trim():e+"px"}function bx(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=kx(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var Kk=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fh(t,e){if(e){if(Kk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function mh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ph=null;function Vf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var gh=null,wi=null,ki=null;function fg(t){if(t=Ro(t)){if(typeof gh!="function")throw Error(U(280));var e=t.stateNode;e&&(e=hu(e),gh(t.stateNode,t.type,e))}}function Ex(t){wi?ki?ki.push(t):ki=[t]:wi=t}function Tx(){if(wi){var t=wi,e=ki;if(ki=wi=null,fg(t),e)for(t=0;t<e.length;t++)fg(e[t])}}function Ix(t,e){return t(e)}function Nx(){}var vd=!1;function Sx(t,e,r){if(vd)return t(e,r);vd=!0;try{return Ix(t,e,r)}finally{vd=!1,(wi!==null||ki!==null)&&(Nx(),Tx())}}function to(t,e){var r=t.stateNode;if(r===null)return null;var n=hu(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(U(231,e,typeof r));return r}var yh=!1;if(Jr)try{var _a={};Object.defineProperty(_a,"passive",{get:function(){yh=!0}}),window.addEventListener("test",_a,_a),window.removeEventListener("test",_a,_a)}catch{yh=!1}function Gk(t,e,r,n,s,i,a,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(f){this.onError(f)}}var Fa=!1,fc=null,mc=!1,xh=null,Qk={onError:function(t){Fa=!0,fc=t}};function Yk(t,e,r,n,s,i,a,c,u){Fa=!1,fc=null,Gk.apply(Qk,arguments)}function Xk(t,e,r,n,s,i,a,c,u){if(Yk.apply(this,arguments),Fa){if(Fa){var d=fc;Fa=!1,fc=null}else throw Error(U(198));mc||(mc=!0,xh=d)}}function Fs(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Ax(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function mg(t){if(Fs(t)!==t)throw Error(U(188))}function Jk(t){var e=t.alternate;if(!e){if(e=Fs(t),e===null)throw Error(U(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return mg(s),t;if(i===n)return mg(s),e;i=i.sibling}throw Error(U(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,c=s.child;c;){if(c===r){a=!0,r=s,n=i;break}if(c===n){a=!0,n=s,r=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===r){a=!0,r=i,n=s;break}if(c===n){a=!0,n=i,r=s;break}c=c.sibling}if(!a)throw Error(U(189))}}if(r.alternate!==n)throw Error(U(190))}if(r.tag!==3)throw Error(U(188));return r.stateNode.current===r?t:e}function Cx(t){return t=Jk(t),t!==null?Rx(t):null}function Rx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Rx(t);if(e!==null)return e;t=t.sibling}return null}var Px=Ut.unstable_scheduleCallback,pg=Ut.unstable_cancelCallback,Zk=Ut.unstable_shouldYield,eb=Ut.unstable_requestPaint,Me=Ut.unstable_now,tb=Ut.unstable_getCurrentPriorityLevel,Mf=Ut.unstable_ImmediatePriority,jx=Ut.unstable_UserBlockingPriority,pc=Ut.unstable_NormalPriority,rb=Ut.unstable_LowPriority,Dx=Ut.unstable_IdlePriority,lu=null,Tr=null;function nb(t){if(Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(lu,t,void 0,(t.current.flags&128)===128)}catch{}}var fr=Math.clz32?Math.clz32:ab,sb=Math.log,ib=Math.LN2;function ab(t){return t>>>=0,t===0?32:31-(sb(t)/ib|0)|0}var kl=64,bl=4194304;function Ca(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function gc(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var c=a&~s;c!==0?n=Ca(c):(i&=a,i!==0&&(n=Ca(i)))}else a=r&~s,a!==0?n=Ca(a):i!==0&&(n=Ca(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-fr(e),s=1<<r,n|=t[r],e&=~s;return n}function ob(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lb(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-fr(i),c=1<<a,u=s[a];u===-1?(!(c&r)||c&n)&&(s[a]=ob(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function vh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Ox(){var t=kl;return kl<<=1,!(kl&4194240)&&(kl=64),t}function _d(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Ao(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-fr(e),t[e]=r}function cb(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-fr(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function Lf(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-fr(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var me=0;function Vx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Mx,Ff,Lx,Fx,Ux,_h=!1,El=[],An=null,Cn=null,Rn=null,ro=new Map,no=new Map,_n=[],ub="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gg(t,e){switch(t){case"focusin":case"focusout":An=null;break;case"dragenter":case"dragleave":Cn=null;break;case"mouseover":case"mouseout":Rn=null;break;case"pointerover":case"pointerout":ro.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":no.delete(e.pointerId)}}function wa(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ro(e),e!==null&&Ff(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function db(t,e,r,n,s){switch(e){case"focusin":return An=wa(An,t,e,r,n,s),!0;case"dragenter":return Cn=wa(Cn,t,e,r,n,s),!0;case"mouseover":return Rn=wa(Rn,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return ro.set(i,wa(ro.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,no.set(i,wa(no.get(i)||null,t,e,r,n,s)),!0}return!1}function zx(t){var e=ps(t.target);if(e!==null){var r=Fs(e);if(r!==null){if(e=r.tag,e===13){if(e=Ax(r),e!==null){t.blockedOn=e,Ux(t.priority,function(){Lx(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=wh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);ph=n,r.target.dispatchEvent(n),ph=null}else return e=Ro(r),e!==null&&Ff(e),t.blockedOn=r,!1;e.shift()}return!0}function yg(t,e,r){Wl(t)&&r.delete(e)}function hb(){_h=!1,An!==null&&Wl(An)&&(An=null),Cn!==null&&Wl(Cn)&&(Cn=null),Rn!==null&&Wl(Rn)&&(Rn=null),ro.forEach(yg),no.forEach(yg)}function ka(t,e){t.blockedOn===e&&(t.blockedOn=null,_h||(_h=!0,Ut.unstable_scheduleCallback(Ut.unstable_NormalPriority,hb)))}function so(t){function e(s){return ka(s,t)}if(0<El.length){ka(El[0],t);for(var r=1;r<El.length;r++){var n=El[r];n.blockedOn===t&&(n.blockedOn=null)}}for(An!==null&&ka(An,t),Cn!==null&&ka(Cn,t),Rn!==null&&ka(Rn,t),ro.forEach(e),no.forEach(e),r=0;r<_n.length;r++)n=_n[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<_n.length&&(r=_n[0],r.blockedOn===null);)zx(r),r.blockedOn===null&&_n.shift()}var bi=ln.ReactCurrentBatchConfig,yc=!0;function fb(t,e,r,n){var s=me,i=bi.transition;bi.transition=null;try{me=1,Uf(t,e,r,n)}finally{me=s,bi.transition=i}}function mb(t,e,r,n){var s=me,i=bi.transition;bi.transition=null;try{me=4,Uf(t,e,r,n)}finally{me=s,bi.transition=i}}function Uf(t,e,r,n){if(yc){var s=wh(t,e,r,n);if(s===null)Cd(t,e,n,xc,r),gg(t,n);else if(db(s,t,e,r,n))n.stopPropagation();else if(gg(t,n),e&4&&-1<ub.indexOf(t)){for(;s!==null;){var i=Ro(s);if(i!==null&&Mx(i),i=wh(t,e,r,n),i===null&&Cd(t,e,n,xc,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Cd(t,e,n,null,r)}}var xc=null;function wh(t,e,r,n){if(xc=null,t=Vf(n),t=ps(t),t!==null)if(e=Fs(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Ax(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return xc=t,null}function Bx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tb()){case Mf:return 1;case jx:return 4;case pc:case rb:return 16;case Dx:return 536870912;default:return 16}default:return 16}}var In=null,zf=null,Kl=null;function $x(){if(Kl)return Kl;var t,e=zf,r=e.length,n,s="value"in In?In.value:In.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return Kl=s.slice(t,1<n?1-n:void 0)}function Gl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Tl(){return!0}function xg(){return!1}function Bt(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(r=t[c],this[c]=r?r(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Tl:xg,this.isPropagationStopped=xg,this}return Re(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Tl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Tl)},persist:function(){},isPersistent:Tl}),e}var Hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bf=Bt(Hi),Co=Re({},Hi,{view:0,detail:0}),pb=Bt(Co),wd,kd,ba,cu=Re({},Co,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$f,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ba&&(ba&&t.type==="mousemove"?(wd=t.screenX-ba.screenX,kd=t.screenY-ba.screenY):kd=wd=0,ba=t),wd)},movementY:function(t){return"movementY"in t?t.movementY:kd}}),vg=Bt(cu),gb=Re({},cu,{dataTransfer:0}),yb=Bt(gb),xb=Re({},Co,{relatedTarget:0}),bd=Bt(xb),vb=Re({},Hi,{animationName:0,elapsedTime:0,pseudoElement:0}),_b=Bt(vb),wb=Re({},Hi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),kb=Bt(wb),bb=Re({},Hi,{data:0}),_g=Bt(bb),Eb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ib={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Ib[t])?!!e[t]:!1}function $f(){return Nb}var Sb=Re({},Co,{key:function(t){if(t.key){var e=Eb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Gl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Tb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$f,charCode:function(t){return t.type==="keypress"?Gl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Gl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ab=Bt(Sb),Cb=Re({},cu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wg=Bt(Cb),Rb=Re({},Co,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$f}),Pb=Bt(Rb),jb=Re({},Hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Db=Bt(jb),Ob=Re({},cu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Vb=Bt(Ob),Mb=[9,13,27,32],qf=Jr&&"CompositionEvent"in window,Ua=null;Jr&&"documentMode"in document&&(Ua=document.documentMode);var Lb=Jr&&"TextEvent"in window&&!Ua,qx=Jr&&(!qf||Ua&&8<Ua&&11>=Ua),kg=" ",bg=!1;function Hx(t,e){switch(t){case"keyup":return Mb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ci=!1;function Fb(t,e){switch(t){case"compositionend":return Wx(e);case"keypress":return e.which!==32?null:(bg=!0,kg);case"textInput":return t=e.data,t===kg&&bg?null:t;default:return null}}function Ub(t,e){if(ci)return t==="compositionend"||!qf&&Hx(t,e)?(t=$x(),Kl=zf=In=null,ci=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qx&&e.locale!=="ko"?null:e.data;default:return null}}var zb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Eg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!zb[t.type]:e==="textarea"}function Kx(t,e,r,n){Ex(n),e=vc(e,"onChange"),0<e.length&&(r=new Bf("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var za=null,io=null;function Bb(t){sv(t,0)}function uu(t){var e=hi(t);if(yx(e))return t}function $b(t,e){if(t==="change")return e}var Gx=!1;if(Jr){var Ed;if(Jr){var Td="oninput"in document;if(!Td){var Tg=document.createElement("div");Tg.setAttribute("oninput","return;"),Td=typeof Tg.oninput=="function"}Ed=Td}else Ed=!1;Gx=Ed&&(!document.documentMode||9<document.documentMode)}function Ig(){za&&(za.detachEvent("onpropertychange",Qx),io=za=null)}function Qx(t){if(t.propertyName==="value"&&uu(io)){var e=[];Kx(e,io,t,Vf(t)),Sx(Bb,e)}}function qb(t,e,r){t==="focusin"?(Ig(),za=e,io=r,za.attachEvent("onpropertychange",Qx)):t==="focusout"&&Ig()}function Hb(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return uu(io)}function Wb(t,e){if(t==="click")return uu(e)}function Kb(t,e){if(t==="input"||t==="change")return uu(e)}function Gb(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pr=typeof Object.is=="function"?Object.is:Gb;function ao(t,e){if(pr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!nh.call(e,s)||!pr(t[s],e[s]))return!1}return!0}function Ng(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Sg(t,e){var r=Ng(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ng(r)}}function Yx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Yx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Xx(){for(var t=window,e=hc();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=hc(t.document)}return e}function Hf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Qb(t){var e=Xx(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Yx(r.ownerDocument.documentElement,r)){if(n!==null&&Hf(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=Sg(r,i);var a=Sg(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Yb=Jr&&"documentMode"in document&&11>=document.documentMode,ui=null,kh=null,Ba=null,bh=!1;function Ag(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;bh||ui==null||ui!==hc(n)||(n=ui,"selectionStart"in n&&Hf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ba&&ao(Ba,n)||(Ba=n,n=vc(kh,"onSelect"),0<n.length&&(e=new Bf("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=ui)))}function Il(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var di={animationend:Il("Animation","AnimationEnd"),animationiteration:Il("Animation","AnimationIteration"),animationstart:Il("Animation","AnimationStart"),transitionend:Il("Transition","TransitionEnd")},Id={},Jx={};Jr&&(Jx=document.createElement("div").style,"AnimationEvent"in window||(delete di.animationend.animation,delete di.animationiteration.animation,delete di.animationstart.animation),"TransitionEvent"in window||delete di.transitionend.transition);function du(t){if(Id[t])return Id[t];if(!di[t])return t;var e=di[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Jx)return Id[t]=e[r];return t}var Zx=du("animationend"),ev=du("animationiteration"),tv=du("animationstart"),rv=du("transitionend"),nv=new Map,Cg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yn(t,e){nv.set(t,e),Ls(e,[t])}for(var Nd=0;Nd<Cg.length;Nd++){var Sd=Cg[Nd],Xb=Sd.toLowerCase(),Jb=Sd[0].toUpperCase()+Sd.slice(1);Yn(Xb,"on"+Jb)}Yn(Zx,"onAnimationEnd");Yn(ev,"onAnimationIteration");Yn(tv,"onAnimationStart");Yn("dblclick","onDoubleClick");Yn("focusin","onFocus");Yn("focusout","onBlur");Yn(rv,"onTransitionEnd");Ci("onMouseEnter",["mouseout","mouseover"]);Ci("onMouseLeave",["mouseout","mouseover"]);Ci("onPointerEnter",["pointerout","pointerover"]);Ci("onPointerLeave",["pointerout","pointerover"]);Ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ls("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ra));function Rg(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Xk(n,e,void 0,t),t.currentTarget=null}function sv(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var c=n[a],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Rg(s,c,d),i=u}else for(a=0;a<n.length;a++){if(c=n[a],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Rg(s,c,d),i=u}}}if(mc)throw t=xh,mc=!1,xh=null,t}function ke(t,e){var r=e[Sh];r===void 0&&(r=e[Sh]=new Set);var n=t+"__bubble";r.has(n)||(iv(e,t,2,!1),r.add(n))}function Ad(t,e,r){var n=0;e&&(n|=4),iv(r,t,n,e)}var Nl="_reactListening"+Math.random().toString(36).slice(2);function oo(t){if(!t[Nl]){t[Nl]=!0,hx.forEach(function(r){r!=="selectionchange"&&(Zb.has(r)||Ad(r,!1,t),Ad(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Nl]||(e[Nl]=!0,Ad("selectionchange",!1,e))}}function iv(t,e,r,n){switch(Bx(e)){case 1:var s=fb;break;case 4:s=mb;break;default:s=Uf}r=s.bind(null,e,r,t),s=void 0,!yh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Cd(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var c=n.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;c!==null;){if(a=ps(c),a===null)return;if(u=a.tag,u===5||u===6){n=i=a;continue e}c=c.parentNode}}n=n.return}Sx(function(){var d=i,f=Vf(r),g=[];e:{var p=nv.get(t);if(p!==void 0){var _=Bf,A=t;switch(t){case"keypress":if(Gl(r)===0)break e;case"keydown":case"keyup":_=Ab;break;case"focusin":A="focus",_=bd;break;case"focusout":A="blur",_=bd;break;case"beforeblur":case"afterblur":_=bd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=vg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=yb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=Pb;break;case Zx:case ev:case tv:_=_b;break;case rv:_=Db;break;case"scroll":_=pb;break;case"wheel":_=Vb;break;case"copy":case"cut":case"paste":_=kb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=wg}var P=(e&4)!==0,S=!P&&t==="scroll",w=P?p!==null?p+"Capture":null:p;P=[];for(var k=d,I;k!==null;){I=k;var N=I.stateNode;if(I.tag===5&&N!==null&&(I=N,w!==null&&(N=to(k,w),N!=null&&P.push(lo(k,N,I)))),S)break;k=k.return}0<P.length&&(p=new _(p,A,null,r,f),g.push({event:p,listeners:P}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",p&&r!==ph&&(A=r.relatedTarget||r.fromElement)&&(ps(A)||A[Zr]))break e;if((_||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,_?(A=r.relatedTarget||r.toElement,_=d,A=A?ps(A):null,A!==null&&(S=Fs(A),A!==S||A.tag!==5&&A.tag!==6)&&(A=null)):(_=null,A=d),_!==A)){if(P=vg,N="onMouseLeave",w="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(P=wg,N="onPointerLeave",w="onPointerEnter",k="pointer"),S=_==null?p:hi(_),I=A==null?p:hi(A),p=new P(N,k+"leave",_,r,f),p.target=S,p.relatedTarget=I,N=null,ps(f)===d&&(P=new P(w,k+"enter",A,r,f),P.target=I,P.relatedTarget=S,N=P),S=N,_&&A)t:{for(P=_,w=A,k=0,I=P;I;I=ri(I))k++;for(I=0,N=w;N;N=ri(N))I++;for(;0<k-I;)P=ri(P),k--;for(;0<I-k;)w=ri(w),I--;for(;k--;){if(P===w||w!==null&&P===w.alternate)break t;P=ri(P),w=ri(w)}P=null}else P=null;_!==null&&Pg(g,p,_,P,!1),A!==null&&S!==null&&Pg(g,S,A,P,!0)}}e:{if(p=d?hi(d):window,_=p.nodeName&&p.nodeName.toLowerCase(),_==="select"||_==="input"&&p.type==="file")var O=$b;else if(Eg(p))if(Gx)O=Kb;else{O=Hb;var F=qb}else(_=p.nodeName)&&_.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(O=Wb);if(O&&(O=O(t,d))){Kx(g,O,r,f);break e}F&&F(t,p,d),t==="focusout"&&(F=p._wrapperState)&&F.controlled&&p.type==="number"&&uh(p,"number",p.value)}switch(F=d?hi(d):window,t){case"focusin":(Eg(F)||F.contentEditable==="true")&&(ui=F,kh=d,Ba=null);break;case"focusout":Ba=kh=ui=null;break;case"mousedown":bh=!0;break;case"contextmenu":case"mouseup":case"dragend":bh=!1,Ag(g,r,f);break;case"selectionchange":if(Yb)break;case"keydown":case"keyup":Ag(g,r,f)}var x;if(qf)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else ci?Hx(t,r)&&(y="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(y="onCompositionStart");y&&(qx&&r.locale!=="ko"&&(ci||y!=="onCompositionStart"?y==="onCompositionEnd"&&ci&&(x=$x()):(In=f,zf="value"in In?In.value:In.textContent,ci=!0)),F=vc(d,y),0<F.length&&(y=new _g(y,t,null,r,f),g.push({event:y,listeners:F}),x?y.data=x:(x=Wx(r),x!==null&&(y.data=x)))),(x=Lb?Fb(t,r):Ub(t,r))&&(d=vc(d,"onBeforeInput"),0<d.length&&(f=new _g("onBeforeInput","beforeinput",null,r,f),g.push({event:f,listeners:d}),f.data=x))}sv(g,e)})}function lo(t,e,r){return{instance:t,listener:e,currentTarget:r}}function vc(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=to(t,r),i!=null&&n.unshift(lo(t,i,s)),i=to(t,e),i!=null&&n.push(lo(t,i,s))),t=t.return}return n}function ri(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Pg(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var c=r,u=c.alternate,d=c.stateNode;if(u!==null&&u===n)break;c.tag===5&&d!==null&&(c=d,s?(u=to(r,i),u!=null&&a.unshift(lo(r,u,c))):s||(u=to(r,i),u!=null&&a.push(lo(r,u,c)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var eE=/\r\n?/g,tE=/\u0000|\uFFFD/g;function jg(t){return(typeof t=="string"?t:""+t).replace(eE,`
`).replace(tE,"")}function Sl(t,e,r){if(e=jg(e),jg(t)!==e&&r)throw Error(U(425))}function _c(){}var Eh=null,Th=null;function Ih(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Nh=typeof setTimeout=="function"?setTimeout:void 0,rE=typeof clearTimeout=="function"?clearTimeout:void 0,Dg=typeof Promise=="function"?Promise:void 0,nE=typeof queueMicrotask=="function"?queueMicrotask:typeof Dg<"u"?function(t){return Dg.resolve(null).then(t).catch(sE)}:Nh;function sE(t){setTimeout(function(){throw t})}function Rd(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),so(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);so(e)}function Pn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Og(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Wi=Math.random().toString(36).slice(2),Er="__reactFiber$"+Wi,co="__reactProps$"+Wi,Zr="__reactContainer$"+Wi,Sh="__reactEvents$"+Wi,iE="__reactListeners$"+Wi,aE="__reactHandles$"+Wi;function ps(t){var e=t[Er];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Zr]||r[Er]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Og(t);t!==null;){if(r=t[Er])return r;t=Og(t)}return e}t=r,r=t.parentNode}return null}function Ro(t){return t=t[Er]||t[Zr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function hi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function hu(t){return t[co]||null}var Ah=[],fi=-1;function Xn(t){return{current:t}}function be(t){0>fi||(t.current=Ah[fi],Ah[fi]=null,fi--)}function ve(t,e){fi++,Ah[fi]=t.current,t.current=e}var Bn={},ft=Xn(Bn),Nt=Xn(!1),Es=Bn;function Ri(t,e){var r=t.type.contextTypes;if(!r)return Bn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function St(t){return t=t.childContextTypes,t!=null}function wc(){be(Nt),be(ft)}function Vg(t,e,r){if(ft.current!==Bn)throw Error(U(168));ve(ft,e),ve(Nt,r)}function av(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(U(108,qk(t)||"Unknown",s));return Re({},r,n)}function kc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Bn,Es=ft.current,ve(ft,t),ve(Nt,Nt.current),!0}function Mg(t,e,r){var n=t.stateNode;if(!n)throw Error(U(169));r?(t=av(t,e,Es),n.__reactInternalMemoizedMergedChildContext=t,be(Nt),be(ft),ve(ft,t)):be(Nt),ve(Nt,r)}var qr=null,fu=!1,Pd=!1;function ov(t){qr===null?qr=[t]:qr.push(t)}function oE(t){fu=!0,ov(t)}function Jn(){if(!Pd&&qr!==null){Pd=!0;var t=0,e=me;try{var r=qr;for(me=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}qr=null,fu=!1}catch(s){throw qr!==null&&(qr=qr.slice(t+1)),Px(Mf,Jn),s}finally{me=e,Pd=!1}}return null}var mi=[],pi=0,bc=null,Ec=0,Wt=[],Kt=0,Ts=null,Hr=1,Wr="";function hs(t,e){mi[pi++]=Ec,mi[pi++]=bc,bc=t,Ec=e}function lv(t,e,r){Wt[Kt++]=Hr,Wt[Kt++]=Wr,Wt[Kt++]=Ts,Ts=t;var n=Hr;t=Wr;var s=32-fr(n)-1;n&=~(1<<s),r+=1;var i=32-fr(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Hr=1<<32-fr(e)+s|r<<s|n,Wr=i+t}else Hr=1<<i|r<<s|n,Wr=t}function Wf(t){t.return!==null&&(hs(t,1),lv(t,1,0))}function Kf(t){for(;t===bc;)bc=mi[--pi],mi[pi]=null,Ec=mi[--pi],mi[pi]=null;for(;t===Ts;)Ts=Wt[--Kt],Wt[Kt]=null,Wr=Wt[--Kt],Wt[Kt]=null,Hr=Wt[--Kt],Wt[Kt]=null}var Lt=null,Ot=null,Te=!1,ur=null;function cv(t,e){var r=Qt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Lg(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Lt=t,Ot=Pn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Lt=t,Ot=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ts!==null?{id:Hr,overflow:Wr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Qt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Lt=t,Ot=null,!0):!1;default:return!1}}function Ch(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Rh(t){if(Te){var e=Ot;if(e){var r=e;if(!Lg(t,e)){if(Ch(t))throw Error(U(418));e=Pn(r.nextSibling);var n=Lt;e&&Lg(t,e)?cv(n,r):(t.flags=t.flags&-4097|2,Te=!1,Lt=t)}}else{if(Ch(t))throw Error(U(418));t.flags=t.flags&-4097|2,Te=!1,Lt=t}}}function Fg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Lt=t}function Al(t){if(t!==Lt)return!1;if(!Te)return Fg(t),Te=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ih(t.type,t.memoizedProps)),e&&(e=Ot)){if(Ch(t))throw uv(),Error(U(418));for(;e;)cv(t,e),e=Pn(e.nextSibling)}if(Fg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ot=Pn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ot=null}}else Ot=Lt?Pn(t.stateNode.nextSibling):null;return!0}function uv(){for(var t=Ot;t;)t=Pn(t.nextSibling)}function Pi(){Ot=Lt=null,Te=!1}function Gf(t){ur===null?ur=[t]:ur.push(t)}var lE=ln.ReactCurrentBatchConfig;function Ea(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(U(309));var n=r.stateNode}if(!n)throw Error(U(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var c=s.refs;a===null?delete c[i]:c[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!r._owner)throw Error(U(290,t))}return t}function Cl(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ug(t){var e=t._init;return e(t._payload)}function dv(t){function e(w,k){if(t){var I=w.deletions;I===null?(w.deletions=[k],w.flags|=16):I.push(k)}}function r(w,k){if(!t)return null;for(;k!==null;)e(w,k),k=k.sibling;return null}function n(w,k){for(w=new Map;k!==null;)k.key!==null?w.set(k.key,k):w.set(k.index,k),k=k.sibling;return w}function s(w,k){return w=Vn(w,k),w.index=0,w.sibling=null,w}function i(w,k,I){return w.index=I,t?(I=w.alternate,I!==null?(I=I.index,I<k?(w.flags|=2,k):I):(w.flags|=2,k)):(w.flags|=1048576,k)}function a(w){return t&&w.alternate===null&&(w.flags|=2),w}function c(w,k,I,N){return k===null||k.tag!==6?(k=Fd(I,w.mode,N),k.return=w,k):(k=s(k,I),k.return=w,k)}function u(w,k,I,N){var O=I.type;return O===li?f(w,k,I.props.children,N,I.key):k!==null&&(k.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===xn&&Ug(O)===k.type)?(N=s(k,I.props),N.ref=Ea(w,k,I),N.return=w,N):(N=tc(I.type,I.key,I.props,null,w.mode,N),N.ref=Ea(w,k,I),N.return=w,N)}function d(w,k,I,N){return k===null||k.tag!==4||k.stateNode.containerInfo!==I.containerInfo||k.stateNode.implementation!==I.implementation?(k=Ud(I,w.mode,N),k.return=w,k):(k=s(k,I.children||[]),k.return=w,k)}function f(w,k,I,N,O){return k===null||k.tag!==7?(k=_s(I,w.mode,N,O),k.return=w,k):(k=s(k,I),k.return=w,k)}function g(w,k,I){if(typeof k=="string"&&k!==""||typeof k=="number")return k=Fd(""+k,w.mode,I),k.return=w,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case vl:return I=tc(k.type,k.key,k.props,null,w.mode,I),I.ref=Ea(w,null,k),I.return=w,I;case oi:return k=Ud(k,w.mode,I),k.return=w,k;case xn:var N=k._init;return g(w,N(k._payload),I)}if(Aa(k)||va(k))return k=_s(k,w.mode,I,null),k.return=w,k;Cl(w,k)}return null}function p(w,k,I,N){var O=k!==null?k.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return O!==null?null:c(w,k,""+I,N);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case vl:return I.key===O?u(w,k,I,N):null;case oi:return I.key===O?d(w,k,I,N):null;case xn:return O=I._init,p(w,k,O(I._payload),N)}if(Aa(I)||va(I))return O!==null?null:f(w,k,I,N,null);Cl(w,I)}return null}function _(w,k,I,N,O){if(typeof N=="string"&&N!==""||typeof N=="number")return w=w.get(I)||null,c(k,w,""+N,O);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case vl:return w=w.get(N.key===null?I:N.key)||null,u(k,w,N,O);case oi:return w=w.get(N.key===null?I:N.key)||null,d(k,w,N,O);case xn:var F=N._init;return _(w,k,I,F(N._payload),O)}if(Aa(N)||va(N))return w=w.get(I)||null,f(k,w,N,O,null);Cl(k,N)}return null}function A(w,k,I,N){for(var O=null,F=null,x=k,y=k=0,E=null;x!==null&&y<I.length;y++){x.index>y?(E=x,x=null):E=x.sibling;var T=p(w,x,I[y],N);if(T===null){x===null&&(x=E);break}t&&x&&T.alternate===null&&e(w,x),k=i(T,k,y),F===null?O=T:F.sibling=T,F=T,x=E}if(y===I.length)return r(w,x),Te&&hs(w,y),O;if(x===null){for(;y<I.length;y++)x=g(w,I[y],N),x!==null&&(k=i(x,k,y),F===null?O=x:F.sibling=x,F=x);return Te&&hs(w,y),O}for(x=n(w,x);y<I.length;y++)E=_(x,w,y,I[y],N),E!==null&&(t&&E.alternate!==null&&x.delete(E.key===null?y:E.key),k=i(E,k,y),F===null?O=E:F.sibling=E,F=E);return t&&x.forEach(function(C){return e(w,C)}),Te&&hs(w,y),O}function P(w,k,I,N){var O=va(I);if(typeof O!="function")throw Error(U(150));if(I=O.call(I),I==null)throw Error(U(151));for(var F=O=null,x=k,y=k=0,E=null,T=I.next();x!==null&&!T.done;y++,T=I.next()){x.index>y?(E=x,x=null):E=x.sibling;var C=p(w,x,T.value,N);if(C===null){x===null&&(x=E);break}t&&x&&C.alternate===null&&e(w,x),k=i(C,k,y),F===null?O=C:F.sibling=C,F=C,x=E}if(T.done)return r(w,x),Te&&hs(w,y),O;if(x===null){for(;!T.done;y++,T=I.next())T=g(w,T.value,N),T!==null&&(k=i(T,k,y),F===null?O=T:F.sibling=T,F=T);return Te&&hs(w,y),O}for(x=n(w,x);!T.done;y++,T=I.next())T=_(x,w,y,T.value,N),T!==null&&(t&&T.alternate!==null&&x.delete(T.key===null?y:T.key),k=i(T,k,y),F===null?O=T:F.sibling=T,F=T);return t&&x.forEach(function(R){return e(w,R)}),Te&&hs(w,y),O}function S(w,k,I,N){if(typeof I=="object"&&I!==null&&I.type===li&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case vl:e:{for(var O=I.key,F=k;F!==null;){if(F.key===O){if(O=I.type,O===li){if(F.tag===7){r(w,F.sibling),k=s(F,I.props.children),k.return=w,w=k;break e}}else if(F.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===xn&&Ug(O)===F.type){r(w,F.sibling),k=s(F,I.props),k.ref=Ea(w,F,I),k.return=w,w=k;break e}r(w,F);break}else e(w,F);F=F.sibling}I.type===li?(k=_s(I.props.children,w.mode,N,I.key),k.return=w,w=k):(N=tc(I.type,I.key,I.props,null,w.mode,N),N.ref=Ea(w,k,I),N.return=w,w=N)}return a(w);case oi:e:{for(F=I.key;k!==null;){if(k.key===F)if(k.tag===4&&k.stateNode.containerInfo===I.containerInfo&&k.stateNode.implementation===I.implementation){r(w,k.sibling),k=s(k,I.children||[]),k.return=w,w=k;break e}else{r(w,k);break}else e(w,k);k=k.sibling}k=Ud(I,w.mode,N),k.return=w,w=k}return a(w);case xn:return F=I._init,S(w,k,F(I._payload),N)}if(Aa(I))return A(w,k,I,N);if(va(I))return P(w,k,I,N);Cl(w,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,k!==null&&k.tag===6?(r(w,k.sibling),k=s(k,I),k.return=w,w=k):(r(w,k),k=Fd(I,w.mode,N),k.return=w,w=k),a(w)):r(w,k)}return S}var ji=dv(!0),hv=dv(!1),Tc=Xn(null),Ic=null,gi=null,Qf=null;function Yf(){Qf=gi=Ic=null}function Xf(t){var e=Tc.current;be(Tc),t._currentValue=e}function Ph(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Ei(t,e){Ic=t,Qf=gi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Tt=!0),t.firstContext=null)}function Jt(t){var e=t._currentValue;if(Qf!==t)if(t={context:t,memoizedValue:e,next:null},gi===null){if(Ic===null)throw Error(U(308));gi=t,Ic.dependencies={lanes:0,firstContext:t}}else gi=gi.next=t;return e}var gs=null;function Jf(t){gs===null?gs=[t]:gs.push(t)}function fv(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Jf(e)):(r.next=s.next,s.next=r),e.interleaved=r,en(t,n)}function en(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var vn=!1;function Zf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function jn(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,ue&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,en(t,r)}return s=n.interleaved,s===null?(e.next=e,Jf(n)):(e.next=s.next,s.next=e),n.interleaved=e,en(t,r)}function Ql(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Lf(t,r)}}function zg(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Nc(t,e,r,n){var s=t.updateQueue;vn=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,a===null?i=d:a.next=d,a=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==a&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;a=0,f=d=u=null,c=i;do{var p=c.lane,_=c.eventTime;if((n&p)===p){f!==null&&(f=f.next={eventTime:_,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var A=t,P=c;switch(p=e,_=r,P.tag){case 1:if(A=P.payload,typeof A=="function"){g=A.call(_,g,p);break e}g=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=P.payload,p=typeof A=="function"?A.call(_,g,p):A,p==null)break e;g=Re({},g,p);break e;case 2:vn=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[c]:p.push(c))}else _={eventTime:_,lane:p,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=_,u=g):f=f.next=_,a|=p;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;p=c,c=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(f===null&&(u=g),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ns|=a,t.lanes=a,t.memoizedState=g}}function Bg(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(U(191,s));s.call(n)}}}var Po={},Ir=Xn(Po),uo=Xn(Po),ho=Xn(Po);function ys(t){if(t===Po)throw Error(U(174));return t}function em(t,e){switch(ve(ho,e),ve(uo,t),ve(Ir,Po),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=hh(e,t)}be(Ir),ve(Ir,e)}function Di(){be(Ir),be(uo),be(ho)}function pv(t){ys(ho.current);var e=ys(Ir.current),r=hh(e,t.type);e!==r&&(ve(uo,t),ve(Ir,r))}function tm(t){uo.current===t&&(be(Ir),be(uo))}var Ae=Xn(0);function Sc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jd=[];function rm(){for(var t=0;t<jd.length;t++)jd[t]._workInProgressVersionPrimary=null;jd.length=0}var Yl=ln.ReactCurrentDispatcher,Dd=ln.ReactCurrentBatchConfig,Is=0,Ce=null,qe=null,Qe=null,Ac=!1,$a=!1,fo=0,cE=0;function ot(){throw Error(U(321))}function nm(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!pr(t[r],e[r]))return!1;return!0}function sm(t,e,r,n,s,i){if(Is=i,Ce=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Yl.current=t===null||t.memoizedState===null?fE:mE,t=r(n,s),$a){i=0;do{if($a=!1,fo=0,25<=i)throw Error(U(301));i+=1,Qe=qe=null,e.updateQueue=null,Yl.current=pE,t=r(n,s)}while($a)}if(Yl.current=Cc,e=qe!==null&&qe.next!==null,Is=0,Qe=qe=Ce=null,Ac=!1,e)throw Error(U(300));return t}function im(){var t=fo!==0;return fo=0,t}function kr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qe===null?Ce.memoizedState=Qe=t:Qe=Qe.next=t,Qe}function Zt(){if(qe===null){var t=Ce.alternate;t=t!==null?t.memoizedState:null}else t=qe.next;var e=Qe===null?Ce.memoizedState:Qe.next;if(e!==null)Qe=e,qe=t;else{if(t===null)throw Error(U(310));qe=t,t={memoizedState:qe.memoizedState,baseState:qe.baseState,baseQueue:qe.baseQueue,queue:qe.queue,next:null},Qe===null?Ce.memoizedState=Qe=t:Qe=Qe.next=t}return Qe}function mo(t,e){return typeof e=="function"?e(t):e}function Od(t){var e=Zt(),r=e.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=t;var n=qe,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var c=a=null,u=null,d=i;do{var f=d.lane;if((Is&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var g={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=g,a=n):u=u.next=g,Ce.lanes|=f,Ns|=f}d=d.next}while(d!==null&&d!==i);u===null?a=n:u.next=c,pr(n,e.memoizedState)||(Tt=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=u,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Ce.lanes|=i,Ns|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Vd(t){var e=Zt(),r=e.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);pr(i,e.memoizedState)||(Tt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function gv(){}function yv(t,e){var r=Ce,n=Zt(),s=e(),i=!pr(n.memoizedState,s);if(i&&(n.memoizedState=s,Tt=!0),n=n.queue,am(_v.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||Qe!==null&&Qe.memoizedState.tag&1){if(r.flags|=2048,po(9,vv.bind(null,r,n,s,e),void 0,null),Ye===null)throw Error(U(349));Is&30||xv(r,e,s)}return s}function xv(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ce.updateQueue,e===null?(e={lastEffect:null,stores:null},Ce.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function vv(t,e,r,n){e.value=r,e.getSnapshot=n,wv(e)&&kv(t)}function _v(t,e,r){return r(function(){wv(e)&&kv(t)})}function wv(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!pr(t,r)}catch{return!0}}function kv(t){var e=en(t,1);e!==null&&mr(e,t,1,-1)}function $g(t){var e=kr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:t},e.queue=t,t=t.dispatch=hE.bind(null,Ce,t),[e.memoizedState,t]}function po(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ce.updateQueue,e===null?(e={lastEffect:null,stores:null},Ce.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function bv(){return Zt().memoizedState}function Xl(t,e,r,n){var s=kr();Ce.flags|=t,s.memoizedState=po(1|e,r,void 0,n===void 0?null:n)}function mu(t,e,r,n){var s=Zt();n=n===void 0?null:n;var i=void 0;if(qe!==null){var a=qe.memoizedState;if(i=a.destroy,n!==null&&nm(n,a.deps)){s.memoizedState=po(e,r,i,n);return}}Ce.flags|=t,s.memoizedState=po(1|e,r,i,n)}function qg(t,e){return Xl(8390656,8,t,e)}function am(t,e){return mu(2048,8,t,e)}function Ev(t,e){return mu(4,2,t,e)}function Tv(t,e){return mu(4,4,t,e)}function Iv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Nv(t,e,r){return r=r!=null?r.concat([t]):null,mu(4,4,Iv.bind(null,e,t),r)}function om(){}function Sv(t,e){var r=Zt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&nm(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Av(t,e){var r=Zt();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&nm(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Cv(t,e,r){return Is&21?(pr(r,e)||(r=Ox(),Ce.lanes|=r,Ns|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Tt=!0),t.memoizedState=r)}function uE(t,e){var r=me;me=r!==0&&4>r?r:4,t(!0);var n=Dd.transition;Dd.transition={};try{t(!1),e()}finally{me=r,Dd.transition=n}}function Rv(){return Zt().memoizedState}function dE(t,e,r){var n=On(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Pv(t))jv(e,r);else if(r=fv(t,e,r,n),r!==null){var s=yt();mr(r,t,n,s),Dv(r,e,n)}}function hE(t,e,r){var n=On(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Pv(t))jv(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,c=i(a,r);if(s.hasEagerState=!0,s.eagerState=c,pr(c,a)){var u=e.interleaved;u===null?(s.next=s,Jf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}r=fv(t,e,s,n),r!==null&&(s=yt(),mr(r,t,n,s),Dv(r,e,n))}}function Pv(t){var e=t.alternate;return t===Ce||e!==null&&e===Ce}function jv(t,e){$a=Ac=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Dv(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Lf(t,r)}}var Cc={readContext:Jt,useCallback:ot,useContext:ot,useEffect:ot,useImperativeHandle:ot,useInsertionEffect:ot,useLayoutEffect:ot,useMemo:ot,useReducer:ot,useRef:ot,useState:ot,useDebugValue:ot,useDeferredValue:ot,useTransition:ot,useMutableSource:ot,useSyncExternalStore:ot,useId:ot,unstable_isNewReconciler:!1},fE={readContext:Jt,useCallback:function(t,e){return kr().memoizedState=[t,e===void 0?null:e],t},useContext:Jt,useEffect:qg,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Xl(4194308,4,Iv.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Xl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Xl(4,2,t,e)},useMemo:function(t,e){var r=kr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=kr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=dE.bind(null,Ce,t),[n.memoizedState,t]},useRef:function(t){var e=kr();return t={current:t},e.memoizedState=t},useState:$g,useDebugValue:om,useDeferredValue:function(t){return kr().memoizedState=t},useTransition:function(){var t=$g(!1),e=t[0];return t=uE.bind(null,t[1]),kr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ce,s=kr();if(Te){if(r===void 0)throw Error(U(407));r=r()}else{if(r=e(),Ye===null)throw Error(U(349));Is&30||xv(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,qg(_v.bind(null,n,i,t),[t]),n.flags|=2048,po(9,vv.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=kr(),e=Ye.identifierPrefix;if(Te){var r=Wr,n=Hr;r=(n&~(1<<32-fr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=fo++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=cE++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},mE={readContext:Jt,useCallback:Sv,useContext:Jt,useEffect:am,useImperativeHandle:Nv,useInsertionEffect:Ev,useLayoutEffect:Tv,useMemo:Av,useReducer:Od,useRef:bv,useState:function(){return Od(mo)},useDebugValue:om,useDeferredValue:function(t){var e=Zt();return Cv(e,qe.memoizedState,t)},useTransition:function(){var t=Od(mo)[0],e=Zt().memoizedState;return[t,e]},useMutableSource:gv,useSyncExternalStore:yv,useId:Rv,unstable_isNewReconciler:!1},pE={readContext:Jt,useCallback:Sv,useContext:Jt,useEffect:am,useImperativeHandle:Nv,useInsertionEffect:Ev,useLayoutEffect:Tv,useMemo:Av,useReducer:Vd,useRef:bv,useState:function(){return Vd(mo)},useDebugValue:om,useDeferredValue:function(t){var e=Zt();return qe===null?e.memoizedState=t:Cv(e,qe.memoizedState,t)},useTransition:function(){var t=Vd(mo)[0],e=Zt().memoizedState;return[t,e]},useMutableSource:gv,useSyncExternalStore:yv,useId:Rv,unstable_isNewReconciler:!1};function lr(t,e){if(t&&t.defaultProps){e=Re({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function jh(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Re({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var pu={isMounted:function(t){return(t=t._reactInternals)?Fs(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=yt(),s=On(t),i=Qr(n,s);i.payload=e,r!=null&&(i.callback=r),e=jn(t,i,s),e!==null&&(mr(e,t,s,n),Ql(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=yt(),s=On(t),i=Qr(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=jn(t,i,s),e!==null&&(mr(e,t,s,n),Ql(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=yt(),n=On(t),s=Qr(r,n);s.tag=2,e!=null&&(s.callback=e),e=jn(t,s,n),e!==null&&(mr(e,t,n,r),Ql(e,t,n))}};function Hg(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!ao(r,n)||!ao(s,i):!0}function Ov(t,e,r){var n=!1,s=Bn,i=e.contextType;return typeof i=="object"&&i!==null?i=Jt(i):(s=St(e)?Es:ft.current,n=e.contextTypes,i=(n=n!=null)?Ri(t,s):Bn),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=pu,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Wg(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&pu.enqueueReplaceState(e,e.state,null)}function Dh(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Zf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Jt(i):(i=St(e)?Es:ft.current,s.context=Ri(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(jh(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&pu.enqueueReplaceState(s,s.state,null),Nc(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Oi(t,e){try{var r="",n=e;do r+=$k(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Md(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Oh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var gE=typeof WeakMap=="function"?WeakMap:Map;function Vv(t,e,r){r=Qr(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Pc||(Pc=!0,Hh=n),Oh(t,e)},r}function Mv(t,e,r){r=Qr(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Oh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Oh(t,e),typeof n!="function"&&(Dn===null?Dn=new Set([this]):Dn.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function Kg(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new gE;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=CE.bind(null,t,e,r),e.then(t,t))}function Gg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Qg(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Qr(-1,1),e.tag=2,jn(r,e,1))),r.lanes|=1),t)}var yE=ln.ReactCurrentOwner,Tt=!1;function gt(t,e,r,n){e.child=t===null?hv(e,null,r,n):ji(e,t.child,r,n)}function Yg(t,e,r,n,s){r=r.render;var i=e.ref;return Ei(e,s),n=sm(t,e,r,n,i,s),r=im(),t!==null&&!Tt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,tn(t,e,s)):(Te&&r&&Wf(e),e.flags|=1,gt(t,e,n,s),e.child)}function Xg(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!pm(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,Lv(t,e,i,n,s)):(t=tc(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:ao,r(a,n)&&t.ref===e.ref)return tn(t,e,s)}return e.flags|=1,t=Vn(i,n),t.ref=e.ref,t.return=e,e.child=t}function Lv(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(ao(i,n)&&t.ref===e.ref)if(Tt=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(Tt=!0);else return e.lanes=t.lanes,tn(t,e,s)}return Vh(t,e,r,n,s)}function Fv(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ve(xi,jt),jt|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ve(xi,jt),jt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,ve(xi,jt),jt|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,ve(xi,jt),jt|=n;return gt(t,e,s,r),e.child}function Uv(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Vh(t,e,r,n,s){var i=St(r)?Es:ft.current;return i=Ri(e,i),Ei(e,s),r=sm(t,e,r,n,i,s),n=im(),t!==null&&!Tt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,tn(t,e,s)):(Te&&n&&Wf(e),e.flags|=1,gt(t,e,r,s),e.child)}function Jg(t,e,r,n,s){if(St(r)){var i=!0;kc(e)}else i=!1;if(Ei(e,s),e.stateNode===null)Jl(t,e),Ov(e,r,n),Dh(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,c=e.memoizedProps;a.props=c;var u=a.context,d=r.contextType;typeof d=="object"&&d!==null?d=Jt(d):(d=St(r)?Es:ft.current,d=Ri(e,d));var f=r.getDerivedStateFromProps,g=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";g||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==n||u!==d)&&Wg(e,a,n,d),vn=!1;var p=e.memoizedState;a.state=p,Nc(e,n,a,s),u=e.memoizedState,c!==n||p!==u||Nt.current||vn?(typeof f=="function"&&(jh(e,r,f,n),u=e.memoizedState),(c=vn||Hg(e,r,c,n,p,u,d))?(g||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=u),a.props=n,a.state=u,a.context=d,n=c):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,mv(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:lr(e.type,c),a.props=d,g=e.pendingProps,p=a.context,u=r.contextType,typeof u=="object"&&u!==null?u=Jt(u):(u=St(r)?Es:ft.current,u=Ri(e,u));var _=r.getDerivedStateFromProps;(f=typeof _=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==g||p!==u)&&Wg(e,a,n,u),vn=!1,p=e.memoizedState,a.state=p,Nc(e,n,a,s);var A=e.memoizedState;c!==g||p!==A||Nt.current||vn?(typeof _=="function"&&(jh(e,r,_,n),A=e.memoizedState),(d=vn||Hg(e,r,d,n,p,A,u)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,A,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,A,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=A),a.props=n,a.state=A,a.context=u,n=d):(typeof a.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return Mh(t,e,r,n,i,s)}function Mh(t,e,r,n,s,i){Uv(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&Mg(e,r,!1),tn(t,e,i);n=e.stateNode,yE.current=e;var c=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=ji(e,t.child,null,i),e.child=ji(e,null,c,i)):gt(t,e,c,i),e.memoizedState=n.state,s&&Mg(e,r,!0),e.child}function zv(t){var e=t.stateNode;e.pendingContext?Vg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Vg(t,e.context,!1),em(t,e.containerInfo)}function Zg(t,e,r,n,s){return Pi(),Gf(s),e.flags|=256,gt(t,e,r,n),e.child}var Lh={dehydrated:null,treeContext:null,retryLane:0};function Fh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Bv(t,e,r){var n=e.pendingProps,s=Ae.current,i=!1,a=(e.flags&128)!==0,c;if((c=a)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ve(Ae,s&1),t===null)return Rh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=xu(a,n,0,null),t=_s(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Fh(r),e.memoizedState=Lh,t):lm(e,a));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return xE(t,e,a,n,c,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=u,e.deletions=null):(n=Vn(s,u),n.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Vn(c,i):(i=_s(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?Fh(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=Lh,n}return i=t.child,t=i.sibling,n=Vn(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function lm(t,e){return e=xu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Rl(t,e,r,n){return n!==null&&Gf(n),ji(e,t.child,null,r),t=lm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function xE(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=Md(Error(U(422))),Rl(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=xu({mode:"visible",children:n.children},s,0,null),i=_s(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&ji(e,t.child,null,a),e.child.memoizedState=Fh(a),e.memoizedState=Lh,i);if(!(e.mode&1))return Rl(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var c=n.dgst;return n=c,i=Error(U(419)),n=Md(i,n,void 0),Rl(t,e,a,n)}if(c=(a&t.childLanes)!==0,Tt||c){if(n=Ye,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,en(t,s),mr(n,t,s,-1))}return mm(),n=Md(Error(U(421))),Rl(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=RE.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ot=Pn(s.nextSibling),Lt=e,Te=!0,ur=null,t!==null&&(Wt[Kt++]=Hr,Wt[Kt++]=Wr,Wt[Kt++]=Ts,Hr=t.id,Wr=t.overflow,Ts=e),e=lm(e,n.children),e.flags|=4096,e)}function e0(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Ph(t.return,e,r)}function Ld(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function $v(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(gt(t,e,n.children,r),n=Ae.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&e0(t,r,e);else if(t.tag===19)e0(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ve(Ae,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Sc(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Ld(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Sc(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Ld(e,!0,r,null,i);break;case"together":Ld(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Jl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function tn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ns|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,r=Vn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Vn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function vE(t,e,r){switch(e.tag){case 3:zv(e),Pi();break;case 5:pv(e);break;case 1:St(e.type)&&kc(e);break;case 4:em(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;ve(Tc,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ve(Ae,Ae.current&1),e.flags|=128,null):r&e.child.childLanes?Bv(t,e,r):(ve(Ae,Ae.current&1),t=tn(t,e,r),t!==null?t.sibling:null);ve(Ae,Ae.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return $v(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ve(Ae,Ae.current),n)break;return null;case 22:case 23:return e.lanes=0,Fv(t,e,r)}return tn(t,e,r)}var qv,Uh,Hv,Wv;qv=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Uh=function(){};Hv=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,ys(Ir.current);var i=null;switch(r){case"input":s=lh(t,s),n=lh(t,n),i=[];break;case"select":s=Re({},s,{value:void 0}),n=Re({},n,{value:void 0}),i=[];break;case"textarea":s=dh(t,s),n=dh(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=_c)}fh(r,n);var a;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(a in c)c.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Za.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var u=n[d];if(c=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(r||(r={}),r[a]=u[a])}else r||(i||(i=[]),i.push(d,r)),r=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Za.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&ke("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}r&&(i=i||[]).push("style",r);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Wv=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ta(t,e){if(!Te)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function lt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function _E(t,e,r){var n=e.pendingProps;switch(Kf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(e),null;case 1:return St(e.type)&&wc(),lt(e),null;case 3:return n=e.stateNode,Di(),be(Nt),be(ft),rm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Al(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ur!==null&&(Gh(ur),ur=null))),Uh(t,e),lt(e),null;case 5:tm(e);var s=ys(ho.current);if(r=e.type,t!==null&&e.stateNode!=null)Hv(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(U(166));return lt(e),null}if(t=ys(Ir.current),Al(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[Er]=e,n[co]=i,t=(e.mode&1)!==0,r){case"dialog":ke("cancel",n),ke("close",n);break;case"iframe":case"object":case"embed":ke("load",n);break;case"video":case"audio":for(s=0;s<Ra.length;s++)ke(Ra[s],n);break;case"source":ke("error",n);break;case"img":case"image":case"link":ke("error",n),ke("load",n);break;case"details":ke("toggle",n);break;case"input":cg(n,i),ke("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ke("invalid",n);break;case"textarea":dg(n,i),ke("invalid",n)}fh(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var c=i[a];a==="children"?typeof c=="string"?n.textContent!==c&&(i.suppressHydrationWarning!==!0&&Sl(n.textContent,c,t),s=["children",c]):typeof c=="number"&&n.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&Sl(n.textContent,c,t),s=["children",""+c]):Za.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&ke("scroll",n)}switch(r){case"input":_l(n),ug(n,i,!0);break;case"textarea":_l(n),hg(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=_c)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=_x(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Er]=e,t[co]=n,qv(t,e,!1,!1),e.stateNode=t;e:{switch(a=mh(r,n),r){case"dialog":ke("cancel",t),ke("close",t),s=n;break;case"iframe":case"object":case"embed":ke("load",t),s=n;break;case"video":case"audio":for(s=0;s<Ra.length;s++)ke(Ra[s],t);s=n;break;case"source":ke("error",t),s=n;break;case"img":case"image":case"link":ke("error",t),ke("load",t),s=n;break;case"details":ke("toggle",t),s=n;break;case"input":cg(t,n),s=lh(t,n),ke("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Re({},n,{value:void 0}),ke("invalid",t);break;case"textarea":dg(t,n),s=dh(t,n),ke("invalid",t);break;default:s=n}fh(r,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?bx(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&wx(t,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&eo(t,u):typeof u=="number"&&eo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Za.hasOwnProperty(i)?u!=null&&i==="onScroll"&&ke("scroll",t):u!=null&&Pf(t,i,u,a))}switch(r){case"input":_l(t),ug(t,n,!1);break;case"textarea":_l(t),hg(t);break;case"option":n.value!=null&&t.setAttribute("value",""+zn(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?_i(t,!!n.multiple,i,!1):n.defaultValue!=null&&_i(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=_c)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return lt(e),null;case 6:if(t&&e.stateNode!=null)Wv(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(U(166));if(r=ys(ho.current),ys(Ir.current),Al(e)){if(n=e.stateNode,r=e.memoizedProps,n[Er]=e,(i=n.nodeValue!==r)&&(t=Lt,t!==null))switch(t.tag){case 3:Sl(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Sl(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Er]=e,e.stateNode=n}return lt(e),null;case 13:if(be(Ae),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Te&&Ot!==null&&e.mode&1&&!(e.flags&128))uv(),Pi(),e.flags|=98560,i=!1;else if(i=Al(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[Er]=e}else Pi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;lt(e),i=!1}else ur!==null&&(Gh(ur),ur=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Ae.current&1?We===0&&(We=3):mm())),e.updateQueue!==null&&(e.flags|=4),lt(e),null);case 4:return Di(),Uh(t,e),t===null&&oo(e.stateNode.containerInfo),lt(e),null;case 10:return Xf(e.type._context),lt(e),null;case 17:return St(e.type)&&wc(),lt(e),null;case 19:if(be(Ae),i=e.memoizedState,i===null)return lt(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)Ta(i,!1);else{if(We!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Sc(t),a!==null){for(e.flags|=128,Ta(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ve(Ae,Ae.current&1|2),e.child}t=t.sibling}i.tail!==null&&Me()>Vi&&(e.flags|=128,n=!0,Ta(i,!1),e.lanes=4194304)}else{if(!n)if(t=Sc(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ta(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Te)return lt(e),null}else 2*Me()-i.renderingStartTime>Vi&&r!==1073741824&&(e.flags|=128,n=!0,Ta(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Me(),e.sibling=null,r=Ae.current,ve(Ae,n?r&1|2:r&1),e):(lt(e),null);case 22:case 23:return fm(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?jt&1073741824&&(lt(e),e.subtreeFlags&6&&(e.flags|=8192)):lt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function wE(t,e){switch(Kf(e),e.tag){case 1:return St(e.type)&&wc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Di(),be(Nt),be(ft),rm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return tm(e),null;case 13:if(be(Ae),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Pi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return be(Ae),null;case 4:return Di(),null;case 10:return Xf(e.type._context),null;case 22:case 23:return fm(),null;case 24:return null;default:return null}}var Pl=!1,dt=!1,kE=typeof WeakSet=="function"?WeakSet:Set,K=null;function yi(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Oe(t,e,n)}else r.current=null}function zh(t,e,r){try{r()}catch(n){Oe(t,e,n)}}var t0=!1;function bE(t,e){if(Eh=yc,t=Xx(),Hf(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,c=-1,u=-1,d=0,f=0,g=t,p=null;t:for(;;){for(var _;g!==r||s!==0&&g.nodeType!==3||(c=a+s),g!==i||n!==0&&g.nodeType!==3||(u=a+n),g.nodeType===3&&(a+=g.nodeValue.length),(_=g.firstChild)!==null;)p=g,g=_;for(;;){if(g===t)break t;if(p===r&&++d===s&&(c=a),p===i&&++f===n&&(u=a),(_=g.nextSibling)!==null)break;g=p,p=g.parentNode}g=_}r=c===-1||u===-1?null:{start:c,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Th={focusedElem:t,selectionRange:r},yc=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var P=A.memoizedProps,S=A.memoizedState,w=e.stateNode,k=w.getSnapshotBeforeUpdate(e.elementType===e.type?P:lr(e.type,P),S);w.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(N){Oe(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return A=t0,t0=!1,A}function qa(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&zh(e,r,i)}s=s.next}while(s!==n)}}function gu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Bh(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Kv(t){var e=t.alternate;e!==null&&(t.alternate=null,Kv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Er],delete e[co],delete e[Sh],delete e[iE],delete e[aE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Gv(t){return t.tag===5||t.tag===3||t.tag===4}function r0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Gv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $h(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=_c));else if(n!==4&&(t=t.child,t!==null))for($h(t,e,r),t=t.sibling;t!==null;)$h(t,e,r),t=t.sibling}function qh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(qh(t,e,r),t=t.sibling;t!==null;)qh(t,e,r),t=t.sibling}var Ze=null,cr=!1;function gn(t,e,r){for(r=r.child;r!==null;)Qv(t,e,r),r=r.sibling}function Qv(t,e,r){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(lu,r)}catch{}switch(r.tag){case 5:dt||yi(r,e);case 6:var n=Ze,s=cr;Ze=null,gn(t,e,r),Ze=n,cr=s,Ze!==null&&(cr?(t=Ze,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Ze.removeChild(r.stateNode));break;case 18:Ze!==null&&(cr?(t=Ze,r=r.stateNode,t.nodeType===8?Rd(t.parentNode,r):t.nodeType===1&&Rd(t,r),so(t)):Rd(Ze,r.stateNode));break;case 4:n=Ze,s=cr,Ze=r.stateNode.containerInfo,cr=!0,gn(t,e,r),Ze=n,cr=s;break;case 0:case 11:case 14:case 15:if(!dt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&zh(r,e,a),s=s.next}while(s!==n)}gn(t,e,r);break;case 1:if(!dt&&(yi(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(c){Oe(r,e,c)}gn(t,e,r);break;case 21:gn(t,e,r);break;case 22:r.mode&1?(dt=(n=dt)||r.memoizedState!==null,gn(t,e,r),dt=n):gn(t,e,r);break;default:gn(t,e,r)}}function n0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new kE),e.forEach(function(n){var s=PE.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function or(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,c=a;e:for(;c!==null;){switch(c.tag){case 5:Ze=c.stateNode,cr=!1;break e;case 3:Ze=c.stateNode.containerInfo,cr=!0;break e;case 4:Ze=c.stateNode.containerInfo,cr=!0;break e}c=c.return}if(Ze===null)throw Error(U(160));Qv(i,a,s),Ze=null,cr=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Oe(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Yv(e,t),e=e.sibling}function Yv(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(or(e,t),wr(t),n&4){try{qa(3,t,t.return),gu(3,t)}catch(P){Oe(t,t.return,P)}try{qa(5,t,t.return)}catch(P){Oe(t,t.return,P)}}break;case 1:or(e,t),wr(t),n&512&&r!==null&&yi(r,r.return);break;case 5:if(or(e,t),wr(t),n&512&&r!==null&&yi(r,r.return),t.flags&32){var s=t.stateNode;try{eo(s,"")}catch(P){Oe(t,t.return,P)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&xx(s,i),mh(c,a);var d=mh(c,i);for(a=0;a<u.length;a+=2){var f=u[a],g=u[a+1];f==="style"?bx(s,g):f==="dangerouslySetInnerHTML"?wx(s,g):f==="children"?eo(s,g):Pf(s,f,g,d)}switch(c){case"input":ch(s,i);break;case"textarea":vx(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?_i(s,!!i.multiple,_,!1):p!==!!i.multiple&&(i.defaultValue!=null?_i(s,!!i.multiple,i.defaultValue,!0):_i(s,!!i.multiple,i.multiple?[]:"",!1))}s[co]=i}catch(P){Oe(t,t.return,P)}}break;case 6:if(or(e,t),wr(t),n&4){if(t.stateNode===null)throw Error(U(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){Oe(t,t.return,P)}}break;case 3:if(or(e,t),wr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{so(e.containerInfo)}catch(P){Oe(t,t.return,P)}break;case 4:or(e,t),wr(t);break;case 13:or(e,t),wr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(dm=Me())),n&4&&n0(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(dt=(d=dt)||f,or(e,t),dt=d):or(e,t),wr(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(K=t,f=t.child;f!==null;){for(g=K=f;K!==null;){switch(p=K,_=p.child,p.tag){case 0:case 11:case 14:case 15:qa(4,p,p.return);break;case 1:yi(p,p.return);var A=p.stateNode;if(typeof A.componentWillUnmount=="function"){n=p,r=p.return;try{e=n,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(P){Oe(n,r,P)}}break;case 5:yi(p,p.return);break;case 22:if(p.memoizedState!==null){i0(g);continue}}_!==null?(_.return=p,K=_):i0(g)}f=f.sibling}e:for(f=null,g=t;;){if(g.tag===5){if(f===null){f=g;try{s=g.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=g.stateNode,u=g.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=kx("display",a))}catch(P){Oe(t,t.return,P)}}}else if(g.tag===6){if(f===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(P){Oe(t,t.return,P)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;f===g&&(f=null),g=g.return}f===g&&(f=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:or(e,t),wr(t),n&4&&n0(t);break;case 21:break;default:or(e,t),wr(t)}}function wr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Gv(r)){var n=r;break e}r=r.return}throw Error(U(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(eo(s,""),n.flags&=-33);var i=r0(t);qh(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,c=r0(t);$h(t,c,a);break;default:throw Error(U(161))}}catch(u){Oe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function EE(t,e,r){K=t,Xv(t)}function Xv(t,e,r){for(var n=(t.mode&1)!==0;K!==null;){var s=K,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Pl;if(!a){var c=s.alternate,u=c!==null&&c.memoizedState!==null||dt;c=Pl;var d=dt;if(Pl=a,(dt=u)&&!d)for(K=s;K!==null;)a=K,u=a.child,a.tag===22&&a.memoizedState!==null?a0(s):u!==null?(u.return=a,K=u):a0(s);for(;i!==null;)K=i,Xv(i),i=i.sibling;K=s,Pl=c,dt=d}s0(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,K=i):s0(t)}}function s0(t){for(;K!==null;){var e=K;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:dt||gu(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!dt)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:lr(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Bg(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Bg(e,a,r)}break;case 5:var c=e.stateNode;if(r===null&&e.flags&4){r=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var g=f.dehydrated;g!==null&&so(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}dt||e.flags&512&&Bh(e)}catch(p){Oe(e,e.return,p)}}if(e===t){K=null;break}if(r=e.sibling,r!==null){r.return=e.return,K=r;break}K=e.return}}function i0(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var r=e.sibling;if(r!==null){r.return=e.return,K=r;break}K=e.return}}function a0(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{gu(4,e)}catch(u){Oe(e,r,u)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(u){Oe(e,s,u)}}var i=e.return;try{Bh(e)}catch(u){Oe(e,i,u)}break;case 5:var a=e.return;try{Bh(e)}catch(u){Oe(e,a,u)}}}catch(u){Oe(e,e.return,u)}if(e===t){K=null;break}var c=e.sibling;if(c!==null){c.return=e.return,K=c;break}K=e.return}}var TE=Math.ceil,Rc=ln.ReactCurrentDispatcher,cm=ln.ReactCurrentOwner,Yt=ln.ReactCurrentBatchConfig,ue=0,Ye=null,ze=null,rt=0,jt=0,xi=Xn(0),We=0,go=null,Ns=0,yu=0,um=0,Ha=null,bt=null,dm=0,Vi=1/0,$r=null,Pc=!1,Hh=null,Dn=null,jl=!1,Nn=null,jc=0,Wa=0,Wh=null,Zl=-1,ec=0;function yt(){return ue&6?Me():Zl!==-1?Zl:Zl=Me()}function On(t){return t.mode&1?ue&2&&rt!==0?rt&-rt:lE.transition!==null?(ec===0&&(ec=Ox()),ec):(t=me,t!==0||(t=window.event,t=t===void 0?16:Bx(t.type)),t):1}function mr(t,e,r,n){if(50<Wa)throw Wa=0,Wh=null,Error(U(185));Ao(t,r,n),(!(ue&2)||t!==Ye)&&(t===Ye&&(!(ue&2)&&(yu|=r),We===4&&wn(t,rt)),At(t,n),r===1&&ue===0&&!(e.mode&1)&&(Vi=Me()+500,fu&&Jn()))}function At(t,e){var r=t.callbackNode;lb(t,e);var n=gc(t,t===Ye?rt:0);if(n===0)r!==null&&pg(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&pg(r),e===1)t.tag===0?oE(o0.bind(null,t)):ov(o0.bind(null,t)),nE(function(){!(ue&6)&&Jn()}),r=null;else{switch(Vx(n)){case 1:r=Mf;break;case 4:r=jx;break;case 16:r=pc;break;case 536870912:r=Dx;break;default:r=pc}r=i_(r,Jv.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Jv(t,e){if(Zl=-1,ec=0,ue&6)throw Error(U(327));var r=t.callbackNode;if(Ti()&&t.callbackNode!==r)return null;var n=gc(t,t===Ye?rt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Dc(t,n);else{e=n;var s=ue;ue|=2;var i=e_();(Ye!==t||rt!==e)&&($r=null,Vi=Me()+500,vs(t,e));do try{SE();break}catch(c){Zv(t,c)}while(!0);Yf(),Rc.current=i,ue=s,ze!==null?e=0:(Ye=null,rt=0,e=We)}if(e!==0){if(e===2&&(s=vh(t),s!==0&&(n=s,e=Kh(t,s))),e===1)throw r=go,vs(t,0),wn(t,n),At(t,Me()),r;if(e===6)wn(t,n);else{if(s=t.current.alternate,!(n&30)&&!IE(s)&&(e=Dc(t,n),e===2&&(i=vh(t),i!==0&&(n=i,e=Kh(t,i))),e===1))throw r=go,vs(t,0),wn(t,n),At(t,Me()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(U(345));case 2:fs(t,bt,$r);break;case 3:if(wn(t,n),(n&130023424)===n&&(e=dm+500-Me(),10<e)){if(gc(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){yt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Nh(fs.bind(null,t,bt,$r),e);break}fs(t,bt,$r);break;case 4:if(wn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-fr(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=Me()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*TE(n/1960))-n,10<n){t.timeoutHandle=Nh(fs.bind(null,t,bt,$r),n);break}fs(t,bt,$r);break;case 5:fs(t,bt,$r);break;default:throw Error(U(329))}}}return At(t,Me()),t.callbackNode===r?Jv.bind(null,t):null}function Kh(t,e){var r=Ha;return t.current.memoizedState.isDehydrated&&(vs(t,e).flags|=256),t=Dc(t,e),t!==2&&(e=bt,bt=r,e!==null&&Gh(e)),t}function Gh(t){bt===null?bt=t:bt.push.apply(bt,t)}function IE(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!pr(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wn(t,e){for(e&=~um,e&=~yu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-fr(e),n=1<<r;t[r]=-1,e&=~n}}function o0(t){if(ue&6)throw Error(U(327));Ti();var e=gc(t,0);if(!(e&1))return At(t,Me()),null;var r=Dc(t,e);if(t.tag!==0&&r===2){var n=vh(t);n!==0&&(e=n,r=Kh(t,n))}if(r===1)throw r=go,vs(t,0),wn(t,e),At(t,Me()),r;if(r===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fs(t,bt,$r),At(t,Me()),null}function hm(t,e){var r=ue;ue|=1;try{return t(e)}finally{ue=r,ue===0&&(Vi=Me()+500,fu&&Jn())}}function Ss(t){Nn!==null&&Nn.tag===0&&!(ue&6)&&Ti();var e=ue;ue|=1;var r=Yt.transition,n=me;try{if(Yt.transition=null,me=1,t)return t()}finally{me=n,Yt.transition=r,ue=e,!(ue&6)&&Jn()}}function fm(){jt=xi.current,be(xi)}function vs(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,rE(r)),ze!==null)for(r=ze.return;r!==null;){var n=r;switch(Kf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&wc();break;case 3:Di(),be(Nt),be(ft),rm();break;case 5:tm(n);break;case 4:Di();break;case 13:be(Ae);break;case 19:be(Ae);break;case 10:Xf(n.type._context);break;case 22:case 23:fm()}r=r.return}if(Ye=t,ze=t=Vn(t.current,null),rt=jt=e,We=0,go=null,um=yu=Ns=0,bt=Ha=null,gs!==null){for(e=0;e<gs.length;e++)if(r=gs[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}gs=null}return t}function Zv(t,e){do{var r=ze;try{if(Yf(),Yl.current=Cc,Ac){for(var n=Ce.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ac=!1}if(Is=0,Qe=qe=Ce=null,$a=!1,fo=0,cm.current=null,r===null||r.return===null){We=1,go=e,ze=null;break}e:{var i=t,a=r.return,c=r,u=e;if(e=rt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=c,g=f.tag;if(!(f.mode&1)&&(g===0||g===11||g===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var _=Gg(a);if(_!==null){_.flags&=-257,Qg(_,a,c,i,e),_.mode&1&&Kg(i,d,e),e=_,u=d;var A=e.updateQueue;if(A===null){var P=new Set;P.add(u),e.updateQueue=P}else A.add(u);break e}else{if(!(e&1)){Kg(i,d,e),mm();break e}u=Error(U(426))}}else if(Te&&c.mode&1){var S=Gg(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Qg(S,a,c,i,e),Gf(Oi(u,c));break e}}i=u=Oi(u,c),We!==4&&(We=2),Ha===null?Ha=[i]:Ha.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=Vv(i,u,e);zg(i,w);break e;case 1:c=u;var k=i.type,I=i.stateNode;if(!(i.flags&128)&&(typeof k.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Dn===null||!Dn.has(I)))){i.flags|=65536,e&=-e,i.lanes|=e;var N=Mv(i,c,e);zg(i,N);break e}}i=i.return}while(i!==null)}r_(r)}catch(O){e=O,ze===r&&r!==null&&(ze=r=r.return);continue}break}while(!0)}function e_(){var t=Rc.current;return Rc.current=Cc,t===null?Cc:t}function mm(){(We===0||We===3||We===2)&&(We=4),Ye===null||!(Ns&268435455)&&!(yu&268435455)||wn(Ye,rt)}function Dc(t,e){var r=ue;ue|=2;var n=e_();(Ye!==t||rt!==e)&&($r=null,vs(t,e));do try{NE();break}catch(s){Zv(t,s)}while(!0);if(Yf(),ue=r,Rc.current=n,ze!==null)throw Error(U(261));return Ye=null,rt=0,We}function NE(){for(;ze!==null;)t_(ze)}function SE(){for(;ze!==null&&!Zk();)t_(ze)}function t_(t){var e=s_(t.alternate,t,jt);t.memoizedProps=t.pendingProps,e===null?r_(t):ze=e,cm.current=null}function r_(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=wE(r,e),r!==null){r.flags&=32767,ze=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{We=6,ze=null;return}}else if(r=_E(r,e,jt),r!==null){ze=r;return}if(e=e.sibling,e!==null){ze=e;return}ze=e=t}while(e!==null);We===0&&(We=5)}function fs(t,e,r){var n=me,s=Yt.transition;try{Yt.transition=null,me=1,AE(t,e,r,n)}finally{Yt.transition=s,me=n}return null}function AE(t,e,r,n){do Ti();while(Nn!==null);if(ue&6)throw Error(U(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(cb(t,i),t===Ye&&(ze=Ye=null,rt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||jl||(jl=!0,i_(pc,function(){return Ti(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Yt.transition,Yt.transition=null;var a=me;me=1;var c=ue;ue|=4,cm.current=null,bE(t,r),Yv(r,t),Qb(Th),yc=!!Eh,Th=Eh=null,t.current=r,EE(r),eb(),ue=c,me=a,Yt.transition=i}else t.current=r;if(jl&&(jl=!1,Nn=t,jc=s),i=t.pendingLanes,i===0&&(Dn=null),nb(r.stateNode),At(t,Me()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Pc)throw Pc=!1,t=Hh,Hh=null,t;return jc&1&&t.tag!==0&&Ti(),i=t.pendingLanes,i&1?t===Wh?Wa++:(Wa=0,Wh=t):Wa=0,Jn(),null}function Ti(){if(Nn!==null){var t=Vx(jc),e=Yt.transition,r=me;try{if(Yt.transition=null,me=16>t?16:t,Nn===null)var n=!1;else{if(t=Nn,Nn=null,jc=0,ue&6)throw Error(U(331));var s=ue;for(ue|=4,K=t.current;K!==null;){var i=K,a=i.child;if(K.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(K=d;K!==null;){var f=K;switch(f.tag){case 0:case 11:case 15:qa(8,f,i)}var g=f.child;if(g!==null)g.return=f,K=g;else for(;K!==null;){f=K;var p=f.sibling,_=f.return;if(Kv(f),f===d){K=null;break}if(p!==null){p.return=_,K=p;break}K=_}}}var A=i.alternate;if(A!==null){var P=A.child;if(P!==null){A.child=null;do{var S=P.sibling;P.sibling=null,P=S}while(P!==null)}}K=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,K=a;else e:for(;K!==null;){if(i=K,i.flags&2048)switch(i.tag){case 0:case 11:case 15:qa(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,K=w;break e}K=i.return}}var k=t.current;for(K=k;K!==null;){a=K;var I=a.child;if(a.subtreeFlags&2064&&I!==null)I.return=a,K=I;else e:for(a=k;K!==null;){if(c=K,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:gu(9,c)}}catch(O){Oe(c,c.return,O)}if(c===a){K=null;break e}var N=c.sibling;if(N!==null){N.return=c.return,K=N;break e}K=c.return}}if(ue=s,Jn(),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(lu,t)}catch{}n=!0}return n}finally{me=r,Yt.transition=e}}return!1}function l0(t,e,r){e=Oi(r,e),e=Vv(t,e,1),t=jn(t,e,1),e=yt(),t!==null&&(Ao(t,1,e),At(t,e))}function Oe(t,e,r){if(t.tag===3)l0(t,t,r);else for(;e!==null;){if(e.tag===3){l0(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Dn===null||!Dn.has(n))){t=Oi(r,t),t=Mv(e,t,1),e=jn(e,t,1),t=yt(),e!==null&&(Ao(e,1,t),At(e,t));break}}e=e.return}}function CE(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=yt(),t.pingedLanes|=t.suspendedLanes&r,Ye===t&&(rt&r)===r&&(We===4||We===3&&(rt&130023424)===rt&&500>Me()-dm?vs(t,0):um|=r),At(t,e)}function n_(t,e){e===0&&(t.mode&1?(e=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):e=1);var r=yt();t=en(t,e),t!==null&&(Ao(t,e,r),At(t,r))}function RE(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),n_(t,r)}function PE(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(U(314))}n!==null&&n.delete(e),n_(t,r)}var s_;s_=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Nt.current)Tt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Tt=!1,vE(t,e,r);Tt=!!(t.flags&131072)}else Tt=!1,Te&&e.flags&1048576&&lv(e,Ec,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Jl(t,e),t=e.pendingProps;var s=Ri(e,ft.current);Ei(e,r),s=sm(null,e,n,t,s,r);var i=im();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,St(n)?(i=!0,kc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Zf(e),s.updater=pu,e.stateNode=s,s._reactInternals=e,Dh(e,n,t,r),e=Mh(null,e,n,!0,i,r)):(e.tag=0,Te&&i&&Wf(e),gt(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Jl(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=DE(n),t=lr(n,t),s){case 0:e=Vh(null,e,n,t,r);break e;case 1:e=Jg(null,e,n,t,r);break e;case 11:e=Yg(null,e,n,t,r);break e;case 14:e=Xg(null,e,n,lr(n.type,t),r);break e}throw Error(U(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:lr(n,s),Vh(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:lr(n,s),Jg(t,e,n,s,r);case 3:e:{if(zv(e),t===null)throw Error(U(387));n=e.pendingProps,i=e.memoizedState,s=i.element,mv(t,e),Nc(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Oi(Error(U(423)),e),e=Zg(t,e,n,r,s);break e}else if(n!==s){s=Oi(Error(U(424)),e),e=Zg(t,e,n,r,s);break e}else for(Ot=Pn(e.stateNode.containerInfo.firstChild),Lt=e,Te=!0,ur=null,r=hv(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Pi(),n===s){e=tn(t,e,r);break e}gt(t,e,n,r)}e=e.child}return e;case 5:return pv(e),t===null&&Rh(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Ih(n,s)?a=null:i!==null&&Ih(n,i)&&(e.flags|=32),Uv(t,e),gt(t,e,a,r),e.child;case 6:return t===null&&Rh(e),null;case 13:return Bv(t,e,r);case 4:return em(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=ji(e,null,n,r):gt(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:lr(n,s),Yg(t,e,n,s,r);case 7:return gt(t,e,e.pendingProps,r),e.child;case 8:return gt(t,e,e.pendingProps.children,r),e.child;case 12:return gt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,ve(Tc,n._currentValue),n._currentValue=a,i!==null)if(pr(i.value,a)){if(i.children===s.children&&!Nt.current){e=tn(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){a=i.child;for(var u=c.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=Qr(-1,r&-r),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),Ph(i.return,r,e),c.lanes|=r;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(U(341));a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),Ph(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}gt(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Ei(e,r),s=Jt(s),n=n(s),e.flags|=1,gt(t,e,n,r),e.child;case 14:return n=e.type,s=lr(n,e.pendingProps),s=lr(n.type,s),Xg(t,e,n,s,r);case 15:return Lv(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:lr(n,s),Jl(t,e),e.tag=1,St(n)?(t=!0,kc(e)):t=!1,Ei(e,r),Ov(e,n,s),Dh(e,n,s,r),Mh(null,e,n,!0,t,r);case 19:return $v(t,e,r);case 22:return Fv(t,e,r)}throw Error(U(156,e.tag))};function i_(t,e){return Px(t,e)}function jE(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(t,e,r,n){return new jE(t,e,r,n)}function pm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function DE(t){if(typeof t=="function")return pm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Df)return 11;if(t===Of)return 14}return 2}function Vn(t,e){var r=t.alternate;return r===null?(r=Qt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function tc(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")pm(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case li:return _s(r.children,s,i,e);case jf:a=8,s|=8;break;case sh:return t=Qt(12,r,e,s|2),t.elementType=sh,t.lanes=i,t;case ih:return t=Qt(13,r,e,s),t.elementType=ih,t.lanes=i,t;case ah:return t=Qt(19,r,e,s),t.elementType=ah,t.lanes=i,t;case px:return xu(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case fx:a=10;break e;case mx:a=9;break e;case Df:a=11;break e;case Of:a=14;break e;case xn:a=16,n=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=Qt(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function _s(t,e,r,n){return t=Qt(7,t,n,e),t.lanes=r,t}function xu(t,e,r,n){return t=Qt(22,t,n,e),t.elementType=px,t.lanes=r,t.stateNode={isHidden:!1},t}function Fd(t,e,r){return t=Qt(6,t,null,e),t.lanes=r,t}function Ud(t,e,r){return e=Qt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function OE(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_d(0),this.expirationTimes=_d(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_d(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function gm(t,e,r,n,s,i,a,c,u){return t=new OE(t,e,r,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Qt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zf(i),t}function VE(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:oi,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function a_(t){if(!t)return Bn;t=t._reactInternals;e:{if(Fs(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(St(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var r=t.type;if(St(r))return av(t,r,e)}return e}function o_(t,e,r,n,s,i,a,c,u){return t=gm(r,n,!0,t,s,i,a,c,u),t.context=a_(null),r=t.current,n=yt(),s=On(r),i=Qr(n,s),i.callback=e??null,jn(r,i,s),t.current.lanes=s,Ao(t,s,n),At(t,n),t}function vu(t,e,r,n){var s=e.current,i=yt(),a=On(s);return r=a_(r),e.context===null?e.context=r:e.pendingContext=r,e=Qr(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=jn(s,e,a),t!==null&&(mr(t,s,a,i),Ql(t,s,a)),a}function Oc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function c0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function ym(t,e){c0(t,e),(t=t.alternate)&&c0(t,e)}function ME(){return null}var l_=typeof reportError=="function"?reportError:function(t){console.error(t)};function xm(t){this._internalRoot=t}_u.prototype.render=xm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));vu(t,e,null,null)};_u.prototype.unmount=xm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ss(function(){vu(null,t,null,null)}),e[Zr]=null}};function _u(t){this._internalRoot=t}_u.prototype.unstable_scheduleHydration=function(t){if(t){var e=Fx();t={blockedOn:null,target:t,priority:e};for(var r=0;r<_n.length&&e!==0&&e<_n[r].priority;r++);_n.splice(r,0,t),r===0&&zx(t)}};function vm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function wu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function u0(){}function LE(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var d=Oc(a);i.call(d)}}var a=o_(e,n,t,0,null,!1,!1,"",u0);return t._reactRootContainer=a,t[Zr]=a.current,oo(t.nodeType===8?t.parentNode:t),Ss(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var c=n;n=function(){var d=Oc(u);c.call(d)}}var u=gm(t,0,!1,null,null,!1,!1,"",u0);return t._reactRootContainer=u,t[Zr]=u.current,oo(t.nodeType===8?t.parentNode:t),Ss(function(){vu(e,u,r,n)}),u}function ku(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var c=s;s=function(){var u=Oc(a);c.call(u)}}vu(e,a,t,s)}else a=LE(r,e,t,s,n);return Oc(a)}Mx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ca(e.pendingLanes);r!==0&&(Lf(e,r|1),At(e,Me()),!(ue&6)&&(Vi=Me()+500,Jn()))}break;case 13:Ss(function(){var n=en(t,1);if(n!==null){var s=yt();mr(n,t,1,s)}}),ym(t,1)}};Ff=function(t){if(t.tag===13){var e=en(t,134217728);if(e!==null){var r=yt();mr(e,t,134217728,r)}ym(t,134217728)}};Lx=function(t){if(t.tag===13){var e=On(t),r=en(t,e);if(r!==null){var n=yt();mr(r,t,e,n)}ym(t,e)}};Fx=function(){return me};Ux=function(t,e){var r=me;try{return me=t,e()}finally{me=r}};gh=function(t,e,r){switch(e){case"input":if(ch(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=hu(n);if(!s)throw Error(U(90));yx(n),ch(n,s)}}}break;case"textarea":vx(t,r);break;case"select":e=r.value,e!=null&&_i(t,!!r.multiple,e,!1)}};Ix=hm;Nx=Ss;var FE={usingClientEntryPoint:!1,Events:[Ro,hi,hu,Ex,Tx,hm]},Ia={findFiberByHostInstance:ps,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},UE={bundleType:Ia.bundleType,version:Ia.version,rendererPackageName:Ia.rendererPackageName,rendererConfig:Ia.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ln.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Cx(t),t===null?null:t.stateNode},findFiberByHostInstance:Ia.findFiberByHostInstance||ME,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dl.isDisabled&&Dl.supportsFiber)try{lu=Dl.inject(UE),Tr=Dl}catch{}}zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FE;zt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vm(e))throw Error(U(200));return VE(t,e,null,r)};zt.createRoot=function(t,e){if(!vm(t))throw Error(U(299));var r=!1,n="",s=l_;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=gm(t,1,!1,null,null,r,!1,n,s),t[Zr]=e.current,oo(t.nodeType===8?t.parentNode:t),new xm(e)};zt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=Cx(e),t=t===null?null:t.stateNode,t};zt.flushSync=function(t){return Ss(t)};zt.hydrate=function(t,e,r){if(!wu(e))throw Error(U(200));return ku(null,t,e,!0,r)};zt.hydrateRoot=function(t,e,r){if(!vm(t))throw Error(U(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=l_;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=o_(e,null,t,1,r??null,s,!1,i,a),t[Zr]=e.current,oo(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new _u(e)};zt.render=function(t,e,r){if(!wu(e))throw Error(U(200));return ku(null,t,e,!1,r)};zt.unmountComponentAtNode=function(t){if(!wu(t))throw Error(U(40));return t._reactRootContainer?(Ss(function(){ku(null,null,t,!1,function(){t._reactRootContainer=null,t[Zr]=null})}),!0):!1};zt.unstable_batchedUpdates=hm;zt.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!wu(r))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return ku(t,e,r,!1,n)};zt.version="18.3.1-next-f1338f8080-20240426";function c_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c_)}catch(t){console.error(t)}}c_(),cx.exports=zt;var zE=cx.exports,u_,d0=zE;u_=d0.createRoot,d0.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE=()=>{};var h0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},$E=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],c=t[r++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},h_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,c=a?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,g=(i&3)<<4|c>>4;let p=(c&15)<<2|d>>6,_=d&63;u||(_=64,a||(p=64)),n.push(r[f],r[g],r[p],r[_])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(d_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):$E(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],c=s<t.length?r[t.charAt(s)]:0;++s;const d=s<t.length?r[t.charAt(s)]:64;++s;const g=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||g==null)throw new qE;const p=i<<2|c>>4;if(n.push(p),d!==64){const _=c<<4&240|d>>2;if(n.push(_),g!==64){const A=d<<6&192|g;n.push(A)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const HE=function(t){const e=d_(t);return h_.encodeByteArray(e,!0)},Vc=function(t){return HE(t).replace(/\./g,"")},f_=function(t){try{return h_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE=()=>WE().__FIREBASE_DEFAULTS__,GE=()=>{if(typeof process>"u"||typeof h0>"u")return;const t=h0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},QE=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&f_(t[1]);return e&&JSON.parse(e)},bu=()=>{try{return BE()||KE()||GE()||QE()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},m_=t=>{var e,r;return(r=(e=bu())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},p_=t=>{const e=m_(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},g_=()=>{var t;return(t=bu())==null?void 0:t.config},y_=t=>{var e;return(e=bu())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Us(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _m(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Vc(JSON.stringify(r)),Vc(JSON.stringify(a)),""].join(".")}const Ka={};function XE(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ka))Ka[e]?t.emulator.push(e):t.prod.push(e);return t}function JE(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let f0=!1;function wm(t,e){if(typeof window>"u"||typeof document>"u"||!Us(window.location.host)||Ka[t]===e||Ka[t]||f0)return;Ka[t]=e;function r(p){return`__firebase__banner__${p}`}const n="__firebase__banner",i=XE().prod.length>0;function a(){const p=document.getElementById(n);p&&p.remove()}function c(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function u(p,_){p.setAttribute("width","24"),p.setAttribute("id",_),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function d(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{f0=!0,a()},p}function f(p,_){p.setAttribute("id",_),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function g(){const p=JE(n),_=r("text"),A=document.getElementById(_)||document.createElement("span"),P=r("learnmore"),S=document.getElementById(P)||document.createElement("a"),w=r("preprendIcon"),k=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const I=p.element;c(I),f(S,P);const N=d();u(k,w),I.append(k,A,S,N),document.body.appendChild(I)}i?(A.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mt())}function e2(){var e;const t=(e=bu())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function t2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function r2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function n2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function s2(){const t=mt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function i2(){return!e2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function a2(){try{return typeof indexedDB=="object"}catch{return!1}}function o2(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2="FirebaseError";class Vr extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=l2,Object.setPrototypeOf(this,Vr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jo.prototype.create)}}class jo{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?c2(i,n):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new Vr(s,c,n)}}function c2(t,e){return t.replace(u2,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const u2=/\{\$([^}]+)}/g;function d2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function As(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(m0(i)&&m0(a)){if(!As(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function m0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Do(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Pa(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ja(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function h2(t,e){const r=new f2(t,e);return r.subscribe.bind(r)}class f2{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");m2(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=zd),s.error===void 0&&(s.error=zd),s.complete===void 0&&(s.complete=zd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function m2(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function zd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pe(t){return t&&t._delegate?t._delegate:t}class $n{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new YE;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(y2(e))try{this.getOrInitializeService({instanceIdentifier:ms})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=ms){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ms){return this.instances.has(e)}getOptions(e=ms){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&a.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:g2(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ms){return this.component?this.component.multipleInstances?e:ms:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function g2(t){return t===ms?void 0:t}function y2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new p2(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var se;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(se||(se={}));const v2={debug:se.DEBUG,verbose:se.VERBOSE,info:se.INFO,warn:se.WARN,error:se.ERROR,silent:se.SILENT},_2=se.INFO,w2={[se.DEBUG]:"log",[se.VERBOSE]:"log",[se.INFO]:"info",[se.WARN]:"warn",[se.ERROR]:"error"},k2=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=w2[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class km{constructor(e){this.name=e,this._logLevel=_2,this._logHandler=k2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?v2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,se.DEBUG,...e),this._logHandler(this,se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,se.VERBOSE,...e),this._logHandler(this,se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,se.INFO,...e),this._logHandler(this,se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,se.WARN,...e),this._logHandler(this,se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,se.ERROR,...e),this._logHandler(this,se.ERROR,...e)}}const b2=(t,e)=>e.some(r=>t instanceof r);let p0,g0;function E2(){return p0||(p0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function T2(){return g0||(g0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const v_=new WeakMap,Qh=new WeakMap,__=new WeakMap,Bd=new WeakMap,bm=new WeakMap;function I2(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(Mn(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&v_.set(r,t)}).catch(()=>{}),bm.set(e,t),e}function N2(t){if(Qh.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Qh.set(t,e)}let Yh={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Qh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||__.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Mn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function S2(t){Yh=t(Yh)}function A2(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call($d(this),e,...r);return __.set(n,e.sort?e.sort():[e]),Mn(n)}:T2().includes(t)?function(...e){return t.apply($d(this),e),Mn(v_.get(this))}:function(...e){return Mn(t.apply($d(this),e))}}function C2(t){return typeof t=="function"?A2(t):(t instanceof IDBTransaction&&N2(t),b2(t,E2())?new Proxy(t,Yh):t)}function Mn(t){if(t instanceof IDBRequest)return I2(t);if(Bd.has(t))return Bd.get(t);const e=C2(t);return e!==t&&(Bd.set(t,e),bm.set(e,t)),e}const $d=t=>bm.get(t);function R2(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),c=Mn(a);return n&&a.addEventListener("upgradeneeded",u=>{n(Mn(a.result),u.oldVersion,u.newVersion,Mn(a.transaction),u)}),r&&a.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const P2=["get","getKey","getAll","getAllKeys","count"],j2=["put","add","delete","clear"],qd=new Map;function y0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(qd.get(e))return qd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=j2.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||P2.includes(r)))return;const i=async function(a,...c){const u=this.transaction(a,s?"readwrite":"readonly");let d=u.store;return n&&(d=d.index(c.shift())),(await Promise.all([d[r](...c),s&&u.done]))[0]};return qd.set(e,i),i}S2(t=>({...t,get:(e,r,n)=>y0(e,r)||t.get(e,r,n),has:(e,r)=>!!y0(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(O2(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function O2(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Xh="@firebase/app",x0="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn=new km("@firebase/app"),V2="@firebase/app-compat",M2="@firebase/analytics-compat",L2="@firebase/analytics",F2="@firebase/app-check-compat",U2="@firebase/app-check",z2="@firebase/auth",B2="@firebase/auth-compat",$2="@firebase/database",q2="@firebase/data-connect",H2="@firebase/database-compat",W2="@firebase/functions",K2="@firebase/functions-compat",G2="@firebase/installations",Q2="@firebase/installations-compat",Y2="@firebase/messaging",X2="@firebase/messaging-compat",J2="@firebase/performance",Z2="@firebase/performance-compat",eT="@firebase/remote-config",tT="@firebase/remote-config-compat",rT="@firebase/storage",nT="@firebase/storage-compat",sT="@firebase/firestore",iT="@firebase/ai",aT="@firebase/firestore-compat",oT="firebase",lT="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jh="[DEFAULT]",cT={[Xh]:"fire-core",[V2]:"fire-core-compat",[L2]:"fire-analytics",[M2]:"fire-analytics-compat",[U2]:"fire-app-check",[F2]:"fire-app-check-compat",[z2]:"fire-auth",[B2]:"fire-auth-compat",[$2]:"fire-rtdb",[q2]:"fire-data-connect",[H2]:"fire-rtdb-compat",[W2]:"fire-fn",[K2]:"fire-fn-compat",[G2]:"fire-iid",[Q2]:"fire-iid-compat",[Y2]:"fire-fcm",[X2]:"fire-fcm-compat",[J2]:"fire-perf",[Z2]:"fire-perf-compat",[eT]:"fire-rc",[tT]:"fire-rc-compat",[rT]:"fire-gcs",[nT]:"fire-gcs-compat",[sT]:"fire-fst",[aT]:"fire-fst-compat",[iT]:"fire-vertex","fire-js":"fire-js",[oT]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc=new Map,uT=new Map,Zh=new Map;function v0(t,e){try{t.container.addComponent(e)}catch(r){rn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Cs(t){const e=t.name;if(Zh.has(e))return rn.debug(`There were multiple attempts to register component ${e}.`),!1;Zh.set(e,t);for(const r of Mc.values())v0(r,t);for(const r of uT.values())v0(r,t);return!0}function Eu(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Dt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ln=new jo("app","Firebase",dT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ln.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs=lT;function w_(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Jh,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw Ln.create("bad-app-name",{appName:String(s)});if(r||(r=g_()),!r)throw Ln.create("no-options");const i=Mc.get(s);if(i){if(As(r,i.options)&&As(n,i.config))return i;throw Ln.create("duplicate-app",{appName:s})}const a=new x2(s);for(const u of Zh.values())a.addComponent(u);const c=new hT(r,n,a);return Mc.set(s,c),c}function Em(t=Jh){const e=Mc.get(t);if(!e&&t===Jh&&g_())return w_();if(!e)throw Ln.create("no-app",{appName:t});return e}function Nr(t,e,r){let n=cT[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${n}" with version "${e}":`];s&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rn.warn(a.join(" "));return}Cs(new $n(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fT="firebase-heartbeat-database",mT=1,yo="firebase-heartbeat-store";let Hd=null;function k_(){return Hd||(Hd=R2(fT,mT,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(yo)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ln.create("idb-open",{originalErrorMessage:t.message})})),Hd}async function pT(t){try{const r=(await k_()).transaction(yo),n=await r.objectStore(yo).get(b_(t));return await r.done,n}catch(e){if(e instanceof Vr)rn.warn(e.message);else{const r=Ln.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rn.warn(r.message)}}}async function _0(t,e){try{const n=(await k_()).transaction(yo,"readwrite");await n.objectStore(yo).put(e,b_(t)),await n.done}catch(r){if(r instanceof Vr)rn.warn(r.message);else{const n=Ln.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});rn.warn(n.message)}}}function b_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT=1024,yT=30;class xT{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new _T(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=w0();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>yT){const a=wT(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){rn.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=w0(),{heartbeatsToSend:n,unsentEntries:s}=vT(this._heartbeatsCache.heartbeats),i=Vc(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return rn.warn(r),""}}}function w0(){return new Date().toISOString().substring(0,10)}function vT(t,e=gT){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),k0(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),k0(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class _T{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return a2()?o2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await pT(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return _0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return _0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function k0(t){return Vc(JSON.stringify({version:2,heartbeats:t})).length}function wT(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT(t){Cs(new $n("platform-logger",e=>new D2(e),"PRIVATE")),Cs(new $n("heartbeat",e=>new xT(e),"PRIVATE")),Nr(Xh,x0,t),Nr(Xh,x0,"esm2020"),Nr("fire-js","")}kT("");function E_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const bT=E_,T_=new jo("auth","Firebase",E_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lc=new km("@firebase/auth");function ET(t,...e){Lc.logLevel<=se.WARN&&Lc.warn(`Auth (${zs}): ${t}`,...e)}function rc(t,...e){Lc.logLevel<=se.ERROR&&Lc.error(`Auth (${zs}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(t,...e){throw Tm(t,...e)}function Sr(t,...e){return Tm(t,...e)}function I_(t,e,r){const n={...bT(),[e]:r};return new jo("auth","Firebase",n).create(e,{appName:t.name})}function Yr(t){return I_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Tm(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return T_.create(t,...e)}function X(t,e,...r){if(!t)throw Tm(e,...r)}function Kr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw rc(e),new Error(e)}function nn(t,e){t||Kr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ef(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function TT(){return b0()==="http:"||b0()==="https:"}function b0(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(TT()||r2()||"connection"in navigator)?navigator.onLine:!0}function NT(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,r){this.shortDelay=e,this.longDelay=r,nn(r>e,"Short delay should be less than long delay!"),this.isMobile=ZE()||n2()}get(){return IT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(t,e){nn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Kr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Kr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Kr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AT=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],CT=new Oo(3e4,6e4);function cn(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Mr(t,e,r,n,s={}){return S_(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const c=Do({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...i};return t2()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Us(t.emulatorConfig.host)&&(d.credentials="include"),N_.fetch()(await A_(t,t.config.apiHost,r,c),d)})}async function S_(t,e,r){t._canInitEmulator=!1;const n={...ST,...e};try{const s=new PT(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Ol(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ol(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Ol(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw Ol(t,"user-disabled",a);const f=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw I_(t,f,d);gr(t,f)}}catch(s){if(s instanceof Vr)throw s;gr(t,"network-request-failed",{message:String(s)})}}async function Vo(t,e,r,n,s={}){const i=await Mr(t,e,r,n,s);return"mfaPendingCredential"in i&&gr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function A_(t,e,r,n){const s=`${e}${r}?${n}`,i=t,a=i.config.emulator?Im(t.config,s):`${t.config.apiScheme}://${s}`;return AT.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}function RT(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class PT{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Sr(this.auth,"network-request-failed")),CT.get())})}}function Ol(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=Sr(t,e,n);return s.customData._tokenResponse=r,s}function E0(t){return t!==void 0&&t.enterprise!==void 0}class jT{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return RT(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function DT(t,e){return Mr(t,"GET","/v2/recaptchaConfig",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OT(t,e){return Mr(t,"POST","/v1/accounts:delete",e)}async function Fc(t,e){return Mr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ga(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function VT(t,e=!1){const r=Pe(t),n=await r.getIdToken(e),s=Nm(n);X(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Ga(Wd(s.auth_time)),issuedAtTime:Ga(Wd(s.iat)),expirationTime:Ga(Wd(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Wd(t){return Number(t)*1e3}function Nm(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return rc("JWT malformed, contained fewer than 3 sections"),null;try{const s=f_(r);return s?JSON.parse(s):(rc("Failed to decode base64 JWT payload"),null)}catch(s){return rc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function T0(t){const e=Nm(t);return X(e,"internal-error"),X(typeof e.exp<"u","internal-error"),X(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mi(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Vr&&MT(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function MT({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ga(this.lastLoginAt),this.creationTime=Ga(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uc(t){var g;const e=t.auth,r=await t.getIdToken(),n=await Mi(t,Fc(e,{idToken:r}));X(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const i=(g=s.providerUserInfo)!=null&&g.length?C_(s.providerUserInfo):[],a=UT(t.providerData,i),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new tf(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function FT(t){const e=Pe(t);await Uc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function UT(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function C_(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zT(t,e){const r=await S_(t,{},async()=>{const n=Do({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=await A_(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&Us(t.emulatorConfig.host)&&(u.credentials="include"),N_.fetch()(a,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function BT(t,e){return Mr(t,"POST","/v2/accounts:revokeToken",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){X(e.idToken,"internal-error"),X(typeof e.idToken<"u","internal-error"),X(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):T0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){X(e.length!==0,"internal-error");const r=T0(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(X(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await zT(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new Ii;return n&&(X(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(X(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(X(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ii,this.toJSON())}_performRefresh(){return Kr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(t,e){X(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class dr{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new LT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new tf(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Mi(this,this.stsTokenManager.getToken(this.auth,e));return X(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return VT(this,e)}reload(){return FT(this)}_assign(e){this!==e&&(X(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new dr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){X(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Uc(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Dt(this.auth.app))return Promise.reject(Yr(this.auth));const e=await this.getIdToken();return await Mi(this,OT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,i=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,u=r._redirectEventId??void 0,d=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:g,emailVerified:p,isAnonymous:_,providerData:A,stsTokenManager:P}=r;X(g&&P,e,"internal-error");const S=Ii.fromJSON(this.name,P);X(typeof g=="string",e,"internal-error"),yn(n,e.name),yn(s,e.name),X(typeof p=="boolean",e,"internal-error"),X(typeof _=="boolean",e,"internal-error"),yn(i,e.name),yn(a,e.name),yn(c,e.name),yn(u,e.name),yn(d,e.name),yn(f,e.name);const w=new dr({uid:g,auth:e,email:s,emailVerified:p,displayName:n,isAnonymous:_,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:S,createdAt:d,lastLoginAt:f});return A&&Array.isArray(A)&&(w.providerData=A.map(k=>({...k}))),u&&(w._redirectEventId=u),w}static async _fromIdTokenResponse(e,r,n=!1){const s=new Ii;s.updateFromServerResponse(r);const i=new dr({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Uc(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];X(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?C_(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new Ii;c.updateFromIdToken(n);const u=new dr({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new tf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0=new Map;function Gr(t){nn(t instanceof Function,"Expected a class definition");let e=I0.get(t);return e?(nn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,I0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}R_.type="NONE";const N0=R_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(t,e,r){return`firebase:${t}:${e}:${r}`}class Ni{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=nc(this.userKey,s.apiKey,i),this.fullPersistenceKey=nc("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Fc(this.auth,{idToken:e}).catch(()=>{});return r?dr._fromGetAccountInfoResponse(this.auth,r,e):null}return dr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Ni(Gr(N0),e,n);const s=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Gr(N0);const a=nc(n,e.config.apiKey,e.name);let c=null;for(const d of r)try{const f=await d._get(a);if(f){let g;if(typeof f=="string"){const p=await Fc(e,{idToken:f}).catch(()=>{});if(!p)break;g=await dr._fromGetAccountInfoResponse(e,p,f)}else g=dr._fromJSON(e,f);d!==i&&(c=g),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Ni(i,e,n):(i=u[0],c&&await i._set(a,c.toJSON()),await Promise.all(r.map(async d=>{if(d!==i)try{await d._remove(a)}catch{}})),new Ni(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(O_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(P_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(M_(e))return"Blackberry";if(L_(e))return"Webos";if(j_(e))return"Safari";if((e.includes("chrome/")||D_(e))&&!e.includes("edge/"))return"Chrome";if(V_(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function P_(t=mt()){return/firefox\//i.test(t)}function j_(t=mt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function D_(t=mt()){return/crios\//i.test(t)}function O_(t=mt()){return/iemobile/i.test(t)}function V_(t=mt()){return/android/i.test(t)}function M_(t=mt()){return/blackberry/i.test(t)}function L_(t=mt()){return/webos/i.test(t)}function Sm(t=mt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function $T(t=mt()){var e;return Sm(t)&&!!((e=window.navigator)!=null&&e.standalone)}function qT(){return s2()&&document.documentMode===10}function F_(t=mt()){return Sm(t)||V_(t)||L_(t)||M_(t)||/windows phone/i.test(t)||O_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U_(t,e=[]){let r;switch(t){case"Browser":r=S0(mt());break;case"Worker":r=`${S0(mt())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${zs}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,c)=>{try{const u=e(i);a(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WT(t,e={}){return Mr(t,"GET","/v2/passwordPolicy",cn(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT=6;class GT{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??KT,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new A0(this),this.idTokenSubscription=new A0(this),this.beforeStateQueue=new HT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=T_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Gr(r)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await Ni.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Fc(this,{idToken:e}),n=await dr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Dt(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=n==null?void 0:n._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===c)&&(u!=null&&u.user)&&(n=u.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return X(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Uc(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Dt(this.app))return Promise.reject(Yr(this));const r=e?Pe(e):null;return r&&X(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&X(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Dt(this.app)?Promise.reject(Yr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Dt(this.app)?Promise.reject(Yr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await WT(this),r=new GT(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new jo("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await BT(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Gr(e)||this._popupRedirectResolver;X(r,this,"argument-error"),this.redirectPersistenceManager=await Ni.create(this,[Gr(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(X(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,s);return()=>{a=!0,u()}}else{const u=e.addObserver(r);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return X(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=U_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(Dt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&ET(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Zn(t){return Pe(t)}class A0{constructor(e){this.auth=e,this.observer=null,this.addObserver=h2(r=>this.observer=r)}get next(){return X(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YT(t){Tu=t}function z_(t){return Tu.loadJS(t)}function XT(){return Tu.recaptchaEnterpriseScript}function JT(){return Tu.gapiScript}function ZT(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class eI{constructor(){this.enterprise=new tI}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class tI{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const rI="recaptcha-enterprise",B_="NO_RECAPTCHA";class nI{constructor(e){this.type=rI,this.auth=Zn(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,c)=>{DT(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new jT(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,a(d.siteKey)}}).catch(u=>{c(u)})})}function s(i,a,c){const u=window.grecaptcha;E0(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{a(d)}).catch(()=>{a(B_)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new eI().execute("siteKey",{action:"verify"}):new Promise((i,a)=>{n(this.auth).then(c=>{if(!r&&E0(window.grecaptcha))s(c,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=XT();u.length!==0&&(u+=c),z_(u).then(()=>{s(c,i,a)}).catch(d=>{a(d)})}}).catch(c=>{a(c)})})}}async function C0(t,e,r,n=!1,s=!1){const i=new nI(t);let a;if(s)a=B_;else try{a=await i.verify(r)}catch{a=await i.verify(r,!0)}const c={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:a}):Object.assign(c,{captchaResponse:a}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function zc(t,e,r,n,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await C0(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await C0(t,e,r,r==="getOobCode");return n(t,c)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(t,e){const r=Eu(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(As(i,e??{}))return s;gr(s,"already-initialized")}return r.initialize({options:e})}function iI(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Gr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function aI(t,e,r){const n=Zn(t);X(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!!(r!=null&&r.disableWarnings),i=$_(e),{host:a,port:c}=oI(e),u=c===null?"":`:${c}`,d={url:`${i}//${a}${u}/`},f=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){X(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),X(As(d,n.config.emulator)&&As(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,Us(a)?(_m(`${i}//${a}${u}`),wm("Auth",!0)):lI()}function $_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function oI(t){const e=$_(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:R0(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:R0(a)}}}function R0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function lI(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Kr("not implemented")}_getIdTokenResponse(e){return Kr("not implemented")}_linkToIdToken(e,r){return Kr("not implemented")}_getReauthenticationResolver(e){return Kr("not implemented")}}async function cI(t,e){return Mr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uI(t,e){return Vo(t,"POST","/v1/accounts:signInWithPassword",cn(t,e))}async function dI(t,e){return Mr(t,"POST","/v1/accounts:sendOobCode",cn(t,e))}async function hI(t,e){return dI(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fI(t,e){return Vo(t,"POST","/v1/accounts:signInWithEmailLink",cn(t,e))}async function mI(t,e){return Vo(t,"POST","/v1/accounts:signInWithEmailLink",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo extends Am{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new xo(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new xo(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zc(e,r,"signInWithPassword",uI);case"emailLink":return fI(e,{email:this._email,oobCode:this._password});default:gr(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zc(e,n,"signUpPassword",cI);case"emailLink":return mI(e,{idToken:r,email:this._email,oobCode:this._password});default:gr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Si(t,e){return Vo(t,"POST","/v1/accounts:signInWithIdp",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI="http://localhost";class Rs extends Am{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Rs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):gr("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=r;if(!n||!s)return null;const a=new Rs(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Si(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Si(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Si(e,r)}buildRequest(){const e={requestUri:pI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Do(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function yI(t){const e=Pa(ja(t)).link,r=e?Pa(ja(e)).deep_link_id:null,n=Pa(ja(t)).deep_link_id;return(n?Pa(ja(n)).link:null)||n||r||e||t}class Cm{constructor(e){const r=Pa(ja(e)),n=r.apiKey??null,s=r.oobCode??null,i=gI(r.mode??null);X(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=yI(e);try{return new Cm(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.providerId=Ki.PROVIDER_ID}static credential(e,r){return xo._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=Cm.parseLink(r);return X(n,"argument-error"),xo._fromEmailAndCode(e,n.code,n.tenantId)}}Ki.PROVIDER_ID="password";Ki.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ki.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo extends q_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn extends Mo{constructor(){super("facebook.com")}static credential(e){return Rs._fromParams({providerId:kn.PROVIDER_ID,signInMethod:kn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return kn.credentialFromTaggedObject(e)}static credentialFromError(e){return kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return kn.credential(e.oauthAccessToken)}catch{return null}}}kn.FACEBOOK_SIGN_IN_METHOD="facebook.com";kn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn extends Mo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Rs._fromParams({providerId:bn.PROVIDER_ID,signInMethod:bn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return bn.credentialFromTaggedObject(e)}static credentialFromError(e){return bn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return bn.credential(r,n)}catch{return null}}}bn.GOOGLE_SIGN_IN_METHOD="google.com";bn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En extends Mo{constructor(){super("github.com")}static credential(e){return Rs._fromParams({providerId:En.PROVIDER_ID,signInMethod:En.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return En.credentialFromTaggedObject(e)}static credentialFromError(e){return En.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return En.credential(e.oauthAccessToken)}catch{return null}}}En.GITHUB_SIGN_IN_METHOD="github.com";En.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn extends Mo{constructor(){super("twitter.com")}static credential(e,r){return Rs._fromParams({providerId:Tn.PROVIDER_ID,signInMethod:Tn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Tn.credentialFromTaggedObject(e)}static credentialFromError(e){return Tn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Tn.credential(r,n)}catch{return null}}}Tn.TWITTER_SIGN_IN_METHOD="twitter.com";Tn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xI(t,e){return Vo(t,"POST","/v1/accounts:signUp",cn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await dr._fromIdTokenResponse(e,n,s),a=P0(n);return new Ps({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=P0(n);return new Ps({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function P0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc extends Vr{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Bc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Bc(e,r,n,s)}}function H_(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Bc._fromErrorAndOperation(t,i,e,n):i})}async function vI(t,e,r=!1){const n=await Mi(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ps._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _I(t,e,r=!1){const{auth:n}=t;if(Dt(n.app))return Promise.reject(Yr(n));const s="reauthenticate";try{const i=await Mi(t,H_(n,s,e,t),r);X(i.idToken,n,"internal-error");const a=Nm(i.idToken);X(a,n,"internal-error");const{sub:c}=a;return X(t.uid===c,n,"user-mismatch"),Ps._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&gr(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W_(t,e,r=!1){if(Dt(t.app))return Promise.reject(Yr(t));const n="signIn",s=await H_(t,n,e),i=await Ps._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function wI(t,e){return W_(Zn(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K_(t){const e=Zn(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function kI(t,e,r){const n=Zn(t);await zc(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",hI)}async function bI(t,e,r){if(Dt(t.app))return Promise.reject(Yr(t));const n=Zn(t),a=await zc(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",xI).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&K_(t),u}),c=await Ps._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(c.user),c}function EI(t,e,r){return Dt(t.app)?Promise.reject(Yr(t)):wI(Pe(t),Ki.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&K_(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TI(t,e){return Mr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function II(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=Pe(t),i={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},a=await Mi(n,TI(n.auth,i));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;const c=n.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=n.displayName,c.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}function NI(t,e,r,n){return Pe(t).onIdTokenChanged(e,r,n)}function SI(t,e,r){return Pe(t).beforeAuthStateChanged(e,r)}function AI(t,e,r,n){return Pe(t).onAuthStateChanged(e,r,n)}function CI(t){return Pe(t).signOut()}const $c="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem($c,"1"),this.storage.removeItem($c),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=1e3,PI=10;class Q_ extends G_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=F_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);qT()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,PI):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},RI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Q_.type="LOCAL";const jI=Q_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_ extends G_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Y_.type="SESSION";const X_=Y_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new Iu(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(a).map(async d=>d(r.origin,i)),u=await DI(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Iu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,u)=>{const d=Rm("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(g){const p=g;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(p.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(){return window}function VI(t){Ar().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J_(){return typeof Ar().WorkerGlobalScope<"u"&&typeof Ar().importScripts=="function"}async function MI(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function LI(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function FI(){return J_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_="firebaseLocalStorageDb",UI=1,qc="firebaseLocalStorage",ew="fbase_key";class Lo{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Nu(t,e){return t.transaction([qc],e?"readwrite":"readonly").objectStore(qc)}function zI(){const t=indexedDB.deleteDatabase(Z_);return new Lo(t).toPromise()}function rf(){const t=indexedDB.open(Z_,UI);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(qc,{keyPath:ew})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(qc)?e(n):(n.close(),await zI(),e(await rf()))})})}async function j0(t,e,r){const n=Nu(t,!0).put({[ew]:e,value:r});return new Lo(n).toPromise()}async function BI(t,e){const r=Nu(t,!1).get(e),n=await new Lo(r).toPromise();return n===void 0?null:n.value}function D0(t,e){const r=Nu(t,!0).delete(e);return new Lo(r).toPromise()}const $I=800,qI=3;class tw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rf(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>qI)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return J_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Iu._getInstance(FI()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await MI(),!this.activeServiceWorker)return;this.sender=new OI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||LI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rf();return await j0(e,$c,"1"),await D0(e,$c),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>j0(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>BI(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>D0(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Nu(s,!1).getAll();return new Lo(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$I)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tw.type="LOCAL";const HI=tw;new Oo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(t,e){return e?Gr(e):(X(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm extends Am{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Si(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Si(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Si(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function KI(t){return W_(t.auth,new Pm(t),t.bypassAuthState)}function GI(t){const{auth:e,user:r}=t;return X(r,e,"internal-error"),_I(r,new Pm(t),t.bypassAuthState)}async function QI(t){const{auth:e,user:r}=t;return X(r,e,"internal-error"),vI(r,new Pm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return KI;case"linkViaPopup":case"linkViaRedirect":return QI;case"reauthViaPopup":case"reauthViaRedirect":return GI;default:gr(this.auth,"internal-error")}}resolve(e){nn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){nn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=new Oo(2e3,1e4);class vi extends rw{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,vi.currentPopupAction&&vi.currentPopupAction.cancel(),vi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return X(e,this.auth,"internal-error"),e}async onExecution(){nn(this.filter.length===1,"Popup operations only handle one event");const e=Rm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Sr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Sr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Sr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,YI.get())};e()}}vi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI="pendingRedirect",sc=new Map;class JI extends rw{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=sc.get(this.auth._key());if(!e){try{const n=await ZI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}sc.set(this.auth._key(),e)}return this.bypassAuthState||sc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ZI(t,e){const r=rN(e),n=tN(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function eN(t,e){sc.set(t._key(),e)}function tN(t){return Gr(t._redirectPersistence)}function rN(t){return nc(XI,t.config.apiKey,t.name)}async function nN(t,e,r=!1){if(Dt(t.app))return Promise.reject(Yr(t));const n=Zn(t),s=WI(n,e),a=await new JI(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN=10*60*1e3;class iN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!aN(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!nw(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(Sr(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=sN&&this.cachedEventUids.clear(),this.cachedEventUids.has(O0(e))}saveEventToCache(e){this.cachedEventUids.add(O0(e)),this.lastProcessedEventTime=Date.now()}}function O0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function nw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function aN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oN(t,e={}){return Mr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,cN=/^https?/;async function uN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await oN(t);for(const r of e)try{if(dN(r))return}catch{}gr(t,"unauthorized-domain")}function dN(t){const e=ef(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!cN.test(r))return!1;if(lN.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN=new Oo(3e4,6e4);function V0(){const t=Ar().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function fN(t){return new Promise((e,r)=>{var s,i,a;function n(){V0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{V0(),r(Sr(t,"network-request-failed"))},timeout:hN.get()})}if((i=(s=Ar().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((a=Ar().gapi)!=null&&a.load)n();else{const c=ZT("iframefcb");return Ar()[c]=()=>{gapi.load?n():r(Sr(t,"network-request-failed"))},z_(`${JT()}?onload=${c}`).catch(u=>r(u))}}).catch(e=>{throw ic=null,e})}let ic=null;function mN(t){return ic=ic||fN(t),ic}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=new Oo(5e3,15e3),gN="__/auth/iframe",yN="emulator/auth/iframe",xN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _N(t){const e=t.config;X(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Im(e,yN):`https://${t.config.authDomain}/${gN}`,n={apiKey:e.apiKey,appName:t.name,v:zs},s=vN.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Do(n).slice(1)}`}async function wN(t){const e=await mN(t),r=Ar().gapi;return X(r,t,"internal-error"),e.open({where:document.body,url:_N(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xN,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=Sr(t,"network-request-failed"),c=Ar().setTimeout(()=>{i(a)},pN.get());function u(){Ar().clearTimeout(c),s(n)}n.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bN=500,EN=600,TN="_blank",IN="http://localhost";class M0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function NN(t,e,r,n=bN,s=EN){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...kN,width:n.toString(),height:s.toString(),top:i,left:a},d=mt().toLowerCase();r&&(c=D_(d)?TN:r),P_(d)&&(e=e||IN,u.scrollbars="yes");const f=Object.entries(u).reduce((p,[_,A])=>`${p}${_}=${A},`,"");if($T(d)&&c!=="_self")return SN(e||"",c),new M0(null);const g=window.open(e||"",c,f);X(g,t,"popup-blocked");try{g.focus()}catch{}return new M0(g)}function SN(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN="__/auth/handler",CN="emulator/auth/handler",RN=encodeURIComponent("fac");async function L0(t,e,r,n,s,i){X(t.config.authDomain,t,"auth-domain-config-required"),X(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:zs,eventId:s};if(e instanceof q_){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",d2(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,g]of Object.entries({}))a[f]=g}if(e instanceof Mo){const f=e.getScopes().filter(g=>g!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),d=u?`#${RN}=${encodeURIComponent(u)}`:"";return`${PN(t)}?${Do(c).slice(1)}${d}`}function PN({config:t}){return t.emulator?Im(t,CN):`https://${t.authDomain}/${AN}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kd="webStorageSupport";class jN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=X_,this._completeRedirectFn=nN,this._overrideRedirectResult=eN}async _openPopup(e,r,n,s){var a;nn((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await L0(e,r,n,ef(),s);return NN(e,i,Rm())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await L0(e,r,n,ef(),s);return VI(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(nn(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await wN(e),n=new iN(e);return r.register("authEvent",s=>(X(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Kd,{type:Kd},s=>{var a;const i=(a=s==null?void 0:s[0])==null?void 0:a[Kd];i!==void 0&&r(!!i),gr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=uN(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return F_()||j_()||Sm()}}const DN=jN;var F0="@firebase/auth",U0="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){X(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function MN(t){Cs(new $n("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;X(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:U_(t)},d=new QT(n,s,i,u);return iI(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Cs(new $n("auth-internal",e=>{const r=Zn(e.getProvider("auth").getImmediate());return(n=>new ON(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Nr(F0,U0,VN(t)),Nr(F0,U0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN=5*60,FN=y_("authIdTokenMaxAge")||LN;let z0=null;const UN=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>FN)return;const s=r==null?void 0:r.token;z0!==s&&(z0=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function zN(t=Em()){const e=Eu(t,"auth");if(e.isInitialized())return e.getImmediate();const r=sI(t,{popupRedirectResolver:DN,persistence:[HI,jI,X_]}),n=y_("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=UN(i.toString());SI(r,a,()=>a(r.currentUser)),NI(r,c=>a(c))}}const s=m_("auth");return s&&aI(r,`http://${s}`),r}function BN(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}YT({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=Sr("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",BN().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});MN("Browser");var $N="firebase",qN="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nr($N,qN,"app");var B0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fn,sw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,y){function E(){}E.prototype=y.prototype,x.D=y.prototype,x.prototype=new E,x.prototype.constructor=x,x.C=function(T,C,R){for(var b=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)b[ce-2]=arguments[ce];return y.prototype[C].apply(T,b)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,y,E){E||(E=0);var T=Array(16);if(typeof y=="string")for(var C=0;16>C;++C)T[C]=y.charCodeAt(E++)|y.charCodeAt(E++)<<8|y.charCodeAt(E++)<<16|y.charCodeAt(E++)<<24;else for(C=0;16>C;++C)T[C]=y[E++]|y[E++]<<8|y[E++]<<16|y[E++]<<24;y=x.g[0],E=x.g[1],C=x.g[2];var R=x.g[3],b=y+(R^E&(C^R))+T[0]+3614090360&4294967295;y=E+(b<<7&4294967295|b>>>25),b=R+(C^y&(E^C))+T[1]+3905402710&4294967295,R=y+(b<<12&4294967295|b>>>20),b=C+(E^R&(y^E))+T[2]+606105819&4294967295,C=R+(b<<17&4294967295|b>>>15),b=E+(y^C&(R^y))+T[3]+3250441966&4294967295,E=C+(b<<22&4294967295|b>>>10),b=y+(R^E&(C^R))+T[4]+4118548399&4294967295,y=E+(b<<7&4294967295|b>>>25),b=R+(C^y&(E^C))+T[5]+1200080426&4294967295,R=y+(b<<12&4294967295|b>>>20),b=C+(E^R&(y^E))+T[6]+2821735955&4294967295,C=R+(b<<17&4294967295|b>>>15),b=E+(y^C&(R^y))+T[7]+4249261313&4294967295,E=C+(b<<22&4294967295|b>>>10),b=y+(R^E&(C^R))+T[8]+1770035416&4294967295,y=E+(b<<7&4294967295|b>>>25),b=R+(C^y&(E^C))+T[9]+2336552879&4294967295,R=y+(b<<12&4294967295|b>>>20),b=C+(E^R&(y^E))+T[10]+4294925233&4294967295,C=R+(b<<17&4294967295|b>>>15),b=E+(y^C&(R^y))+T[11]+2304563134&4294967295,E=C+(b<<22&4294967295|b>>>10),b=y+(R^E&(C^R))+T[12]+1804603682&4294967295,y=E+(b<<7&4294967295|b>>>25),b=R+(C^y&(E^C))+T[13]+4254626195&4294967295,R=y+(b<<12&4294967295|b>>>20),b=C+(E^R&(y^E))+T[14]+2792965006&4294967295,C=R+(b<<17&4294967295|b>>>15),b=E+(y^C&(R^y))+T[15]+1236535329&4294967295,E=C+(b<<22&4294967295|b>>>10),b=y+(C^R&(E^C))+T[1]+4129170786&4294967295,y=E+(b<<5&4294967295|b>>>27),b=R+(E^C&(y^E))+T[6]+3225465664&4294967295,R=y+(b<<9&4294967295|b>>>23),b=C+(y^E&(R^y))+T[11]+643717713&4294967295,C=R+(b<<14&4294967295|b>>>18),b=E+(R^y&(C^R))+T[0]+3921069994&4294967295,E=C+(b<<20&4294967295|b>>>12),b=y+(C^R&(E^C))+T[5]+3593408605&4294967295,y=E+(b<<5&4294967295|b>>>27),b=R+(E^C&(y^E))+T[10]+38016083&4294967295,R=y+(b<<9&4294967295|b>>>23),b=C+(y^E&(R^y))+T[15]+3634488961&4294967295,C=R+(b<<14&4294967295|b>>>18),b=E+(R^y&(C^R))+T[4]+3889429448&4294967295,E=C+(b<<20&4294967295|b>>>12),b=y+(C^R&(E^C))+T[9]+568446438&4294967295,y=E+(b<<5&4294967295|b>>>27),b=R+(E^C&(y^E))+T[14]+3275163606&4294967295,R=y+(b<<9&4294967295|b>>>23),b=C+(y^E&(R^y))+T[3]+4107603335&4294967295,C=R+(b<<14&4294967295|b>>>18),b=E+(R^y&(C^R))+T[8]+1163531501&4294967295,E=C+(b<<20&4294967295|b>>>12),b=y+(C^R&(E^C))+T[13]+2850285829&4294967295,y=E+(b<<5&4294967295|b>>>27),b=R+(E^C&(y^E))+T[2]+4243563512&4294967295,R=y+(b<<9&4294967295|b>>>23),b=C+(y^E&(R^y))+T[7]+1735328473&4294967295,C=R+(b<<14&4294967295|b>>>18),b=E+(R^y&(C^R))+T[12]+2368359562&4294967295,E=C+(b<<20&4294967295|b>>>12),b=y+(E^C^R)+T[5]+4294588738&4294967295,y=E+(b<<4&4294967295|b>>>28),b=R+(y^E^C)+T[8]+2272392833&4294967295,R=y+(b<<11&4294967295|b>>>21),b=C+(R^y^E)+T[11]+1839030562&4294967295,C=R+(b<<16&4294967295|b>>>16),b=E+(C^R^y)+T[14]+4259657740&4294967295,E=C+(b<<23&4294967295|b>>>9),b=y+(E^C^R)+T[1]+2763975236&4294967295,y=E+(b<<4&4294967295|b>>>28),b=R+(y^E^C)+T[4]+1272893353&4294967295,R=y+(b<<11&4294967295|b>>>21),b=C+(R^y^E)+T[7]+4139469664&4294967295,C=R+(b<<16&4294967295|b>>>16),b=E+(C^R^y)+T[10]+3200236656&4294967295,E=C+(b<<23&4294967295|b>>>9),b=y+(E^C^R)+T[13]+681279174&4294967295,y=E+(b<<4&4294967295|b>>>28),b=R+(y^E^C)+T[0]+3936430074&4294967295,R=y+(b<<11&4294967295|b>>>21),b=C+(R^y^E)+T[3]+3572445317&4294967295,C=R+(b<<16&4294967295|b>>>16),b=E+(C^R^y)+T[6]+76029189&4294967295,E=C+(b<<23&4294967295|b>>>9),b=y+(E^C^R)+T[9]+3654602809&4294967295,y=E+(b<<4&4294967295|b>>>28),b=R+(y^E^C)+T[12]+3873151461&4294967295,R=y+(b<<11&4294967295|b>>>21),b=C+(R^y^E)+T[15]+530742520&4294967295,C=R+(b<<16&4294967295|b>>>16),b=E+(C^R^y)+T[2]+3299628645&4294967295,E=C+(b<<23&4294967295|b>>>9),b=y+(C^(E|~R))+T[0]+4096336452&4294967295,y=E+(b<<6&4294967295|b>>>26),b=R+(E^(y|~C))+T[7]+1126891415&4294967295,R=y+(b<<10&4294967295|b>>>22),b=C+(y^(R|~E))+T[14]+2878612391&4294967295,C=R+(b<<15&4294967295|b>>>17),b=E+(R^(C|~y))+T[5]+4237533241&4294967295,E=C+(b<<21&4294967295|b>>>11),b=y+(C^(E|~R))+T[12]+1700485571&4294967295,y=E+(b<<6&4294967295|b>>>26),b=R+(E^(y|~C))+T[3]+2399980690&4294967295,R=y+(b<<10&4294967295|b>>>22),b=C+(y^(R|~E))+T[10]+4293915773&4294967295,C=R+(b<<15&4294967295|b>>>17),b=E+(R^(C|~y))+T[1]+2240044497&4294967295,E=C+(b<<21&4294967295|b>>>11),b=y+(C^(E|~R))+T[8]+1873313359&4294967295,y=E+(b<<6&4294967295|b>>>26),b=R+(E^(y|~C))+T[15]+4264355552&4294967295,R=y+(b<<10&4294967295|b>>>22),b=C+(y^(R|~E))+T[6]+2734768916&4294967295,C=R+(b<<15&4294967295|b>>>17),b=E+(R^(C|~y))+T[13]+1309151649&4294967295,E=C+(b<<21&4294967295|b>>>11),b=y+(C^(E|~R))+T[4]+4149444226&4294967295,y=E+(b<<6&4294967295|b>>>26),b=R+(E^(y|~C))+T[11]+3174756917&4294967295,R=y+(b<<10&4294967295|b>>>22),b=C+(y^(R|~E))+T[2]+718787259&4294967295,C=R+(b<<15&4294967295|b>>>17),b=E+(R^(C|~y))+T[9]+3951481745&4294967295,x.g[0]=x.g[0]+y&4294967295,x.g[1]=x.g[1]+(C+(b<<21&4294967295|b>>>11))&4294967295,x.g[2]=x.g[2]+C&4294967295,x.g[3]=x.g[3]+R&4294967295}n.prototype.u=function(x,y){y===void 0&&(y=x.length);for(var E=y-this.blockSize,T=this.B,C=this.h,R=0;R<y;){if(C==0)for(;R<=E;)s(this,x,R),R+=this.blockSize;if(typeof x=="string"){for(;R<y;)if(T[C++]=x.charCodeAt(R++),C==this.blockSize){s(this,T),C=0;break}}else for(;R<y;)if(T[C++]=x[R++],C==this.blockSize){s(this,T),C=0;break}}this.h=C,this.o+=y},n.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var y=1;y<x.length-8;++y)x[y]=0;var E=8*this.o;for(y=x.length-8;y<x.length;++y)x[y]=E&255,E/=256;for(this.u(x),x=Array(16),y=E=0;4>y;++y)for(var T=0;32>T;T+=8)x[E++]=this.g[y]>>>T&255;return x};function i(x,y){var E=c;return Object.prototype.hasOwnProperty.call(E,x)?E[x]:E[x]=y(x)}function a(x,y){this.h=y;for(var E=[],T=!0,C=x.length-1;0<=C;C--){var R=x[C]|0;T&&R==y||(E[C]=R,T=!1)}this.g=E}var c={};function u(x){return-128<=x&&128>x?i(x,function(y){return new a([y|0],0>y?-1:0)}):new a([x|0],0>x?-1:0)}function d(x){if(isNaN(x)||!isFinite(x))return g;if(0>x)return S(d(-x));for(var y=[],E=1,T=0;x>=E;T++)y[T]=x/E|0,E*=4294967296;return new a(y,0)}function f(x,y){if(x.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(x.charAt(0)=="-")return S(f(x.substring(1),y));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=d(Math.pow(y,8)),T=g,C=0;C<x.length;C+=8){var R=Math.min(8,x.length-C),b=parseInt(x.substring(C,C+R),y);8>R?(R=d(Math.pow(y,R)),T=T.j(R).add(d(b))):(T=T.j(E),T=T.add(d(b)))}return T}var g=u(0),p=u(1),_=u(16777216);t=a.prototype,t.m=function(){if(P(this))return-S(this).m();for(var x=0,y=1,E=0;E<this.g.length;E++){var T=this.i(E);x+=(0<=T?T:4294967296+T)*y,y*=4294967296}return x},t.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(A(this))return"0";if(P(this))return"-"+S(this).toString(x);for(var y=d(Math.pow(x,6)),E=this,T="";;){var C=N(E,y).g;E=w(E,C.j(y));var R=((0<E.g.length?E.g[0]:E.h)>>>0).toString(x);if(E=C,A(E))return R+T;for(;6>R.length;)R="0"+R;T=R+T}},t.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function A(x){if(x.h!=0)return!1;for(var y=0;y<x.g.length;y++)if(x.g[y]!=0)return!1;return!0}function P(x){return x.h==-1}t.l=function(x){return x=w(this,x),P(x)?-1:A(x)?0:1};function S(x){for(var y=x.g.length,E=[],T=0;T<y;T++)E[T]=~x.g[T];return new a(E,~x.h).add(p)}t.abs=function(){return P(this)?S(this):this},t.add=function(x){for(var y=Math.max(this.g.length,x.g.length),E=[],T=0,C=0;C<=y;C++){var R=T+(this.i(C)&65535)+(x.i(C)&65535),b=(R>>>16)+(this.i(C)>>>16)+(x.i(C)>>>16);T=b>>>16,R&=65535,b&=65535,E[C]=b<<16|R}return new a(E,E[E.length-1]&-2147483648?-1:0)};function w(x,y){return x.add(S(y))}t.j=function(x){if(A(this)||A(x))return g;if(P(this))return P(x)?S(this).j(S(x)):S(S(this).j(x));if(P(x))return S(this.j(S(x)));if(0>this.l(_)&&0>x.l(_))return d(this.m()*x.m());for(var y=this.g.length+x.g.length,E=[],T=0;T<2*y;T++)E[T]=0;for(T=0;T<this.g.length;T++)for(var C=0;C<x.g.length;C++){var R=this.i(T)>>>16,b=this.i(T)&65535,ce=x.i(C)>>>16,rr=x.i(C)&65535;E[2*T+2*C]+=b*rr,k(E,2*T+2*C),E[2*T+2*C+1]+=R*rr,k(E,2*T+2*C+1),E[2*T+2*C+1]+=b*ce,k(E,2*T+2*C+1),E[2*T+2*C+2]+=R*ce,k(E,2*T+2*C+2)}for(T=0;T<y;T++)E[T]=E[2*T+1]<<16|E[2*T];for(T=y;T<2*y;T++)E[T]=0;return new a(E,0)};function k(x,y){for(;(x[y]&65535)!=x[y];)x[y+1]+=x[y]>>>16,x[y]&=65535,y++}function I(x,y){this.g=x,this.h=y}function N(x,y){if(A(y))throw Error("division by zero");if(A(x))return new I(g,g);if(P(x))return y=N(S(x),y),new I(S(y.g),S(y.h));if(P(y))return y=N(x,S(y)),new I(S(y.g),y.h);if(30<x.g.length){if(P(x)||P(y))throw Error("slowDivide_ only works with positive integers.");for(var E=p,T=y;0>=T.l(x);)E=O(E),T=O(T);var C=F(E,1),R=F(T,1);for(T=F(T,2),E=F(E,2);!A(T);){var b=R.add(T);0>=b.l(x)&&(C=C.add(E),R=b),T=F(T,1),E=F(E,1)}return y=w(x,C.j(y)),new I(C,y)}for(C=g;0<=x.l(y);){for(E=Math.max(1,Math.floor(x.m()/y.m())),T=Math.ceil(Math.log(E)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),R=d(E),b=R.j(y);P(b)||0<b.l(x);)E-=T,R=d(E),b=R.j(y);A(R)&&(R=p),C=C.add(R),x=w(x,b)}return new I(C,x)}t.A=function(x){return N(this,x).h},t.and=function(x){for(var y=Math.max(this.g.length,x.g.length),E=[],T=0;T<y;T++)E[T]=this.i(T)&x.i(T);return new a(E,this.h&x.h)},t.or=function(x){for(var y=Math.max(this.g.length,x.g.length),E=[],T=0;T<y;T++)E[T]=this.i(T)|x.i(T);return new a(E,this.h|x.h)},t.xor=function(x){for(var y=Math.max(this.g.length,x.g.length),E=[],T=0;T<y;T++)E[T]=this.i(T)^x.i(T);return new a(E,this.h^x.h)};function O(x){for(var y=x.g.length+1,E=[],T=0;T<y;T++)E[T]=x.i(T)<<1|x.i(T-1)>>>31;return new a(E,x.h)}function F(x,y){var E=y>>5;y%=32;for(var T=x.g.length-E,C=[],R=0;R<T;R++)C[R]=0<y?x.i(R+E)>>>y|x.i(R+E+1)<<32-y:x.i(R+E);return new a(C,x.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,sw=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=f,Fn=a}).apply(typeof B0<"u"?B0:typeof self<"u"?self:typeof window<"u"?window:{});var Vl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var iw,Da,aw,ac,nf,ow,lw,cw;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,m){return l==Array.prototype||l==Object.prototype||(l[h]=m.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vl=="object"&&Vl];for(var h=0;h<l.length;++h){var m=l[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var n=r(this);function s(l,h){if(h)e:{var m=n;l=l.split(".");for(var v=0;v<l.length-1;v++){var j=l[v];if(!(j in m))break e;m=m[j]}l=l[l.length-1],v=m[l],h=h(v),h!=v&&h!=null&&e(m,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var m=0,v=!1,j={next:function(){if(!v&&m<l.length){var D=m++;return{value:h(D,l[D]),done:!1}}return v=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function f(l,h,m){return l.call.apply(l.bind,arguments)}function g(l,h,m){if(!l)throw Error();if(2<arguments.length){var v=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,v),l.apply(h,j)}}return function(){return l.apply(h,arguments)}}function p(l,h,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:g,p.apply(null,arguments)}function _(l,h){var m=Array.prototype.slice.call(arguments,1);return function(){var v=m.slice();return v.push.apply(v,arguments),l.apply(this,v)}}function A(l,h){function m(){}m.prototype=h.prototype,l.aa=h.prototype,l.prototype=new m,l.prototype.constructor=l,l.Qb=function(v,j,D){for(var B=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)B[pe-2]=arguments[pe];return h.prototype[j].apply(v,B)}}function P(l){const h=l.length;if(0<h){const m=Array(h);for(let v=0;v<h;v++)m[v]=l[v];return m}return[]}function S(l,h){for(let m=1;m<arguments.length;m++){const v=arguments[m];if(u(v)){const j=l.length||0,D=v.length||0;l.length=j+D;for(let B=0;B<D;B++)l[j+B]=v[B]}else l.push(v)}}class w{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function k(l){return/^[\s\xa0]*$/.test(l)}function I(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function N(l){return N[" "](l),l}N[" "]=function(){};var O=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function F(l,h,m){for(const v in l)h.call(m,l[v],v,l)}function x(l,h){for(const m in l)h.call(void 0,l[m],m,l)}function y(l){const h={};for(const m in l)h[m]=l[m];return h}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(l,h){let m,v;for(let j=1;j<arguments.length;j++){v=arguments[j];for(m in v)l[m]=v[m];for(let D=0;D<E.length;D++)m=E[D],Object.prototype.hasOwnProperty.call(v,m)&&(l[m]=v[m])}}function C(l){var h=1;l=l.split(":");const m=[];for(;0<h&&l.length;)m.push(l.shift()),h--;return l.length&&m.push(l.join(":")),m}function R(l){c.setTimeout(()=>{throw l},0)}function b(){var l=Y;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class ce{constructor(){this.h=this.g=null}add(h,m){const v=rr.get();v.set(h,m),this.h?this.h.next=v:this.g=v,this.h=v}}var rr=new w(()=>new xr,l=>l.reset());class xr{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Rt,$=!1,Y=new ce,ee=()=>{const l=c.Promise.resolve(void 0);Rt=()=>{l.then(_e)}};var _e=()=>{for(var l;l=b();){try{l.h.call(l.g)}catch(m){R(m)}var h=rr;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}$=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ne(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}Ne.prototype.h=function(){this.defaultPrevented=!0};var $t=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const m=()=>{};c.addEventListener("test",m,h),c.removeEventListener("test",m,h)}catch{}return l}();function nr(l,h){if(Ne.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var m=this.type=l.type,v=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(O){e:{try{N(h.nodeName);var j=!0;break e}catch{}j=!1}j||(h=null)}}else m=="mouseover"?h=l.fromElement:m=="mouseout"&&(h=l.toElement);this.relatedTarget=h,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:qt[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&nr.aa.h.call(this)}}A(nr,Ne);var qt={2:"touch",3:"pen",4:"mouse"};nr.prototype.h=function(){nr.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var sr="closure_listenable_"+(1e6*Math.random()|0),Jo=0;function Yu(l,h,m,v,j){this.listener=l,this.proxy=null,this.src=h,this.type=m,this.capture=!!v,this.ha=j,this.key=++Jo,this.da=this.fa=!1}function rs(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Hs(l){this.src=l,this.g={},this.h=0}Hs.prototype.add=function(l,h,m,v,j){var D=l.toString();l=this.g[D],l||(l=this.g[D]=[],this.h++);var B=vr(l,h,v,j);return-1<B?(h=l[B],m||(h.fa=!1)):(h=new Yu(h,this.src,D,!!v,j),h.fa=m,l.push(h)),h};function Ws(l,h){var m=h.type;if(m in l.g){var v=l.g[m],j=Array.prototype.indexOf.call(v,h,void 0),D;(D=0<=j)&&Array.prototype.splice.call(v,j,1),D&&(rs(h),l.g[m].length==0&&(delete l.g[m],l.h--))}}function vr(l,h,m,v){for(var j=0;j<l.length;++j){var D=l[j];if(!D.da&&D.listener==h&&D.capture==!!m&&D.ha==v)return j}return-1}var dn="closure_lm_"+(1e6*Math.random()|0),Fr={};function Ks(l,h,m,v,j){if(Array.isArray(h)){for(var D=0;D<h.length;D++)Ks(l,h[D],m,v,j);return null}return m=wt(m),l&&l[sr]?l.K(h,m,d(v)?!!v.capture:!!v,j):ns(l,h,m,!1,v,j)}function ns(l,h,m,v,j,D){if(!h)throw Error("Invalid event type");var B=d(j)?!!j.capture:!!j,pe=Ys(l);if(pe||(l[dn]=pe=new Hs(l)),m=pe.add(h,m,v,B,D),m.proxy)return m;if(v=ra(),m.proxy=v,v.src=l,v.listener=m,l.addEventListener)$t||(j=B),j===void 0&&(j=!1),l.addEventListener(h.toString(),v,j);else if(l.attachEvent)l.attachEvent(Qs(h.toString()),v);else if(l.addListener&&l.removeListener)l.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return m}function ra(){function l(m){return h.call(l.src,l.listener,m)}const h=Xu;return l}function Gs(l,h,m,v,j){if(Array.isArray(h))for(var D=0;D<h.length;D++)Gs(l,h[D],m,v,j);else v=d(v)?!!v.capture:!!v,m=wt(m),l&&l[sr]?(l=l.i,h=String(h).toString(),h in l.g&&(D=l.g[h],m=vr(D,m,v,j),-1<m&&(rs(D[m]),Array.prototype.splice.call(D,m,1),D.length==0&&(delete l.g[h],l.h--)))):l&&(l=Ys(l))&&(h=l.g[h.toString()],l=-1,h&&(l=vr(h,m,v,j)),(m=-1<l?h[l]:null)&&na(m))}function na(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[sr])Ws(h.i,l);else{var m=l.type,v=l.proxy;h.removeEventListener?h.removeEventListener(m,v,l.capture):h.detachEvent?h.detachEvent(Qs(m),v):h.addListener&&h.removeListener&&h.removeListener(v),(m=Ys(h))?(Ws(m,l),m.h==0&&(m.src=null,h[dn]=null)):rs(l)}}}function Qs(l){return l in Fr?Fr[l]:Fr[l]="on"+l}function Xu(l,h){if(l.da)l=!0;else{h=new nr(h,this);var m=l.listener,v=l.ha||l.src;l.fa&&na(l),l=m.call(v,h)}return l}function Ys(l){return l=l[dn],l instanceof Hs?l:null}var sa="__closure_events_fn_"+(1e9*Math.random()>>>0);function wt(l){return typeof l=="function"?l:(l[sa]||(l[sa]=function(h){return l.handleEvent(h)}),l[sa])}function ye(){he.call(this),this.i=new Hs(this),this.M=this,this.F=null}A(ye,he),ye.prototype[sr]=!0,ye.prototype.removeEventListener=function(l,h,m,v){Gs(this,l,h,m,v)};function Fe(l,h){var m,v=l.F;if(v)for(m=[];v;v=v.F)m.push(v);if(l=l.M,v=h.type||h,typeof h=="string")h=new Ne(h,l);else if(h instanceof Ne)h.target=h.target||l;else{var j=h;h=new Ne(v,l),T(h,j)}if(j=!0,m)for(var D=m.length-1;0<=D;D--){var B=h.g=m[D];j=Xs(B,v,!0,h)&&j}if(B=h.g=l,j=Xs(B,v,!0,h)&&j,j=Xs(B,v,!1,h)&&j,m)for(D=0;D<m.length;D++)B=h.g=m[D],j=Xs(B,v,!1,h)&&j}ye.prototype.N=function(){if(ye.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var m=l.g[h],v=0;v<m.length;v++)rs(m[v]);delete l.g[h],l.h--}}this.F=null},ye.prototype.K=function(l,h,m,v){return this.i.add(String(l),h,!1,m,v)},ye.prototype.L=function(l,h,m,v){return this.i.add(String(l),h,!0,m,v)};function Xs(l,h,m,v){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var j=!0,D=0;D<h.length;++D){var B=h[D];if(B&&!B.da&&B.capture==m){var pe=B.listener,Je=B.ha||B.src;B.fa&&Ws(l.i,B),j=pe.call(Je,v)!==!1&&j}}return j&&!v.defaultPrevented}function Zo(l,h,m){if(typeof l=="function")m&&(l=p(l,m));else if(l&&typeof l.handleEvent=="function")l=p(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(l,h||0)}function ia(l){l.g=Zo(()=>{l.g=null,l.i&&(l.i=!1,ia(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Ju extends he{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:ia(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hn(l){he.call(this),this.h=l,this.g={}}A(hn,he);var ss=[];function ir(l){F(l.g,function(h,m){this.g.hasOwnProperty(m)&&na(h)},l),l.g={}}hn.prototype.N=function(){hn.aa.N.call(this),ir(this)},hn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var aa=c.JSON.stringify,el=c.JSON.parse,Zu=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function oa(){}oa.prototype.h=null;function tl(l){return l.h||(l.h=l.i())}function la(){}var is={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ca(){Ne.call(this,"d")}A(ca,Ne);function ua(){Ne.call(this,"c")}A(ua,Ne);var Ur={},rl=null;function Js(){return rl=rl||new ye}Ur.La="serverreachability";function nl(l){Ne.call(this,Ur.La,l)}A(nl,Ne);function as(l){const h=Js();Fe(h,new nl(h))}Ur.STAT_EVENT="statevent";function sl(l,h){Ne.call(this,Ur.STAT_EVENT,l),this.stat=h}A(sl,Ne);function Xe(l){const h=Js();Fe(h,new sl(h,l))}Ur.Ma="timingevent";function il(l,h){Ne.call(this,Ur.Ma,l),this.size=h}A(il,Ne);function os(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},h)}function ls(){this.g=!0}ls.prototype.xa=function(){this.g=!1};function ed(l,h,m,v,j,D){l.info(function(){if(l.g)if(D)for(var B="",pe=D.split("&"),Je=0;Je<pe.length;Je++){var de=pe[Je].split("=");if(1<de.length){var it=de[0];de=de[1];var at=it.split("_");B=2<=at.length&&at[1]=="type"?B+(it+"="+de+"&"):B+(it+"=redacted&")}}else B=null;else B=D;return"XMLHTTP REQ ("+v+") [attempt "+j+"]: "+h+`
`+m+`
`+B})}function td(l,h,m,v,j,D,B){l.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+j+"]: "+h+`
`+m+`
`+D+" "+B})}function fn(l,h,m,v){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+nd(l,m)+(v?" "+v:"")})}function rd(l,h){l.info(function(){return"TIMEOUT: "+h})}ls.prototype.info=function(){};function nd(l,h){if(!l.g)return h;if(!h)return null;try{var m=JSON.parse(h);if(m){for(l=0;l<m.length;l++)if(Array.isArray(m[l])){var v=m[l];if(!(2>v.length)){var j=v[1];if(Array.isArray(j)&&!(1>j.length)){var D=j[0];if(D!="noop"&&D!="stop"&&D!="close")for(var B=1;B<j.length;B++)j[B]=""}}}}return aa(m)}catch{return h}}var z={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},q={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Se;function _r(){}A(_r,oa),_r.prototype.g=function(){return new XMLHttpRequest},_r.prototype.i=function(){return{}},Se=new _r;function Ht(l,h,m,v){this.j=l,this.i=h,this.l=m,this.R=v||1,this.U=new hn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new vp}function vp(){this.i=null,this.g="",this.h=!1}var _p={},sd={};function id(l,h,m){l.L=1,l.v=cl(zr(h)),l.m=m,l.P=!0,wp(l,null)}function wp(l,h){l.F=Date.now(),al(l),l.A=zr(l.v);var m=l.A,v=l.R;Array.isArray(v)||(v=[String(v)]),Op(m.i,"t",v),l.C=0,m=l.j.J,l.h=new vp,l.g=Zp(l.j,m?h:null,!l.m),0<l.O&&(l.M=new Ju(p(l.Y,l,l.g),l.O)),h=l.U,m=l.g,v=l.ca;var j="readystatechange";Array.isArray(j)||(j&&(ss[0]=j.toString()),j=ss);for(var D=0;D<j.length;D++){var B=Ks(m,j[D],v||h.handleEvent,!1,h.h||h);if(!B)break;h.g[B.key]=B}h=l.H?y(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),as(),ed(l.i,l.u,l.A,l.l,l.R,l.m)}Ht.prototype.ca=function(l){l=l.target;const h=this.M;h&&Br(l)==3?h.j():this.Y(l)},Ht.prototype.Y=function(l){try{if(l==this.g)e:{const at=Br(this.g);var h=this.g.Ba();const ti=this.g.Z();if(!(3>at)&&(at!=3||this.g&&(this.h.h||this.g.oa()||Bp(this.g)))){this.J||at!=4||h==7||(h==8||0>=ti?as(3):as(2)),ad(this);var m=this.g.Z();this.X=m;t:if(kp(this)){var v=Bp(this.g);l="";var j=v.length,D=Br(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){cs(this),da(this);var B="";break t}this.h.i=new c.TextDecoder}for(h=0;h<j;h++)this.h.h=!0,l+=this.h.i.decode(v[h],{stream:!(D&&h==j-1)});v.length=0,this.h.g+=l,this.C=0,B=this.h.g}else B=this.g.oa();if(this.o=m==200,td(this.i,this.u,this.A,this.l,this.R,at,m),this.o){if(this.T&&!this.K){t:{if(this.g){var pe,Je=this.g;if((pe=Je.g?Je.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(pe)){var de=pe;break t}}de=null}if(m=de)fn(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,od(this,m);else{this.o=!1,this.s=3,Xe(12),cs(this),da(this);break e}}if(this.P){m=!0;let ar;for(;!this.J&&this.C<B.length;)if(ar=Y1(this,B),ar==sd){at==4&&(this.s=4,Xe(14),m=!1),fn(this.i,this.l,null,"[Incomplete Response]");break}else if(ar==_p){this.s=4,Xe(15),fn(this.i,this.l,B,"[Invalid Chunk]"),m=!1;break}else fn(this.i,this.l,ar,null),od(this,ar);if(kp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),at!=4||B.length!=0||this.h.h||(this.s=1,Xe(16),m=!1),this.o=this.o&&m,!m)fn(this.i,this.l,B,"[Invalid Chunked Response]"),cs(this),da(this);else if(0<B.length&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.ba&&!it.M&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+B.length),fd(it),it.M=!0,Xe(11))}}else fn(this.i,this.l,B,null),od(this,B);at==4&&cs(this),this.o&&!this.J&&(at==4?Qp(this.j,this):(this.o=!1,al(this)))}else fk(this.g),m==400&&0<B.indexOf("Unknown SID")?(this.s=3,Xe(12)):(this.s=0,Xe(13)),cs(this),da(this)}}}catch{}finally{}};function kp(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Y1(l,h){var m=l.C,v=h.indexOf(`
`,m);return v==-1?sd:(m=Number(h.substring(m,v)),isNaN(m)?_p:(v+=1,v+m>h.length?sd:(h=h.slice(v,v+m),l.C=v+m,h)))}Ht.prototype.cancel=function(){this.J=!0,cs(this)};function al(l){l.S=Date.now()+l.I,bp(l,l.I)}function bp(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=os(p(l.ba,l),h)}function ad(l){l.B&&(c.clearTimeout(l.B),l.B=null)}Ht.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(rd(this.i,this.A),this.L!=2&&(as(),Xe(17)),cs(this),this.s=2,da(this)):bp(this,this.S-l)};function da(l){l.j.G==0||l.J||Qp(l.j,l)}function cs(l){ad(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,ir(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function od(l,h){try{var m=l.j;if(m.G!=0&&(m.g==l||ld(m.h,l))){if(!l.K&&ld(m.h,l)&&m.G==3){try{var v=m.Da.g.parse(h)}catch{v=null}if(Array.isArray(v)&&v.length==3){var j=v;if(j[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<l.F)pl(m),fl(m);else break e;hd(m),Xe(18)}}else m.za=j[1],0<m.za-m.T&&37500>j[2]&&m.F&&m.v==0&&!m.C&&(m.C=os(p(m.Za,m),6e3));if(1>=Ip(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else ds(m,11)}else if((l.K||m.g==l)&&pl(m),!k(h))for(j=m.Da.g.parse(h),h=0;h<j.length;h++){let de=j[h];if(m.T=de[0],de=de[1],m.G==2)if(de[0]=="c"){m.K=de[1],m.ia=de[2];const it=de[3];it!=null&&(m.la=it,m.j.info("VER="+m.la));const at=de[4];at!=null&&(m.Aa=at,m.j.info("SVER="+m.Aa));const ti=de[5];ti!=null&&typeof ti=="number"&&0<ti&&(v=1.5*ti,m.L=v,m.j.info("backChannelRequestTimeoutMs_="+v)),v=m;const ar=l.g;if(ar){const yl=ar.g?ar.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yl){var D=v.h;D.g||yl.indexOf("spdy")==-1&&yl.indexOf("quic")==-1&&yl.indexOf("h2")==-1||(D.j=D.l,D.g=new Set,D.h&&(cd(D,D.h),D.h=null))}if(v.D){const md=ar.g?ar.g.getResponseHeader("X-HTTP-Session-Id"):null;md&&(v.ya=md,we(v.I,v.D,md))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-l.F,m.j.info("Handshake RTT: "+m.R+"ms")),v=m;var B=l;if(v.qa=Jp(v,v.J?v.ia:null,v.W),B.K){Np(v.h,B);var pe=B,Je=v.L;Je&&(pe.I=Je),pe.B&&(ad(pe),al(pe)),v.g=B}else Kp(v);0<m.i.length&&ml(m)}else de[0]!="stop"&&de[0]!="close"||ds(m,7);else m.G==3&&(de[0]=="stop"||de[0]=="close"?de[0]=="stop"?ds(m,7):dd(m):de[0]!="noop"&&m.l&&m.l.ta(de),m.v=0)}}as(4)}catch{}}var X1=class{constructor(l,h){this.g=l,this.map=h}};function Ep(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tp(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Ip(l){return l.h?1:l.g?l.g.size:0}function ld(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function cd(l,h){l.g?l.g.add(h):l.h=h}function Np(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Ep.prototype.cancel=function(){if(this.i=Sp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Sp(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const m of l.g.values())h=h.concat(m.D);return h}return P(l.i)}function J1(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],m=l.length,v=0;v<m;v++)h.push(l[v]);return h}h=[],m=0;for(v in l)h[m++]=l[v];return h}function Z1(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var m=0;m<l;m++)h.push(m);return h}h=[],m=0;for(const v in l)h[m++]=v;return h}}}function Ap(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var m=Z1(l),v=J1(l),j=v.length,D=0;D<j;D++)h.call(void 0,v[D],m&&m[D],l)}var Cp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ek(l,h){if(l){l=l.split("&");for(var m=0;m<l.length;m++){var v=l[m].indexOf("="),j=null;if(0<=v){var D=l[m].substring(0,v);j=l[m].substring(v+1)}else D=l[m];h(D,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function us(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof us){this.h=l.h,ol(this,l.j),this.o=l.o,this.g=l.g,ll(this,l.s),this.l=l.l;var h=l.i,m=new ma;m.i=h.i,h.g&&(m.g=new Map(h.g),m.h=h.h),Rp(this,m),this.m=l.m}else l&&(h=String(l).match(Cp))?(this.h=!1,ol(this,h[1]||"",!0),this.o=ha(h[2]||""),this.g=ha(h[3]||"",!0),ll(this,h[4]),this.l=ha(h[5]||"",!0),Rp(this,h[6]||"",!0),this.m=ha(h[7]||"")):(this.h=!1,this.i=new ma(null,this.h))}us.prototype.toString=function(){var l=[],h=this.j;h&&l.push(fa(h,Pp,!0),":");var m=this.g;return(m||h=="file")&&(l.push("//"),(h=this.o)&&l.push(fa(h,Pp,!0),"@"),l.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&l.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&l.push("/"),l.push(fa(m,m.charAt(0)=="/"?nk:rk,!0))),(m=this.i.toString())&&l.push("?",m),(m=this.m)&&l.push("#",fa(m,ik)),l.join("")};function zr(l){return new us(l)}function ol(l,h,m){l.j=m?ha(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function ll(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function Rp(l,h,m){h instanceof ma?(l.i=h,ak(l.i,l.h)):(m||(h=fa(h,sk)),l.i=new ma(h,l.h))}function we(l,h,m){l.i.set(h,m)}function cl(l){return we(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function ha(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function fa(l,h,m){return typeof l=="string"?(l=encodeURI(l).replace(h,tk),m&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function tk(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Pp=/[#\/\?@]/g,rk=/[#\?:]/g,nk=/[#\?]/g,sk=/[#\?@]/g,ik=/#/g;function ma(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function mn(l){l.g||(l.g=new Map,l.h=0,l.i&&ek(l.i,function(h,m){l.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=ma.prototype,t.add=function(l,h){mn(this),this.i=null,l=Zs(this,l);var m=this.g.get(l);return m||this.g.set(l,m=[]),m.push(h),this.h+=1,this};function jp(l,h){mn(l),h=Zs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Dp(l,h){return mn(l),h=Zs(l,h),l.g.has(h)}t.forEach=function(l,h){mn(this),this.g.forEach(function(m,v){m.forEach(function(j){l.call(h,j,v,this)},this)},this)},t.na=function(){mn(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),m=[];for(let v=0;v<h.length;v++){const j=l[v];for(let D=0;D<j.length;D++)m.push(h[v])}return m},t.V=function(l){mn(this);let h=[];if(typeof l=="string")Dp(this,l)&&(h=h.concat(this.g.get(Zs(this,l))));else{l=Array.from(this.g.values());for(let m=0;m<l.length;m++)h=h.concat(l[m])}return h},t.set=function(l,h){return mn(this),this.i=null,l=Zs(this,l),Dp(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Op(l,h,m){jp(l,h),0<m.length&&(l.i=null,l.g.set(Zs(l,h),P(m)),l.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var m=0;m<h.length;m++){var v=h[m];const D=encodeURIComponent(String(v)),B=this.V(v);for(v=0;v<B.length;v++){var j=D;B[v]!==""&&(j+="="+encodeURIComponent(String(B[v]))),l.push(j)}}return this.i=l.join("&")};function Zs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function ak(l,h){h&&!l.j&&(mn(l),l.i=null,l.g.forEach(function(m,v){var j=v.toLowerCase();v!=j&&(jp(this,v),Op(this,j,m))},l)),l.j=h}function ok(l,h){const m=new ls;if(c.Image){const v=new Image;v.onload=_(pn,m,"TestLoadImage: loaded",!0,h,v),v.onerror=_(pn,m,"TestLoadImage: error",!1,h,v),v.onabort=_(pn,m,"TestLoadImage: abort",!1,h,v),v.ontimeout=_(pn,m,"TestLoadImage: timeout",!1,h,v),c.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=l}else h(!1)}function lk(l,h){const m=new ls,v=new AbortController,j=setTimeout(()=>{v.abort(),pn(m,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:v.signal}).then(D=>{clearTimeout(j),D.ok?pn(m,"TestPingServer: ok",!0,h):pn(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(j),pn(m,"TestPingServer: error",!1,h)})}function pn(l,h,m,v,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),v(m)}catch{}}function ck(){this.g=new Zu}function uk(l,h,m){const v=m||"";try{Ap(l,function(j,D){let B=j;d(j)&&(B=aa(j)),h.push(v+D+"="+encodeURIComponent(B))})}catch(j){throw h.push(v+"type="+encodeURIComponent("_badmap")),j}}function ul(l){this.l=l.Ub||null,this.j=l.eb||!1}A(ul,oa),ul.prototype.g=function(){return new dl(this.l,this.j)},ul.prototype.i=function(l){return function(){return l}}({});function dl(l,h){ye.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(dl,ye),t=dl.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,ga(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,pa(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ga(this)),this.g&&(this.readyState=3,ga(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vp(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vp(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?pa(this):ga(this),this.readyState==3&&Vp(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,pa(this))},t.Qa=function(l){this.g&&(this.response=l,pa(this))},t.ga=function(){this.g&&pa(this)};function pa(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ga(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,l.push(m[0]+": "+m[1]),m=h.next();return l.join(`\r
`)};function ga(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(dl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Mp(l){let h="";return F(l,function(m,v){h+=v,h+=":",h+=m,h+=`\r
`}),h}function ud(l,h,m){e:{for(v in m){var v=!1;break e}v=!0}v||(m=Mp(m),typeof l=="string"?m!=null&&encodeURIComponent(String(m)):we(l,h,m))}function De(l){ye.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(De,ye);var dk=/^https?$/i,hk=["POST","PUT"];t=De.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,m,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Se.g(),this.v=this.o?tl(this.o):tl(Se),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(D){Lp(this,D);return}if(l=m||"",m=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var j in v)m.set(j,v[j]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const D of v.keys())m.set(D,v.get(D));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(m.keys()).find(D=>D.toLowerCase()=="content-type"),j=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(hk,h,void 0))||v||j||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[D,B]of m)this.g.setRequestHeader(D,B);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zp(this),this.u=!0,this.g.send(l),this.u=!1}catch(D){Lp(this,D)}};function Lp(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Fp(l),hl(l)}function Fp(l){l.A||(l.A=!0,Fe(l,"complete"),Fe(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Fe(this,"complete"),Fe(this,"abort"),hl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hl(this,!0)),De.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Up(this):this.bb())},t.bb=function(){Up(this)};function Up(l){if(l.h&&typeof a<"u"&&(!l.v[1]||Br(l)!=4||l.Z()!=2)){if(l.u&&Br(l)==4)Zo(l.Ea,0,l);else if(Fe(l,"readystatechange"),Br(l)==4){l.h=!1;try{const B=l.Z();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var v;if(v=B===0){var j=String(l.D).match(Cp)[1]||null;!j&&c.self&&c.self.location&&(j=c.self.location.protocol.slice(0,-1)),v=!dk.test(j?j.toLowerCase():"")}m=v}if(m)Fe(l,"complete"),Fe(l,"success");else{l.m=6;try{var D=2<Br(l)?l.g.statusText:""}catch{D=""}l.l=D+" ["+l.Z()+"]",Fp(l)}}finally{hl(l)}}}}function hl(l,h){if(l.g){zp(l);const m=l.g,v=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||Fe(l,"ready");try{m.onreadystatechange=v}catch{}}}function zp(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function Br(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<Br(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),el(h)}};function Bp(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function fk(l){const h={};l=(l.g&&2<=Br(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<l.length;v++){if(k(l[v]))continue;var m=C(l[v]);const j=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const D=h[j]||[];h[j]=D,D.push(m)}x(h,function(v){return v.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ya(l,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[l]||h}function $p(l){this.Aa=0,this.i=[],this.j=new ls,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ya("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ya("baseRetryDelayMs",5e3,l),this.cb=ya("retryDelaySeedMs",1e4,l),this.Wa=ya("forwardChannelMaxRetries",2,l),this.wa=ya("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Ep(l&&l.concurrentRequestLimit),this.Da=new ck,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=$p.prototype,t.la=8,t.G=1,t.connect=function(l,h,m,v){Xe(0),this.W=l,this.H=h||{},m&&v!==void 0&&(this.H.OSID=m,this.H.OAID=v),this.F=this.X,this.I=Jp(this,null,this.W),ml(this)};function dd(l){if(qp(l),l.G==3){var h=l.U++,m=zr(l.I);if(we(m,"SID",l.K),we(m,"RID",h),we(m,"TYPE","terminate"),xa(l,m),h=new Ht(l,l.j,h),h.L=2,h.v=cl(zr(m)),m=!1,c.navigator&&c.navigator.sendBeacon)try{m=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!m&&c.Image&&(new Image().src=h.v,m=!0),m||(h.g=Zp(h.j,null),h.g.ea(h.v)),h.F=Date.now(),al(h)}Xp(l)}function fl(l){l.g&&(fd(l),l.g.cancel(),l.g=null)}function qp(l){fl(l),l.u&&(c.clearTimeout(l.u),l.u=null),pl(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function ml(l){if(!Tp(l.h)&&!l.s){l.s=!0;var h=l.Ga;Rt||ee(),$||(Rt(),$=!0),Y.add(h,l),l.B=0}}function mk(l,h){return Ip(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=os(p(l.Ga,l,h),Yp(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const j=new Ht(this,this.j,l);let D=this.o;if(this.S&&(D?(D=y(D),T(D,this.S)):D=this.S),this.m!==null||this.O||(j.H=D,D=null),this.P)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var v=this.i[m];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break t}v=void 0}if(v===void 0)break;if(h+=v,4096<h){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=Wp(this,j,h),m=zr(this.I),we(m,"RID",l),we(m,"CVER",22),this.D&&we(m,"X-HTTP-Session-Id",this.D),xa(this,m),D&&(this.O?h="headers="+encodeURIComponent(String(Mp(D)))+"&"+h:this.m&&ud(m,this.m,D)),cd(this.h,j),this.Ua&&we(m,"TYPE","init"),this.P?(we(m,"$req",h),we(m,"SID","null"),j.T=!0,id(j,m,null)):id(j,m,h),this.G=2}}else this.G==3&&(l?Hp(this,l):this.i.length==0||Tp(this.h)||Hp(this))};function Hp(l,h){var m;h?m=h.l:m=l.U++;const v=zr(l.I);we(v,"SID",l.K),we(v,"RID",m),we(v,"AID",l.T),xa(l,v),l.m&&l.o&&ud(v,l.m,l.o),m=new Ht(l,l.j,m,l.B+1),l.m===null&&(m.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Wp(l,m,1e3),m.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),cd(l.h,m),id(m,v,h)}function xa(l,h){l.H&&F(l.H,function(m,v){we(h,v,m)}),l.l&&Ap({},function(m,v){we(h,v,m)})}function Wp(l,h,m){m=Math.min(l.i.length,m);var v=l.l?p(l.l.Na,l.l,l):null;e:{var j=l.i;let D=-1;for(;;){const B=["count="+m];D==-1?0<m?(D=j[0].g,B.push("ofs="+D)):D=0:B.push("ofs="+D);let pe=!0;for(let Je=0;Je<m;Je++){let de=j[Je].g;const it=j[Je].map;if(de-=D,0>de)D=Math.max(0,j[Je].g-100),pe=!1;else try{uk(it,B,"req"+de+"_")}catch{v&&v(it)}}if(pe){v=B.join("&");break e}}}return l=l.i.splice(0,m),h.D=l,v}function Kp(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;Rt||ee(),$||(Rt(),$=!0),Y.add(h,l),l.v=0}}function hd(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=os(p(l.Fa,l),Yp(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Gp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=os(p(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Xe(10),fl(this),Gp(this))};function fd(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Gp(l){l.g=new Ht(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=zr(l.qa);we(h,"RID","rpc"),we(h,"SID",l.K),we(h,"AID",l.T),we(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&we(h,"TO",l.ja),we(h,"TYPE","xmlhttp"),xa(l,h),l.m&&l.o&&ud(h,l.m,l.o),l.L&&(l.g.I=l.L);var m=l.g;l=l.ia,m.L=1,m.v=cl(zr(h)),m.m=null,m.P=!0,wp(m,l)}t.Za=function(){this.C!=null&&(this.C=null,fl(this),hd(this),Xe(19))};function pl(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Qp(l,h){var m=null;if(l.g==h){pl(l),fd(l),l.g=null;var v=2}else if(ld(l.h,h))m=h.D,Np(l.h,h),v=1;else return;if(l.G!=0){if(h.o)if(v==1){m=h.m?h.m.length:0,h=Date.now()-h.F;var j=l.B;v=Js(),Fe(v,new il(v,m)),ml(l)}else Kp(l);else if(j=h.s,j==3||j==0&&0<h.X||!(v==1&&mk(l,h)||v==2&&hd(l)))switch(m&&0<m.length&&(h=l.h,h.i=h.i.concat(m)),j){case 1:ds(l,5);break;case 4:ds(l,10);break;case 3:ds(l,6);break;default:ds(l,2)}}}function Yp(l,h){let m=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(m*=2),m*h}function ds(l,h){if(l.j.info("Error code "+h),h==2){var m=p(l.fb,l),v=l.Xa;const j=!v;v=new us(v||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||ol(v,"https"),cl(v),j?ok(v.toString(),m):lk(v.toString(),m)}else Xe(2);l.G=0,l.l&&l.l.sa(h),Xp(l),qp(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Xe(2)):(this.j.info("Failed to ping google.com"),Xe(1))};function Xp(l){if(l.G=0,l.ka=[],l.l){const h=Sp(l.h);(h.length!=0||l.i.length!=0)&&(S(l.ka,h),S(l.ka,l.i),l.h.i.length=0,P(l.i),l.i.length=0),l.l.ra()}}function Jp(l,h,m){var v=m instanceof us?zr(m):new us(m);if(v.g!="")h&&(v.g=h+"."+v.g),ll(v,v.s);else{var j=c.location;v=j.protocol,h=h?h+"."+j.hostname:j.hostname,j=+j.port;var D=new us(null);v&&ol(D,v),h&&(D.g=h),j&&ll(D,j),m&&(D.l=m),v=D}return m=l.D,h=l.ya,m&&h&&we(v,m,h),we(v,"VER",l.la),xa(l,v),v}function Zp(l,h,m){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new De(new ul({eb:m})):new De(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function eg(){}t=eg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function gl(){}gl.prototype.g=function(l,h){return new Pt(l,h)};function Pt(l,h){ye.call(this),this.g=new $p(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!k(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!k(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new ei(this)}A(Pt,ye),Pt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Pt.prototype.close=function(){dd(this.g)},Pt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var m={};m.__data__=l,l=m}else this.u&&(m={},m.__data__=aa(l),l=m);h.i.push(new X1(h.Ya++,l)),h.G==3&&ml(h)},Pt.prototype.N=function(){this.g.l=null,delete this.j,dd(this.g),delete this.g,Pt.aa.N.call(this)};function tg(l){ca.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const m in h){l=m;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}A(tg,ca);function rg(){ua.call(this),this.status=1}A(rg,ua);function ei(l){this.g=l}A(ei,eg),ei.prototype.ua=function(){Fe(this.g,"a")},ei.prototype.ta=function(l){Fe(this.g,new tg(l))},ei.prototype.sa=function(l){Fe(this.g,new rg)},ei.prototype.ra=function(){Fe(this.g,"b")},gl.prototype.createWebChannel=gl.prototype.g,Pt.prototype.send=Pt.prototype.o,Pt.prototype.open=Pt.prototype.m,Pt.prototype.close=Pt.prototype.close,cw=function(){return new gl},lw=function(){return Js()},ow=Ur,nf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},z.NO_ERROR=0,z.TIMEOUT=8,z.HTTP_ERROR=6,ac=z,q.COMPLETE="complete",aw=q,la.EventType=is,is.OPEN="a",is.CLOSE="b",is.ERROR="c",is.MESSAGE="d",ye.prototype.listen=ye.prototype.K,Da=la,De.prototype.listenOnce=De.prototype.L,De.prototype.getLastError=De.prototype.Ka,De.prototype.getLastErrorCode=De.prototype.Ba,De.prototype.getStatus=De.prototype.Z,De.prototype.getResponseJson=De.prototype.Oa,De.prototype.getResponseText=De.prototype.oa,De.prototype.send=De.prototype.ea,De.prototype.setWithCredentials=De.prototype.Ha,iw=De}).apply(typeof Vl<"u"?Vl:typeof self<"u"?self:typeof window<"u"?window:{});const $0="@firebase/firestore",q0="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ut=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ut.UNAUTHENTICATED=new ut(null),ut.GOOGLE_CREDENTIALS=new ut("google-credentials-uid"),ut.FIRST_PARTY=new ut("first-party-uid"),ut.MOCK_USER=new ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gi="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js=new km("@firebase/firestore");function ni(){return js.logLevel}function W(t,...e){if(js.logLevel<=se.DEBUG){const r=e.map(jm);js.debug(`Firestore (${Gi}): ${t}`,...r)}}function sn(t,...e){if(js.logLevel<=se.ERROR){const r=e.map(jm);js.error(`Firestore (${Gi}): ${t}`,...r)}}function Li(t,...e){if(js.logLevel<=se.WARN){const r=e.map(jm);js.warn(`Firestore (${Gi}): ${t}`,...r)}}function jm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,uw(t,n,r)}function uw(t,e,r){let n=`FIRESTORE (${Gi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw sn(n),new Error(n)}function fe(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||uw(e,s,n)}function te(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class H extends Vr{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ut.UNAUTHENTICATED))}shutdown(){}}class WN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class KN{constructor(e){this.t=e,this.currentUser=ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){fe(this.o===void 0,42304);let n=this.i;const s=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let i=new Xr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Xr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Xr)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(fe(typeof n.accessToken=="string",31837,{l:n}),new dw(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return fe(e===null||typeof e=="string",2055,{h:e}),new ut(e)}}class GN{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=ut.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class QN{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new GN(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class H0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class YN{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Dt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){fe(this.o===void 0,3512);const n=i=>{i.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,W("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new H0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(fe(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new H0(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XN(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=XN(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function ie(t,e){return t<e?-1:t>e?1:0}function sf(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),i=e.charAt(n);if(s!==i)return Gd(s)===Gd(i)?ie(s,i):Gd(s)?1:-1}return ie(t.length,e.length)}const JN=55296,ZN=57343;function Gd(t){const e=t.charCodeAt(0);return e>=JN&&e<=ZN}function Fi(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0="__name__";class br{constructor(e,r,n){r===void 0?r=0:r>e.length&&J(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&J(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return br.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof br?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=br.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return ie(e.length,r.length)}static compareSegments(e,r){const n=br.isNumericId(e),s=br.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?br.extractNumericId(e).compare(br.extractNumericId(r)):sf(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fn.fromString(e.substring(4,e.length-2))}}class xe extends br{construct(e,r,n){return new xe(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new H(V.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new xe(r)}static emptyPath(){return new xe([])}}const eS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tt extends br{construct(e,r,n){return new tt(e,r,n)}static isValidIdentifier(e){return eS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===W0}static keyField(){return new tt([W0])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new H(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new H(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(n+=c,s++):(i(),s++)}if(i(),a)throw new H(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tt(r)}static emptyPath(){return new tt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.path=e}static fromPath(e){return new G(xe.fromString(e))}static fromName(e){return new G(xe.fromString(e).popFirst(5))}static empty(){return new G(xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return xe.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new G(new xe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(t,e,r){if(!r)throw new H(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function tS(t,e,r,n){if(e===!0&&n===!0)throw new H(V.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function K0(t){if(!G.isDocumentKey(t))throw new H(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function G0(t){if(G.isDocumentKey(t))throw new H(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fw(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Su(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":J(12329,{type:typeof t})}function Ft(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new H(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Su(t);throw new H(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $e(t,e){const r={typeString:t};return e&&(r.value=e),r}function Fo(t,e){if(!fw(t))throw new H(V.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(s&&typeof a!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new H(V.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=-62135596800,Y0=1e6;class ge{static now(){return ge.fromMillis(Date.now())}static fromDate(e){return ge.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Y0);return new ge(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Q0)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Y0}_compareTo(e){return this.seconds===e.seconds?ie(this.nanoseconds,e.nanoseconds):ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ge._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Fo(e,ge._jsonSchema))return new ge(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Q0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ge._jsonSchemaVersion="firestore/timestamp/1.0",ge._jsonSchema={type:$e("string",ge._jsonSchemaVersion),seconds:$e("number"),nanoseconds:$e("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{static fromTimestamp(e){return new Z(e)}static min(){return new Z(new ge(0,0))}static max(){return new Z(new ge(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo=-1;function rS(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Z.fromTimestamp(n===1e9?new ge(r+1,0):new ge(r,n));return new qn(s,G.empty(),e)}function nS(t){return new qn(t.readTime,t.key,vo)}class qn{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new qn(Z.min(),G.empty(),vo)}static max(){return new qn(Z.max(),G.empty(),vo)}}function sS(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=G.comparator(t.documentKey,e.documentKey),r!==0?r:ie(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class aS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qi(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==iS)throw t;W("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&J(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new M((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof M?r:M.resolve(r)}catch(r){return M.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):M.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):M.reject(r)}static resolve(e){return new M((r,n)=>{r(e)})}static reject(e){return new M((r,n)=>{n(e)})}static waitFor(e){return new M((r,n)=>{let s=0,i=0,a=!1;e.forEach(c=>{++s,c.next(()=>{++i,a&&i===s&&r()},u=>n(u))}),a=!0,i===s&&r()})}static or(e){let r=M.resolve(!1);for(const n of e)r=r.next(s=>s?M.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new M((n,s)=>{const i=e.length,a=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;r(e[d]).next(f=>{a[d]=f,++c,c===i&&n(a)},f=>s(f))}})}static doWhile(e,r){return new M((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function oS(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Yi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Au.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om=-1;function Cu(t){return t==null}function Hc(t){return t===0&&1/t==-1/0}function lS(t){return typeof t=="number"&&Number.isInteger(t)&&!Hc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw="";function cS(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=X0(e)),e=uS(t.get(r),e);return X0(e)}function uS(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case mw:r+="";break;default:r+=i}}return r}function X0(t){return t+mw+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function es(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function pw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,r){this.comparator=e,this.root=r||et.EMPTY}insert(e,r){return new je(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,et.BLACK,null,null))}remove(e){return new je(this.comparator,this.root.remove(e,this.comparator).copy(null,null,et.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ml(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ml(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ml(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ml(this.root,e,this.comparator,!0)}}class Ml{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class et{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??et.RED,this.left=s??et.EMPTY,this.right=i??et.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new et(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return et.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return et.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw J(43730,{key:this.key,value:this.value});if(this.right.isRed())throw J(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw J(27949);return e+(this.isRed()?0:1)}}et.EMPTY=null,et.RED=!0,et.BLACK=!1;et.EMPTY=new class{constructor(){this.size=0}get key(){throw J(57766)}get value(){throw J(16141)}get color(){throw J(16727)}get left(){throw J(29726)}get right(){throw J(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new et(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.comparator=e,this.data=new je(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Z0(this.data.getIterator())}getIteratorFrom(e){return new Z0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Ke)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Ke(this.comparator);return r.data=e,r}}class Z0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.fields=e,e.sort(tt.comparator)}static empty(){return new Vt([])}unionWith(e){let r=new Ke(tt.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Vt(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Fi(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new gw("Invalid base64 string: "+i):i}}(e);return new st(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new st(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}st.EMPTY_BYTE_STRING=new st("");const dS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hn(t){if(fe(!!t,39018),typeof t=="string"){let e=0;const r=dS.exec(t);if(fe(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ve(t.seconds),nanos:Ve(t.nanos)}}function Ve(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Wn(t){return typeof t=="string"?st.fromBase64String(t):st.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw="server_timestamp",xw="__type__",vw="__previous_value__",_w="__local_write_time__";function Vm(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[xw])==null?void 0:n.stringValue)===yw}function Ru(t){const e=t.mapValue.fields[vw];return Vm(e)?Ru(e):e}function _o(t){const e=Hn(t.mapValue.fields[_w].timestampValue);return new ge(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e,r,n,s,i,a,c,u,d,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=f}}const Wc="(default)";class wo{constructor(e,r){this.projectId=e,this.database=r||Wc}static empty(){return new wo("","")}get isDefaultDatabase(){return this.database===Wc}isEqual(e){return e instanceof wo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww="__type__",kw="__max__",Ll={mapValue:{fields:{__type__:{stringValue:kw}}}},bw="__vector__",Kc="value";function Kn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Vm(t)?4:mS(t)?9007199254740991:fS(t)?10:11:J(28295,{value:t})}function Dr(t,e){if(t===e)return!0;const r=Kn(t);if(r!==Kn(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return _o(t).isEqual(_o(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Hn(s.timestampValue),c=Hn(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Wn(s.bytesValue).isEqual(Wn(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ve(s.geoPointValue.latitude)===Ve(i.geoPointValue.latitude)&&Ve(s.geoPointValue.longitude)===Ve(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ve(s.integerValue)===Ve(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Ve(s.doubleValue),c=Ve(i.doubleValue);return a===c?Hc(a)===Hc(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return Fi(t.arrayValue.values||[],e.arrayValue.values||[],Dr);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(J0(a)!==J0(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!Dr(a[u],c[u])))return!1;return!0}(t,e);default:return J(52216,{left:t})}}function ko(t,e){return(t.values||[]).find(r=>Dr(r,e))!==void 0}function Ui(t,e){if(t===e)return 0;const r=Kn(t),n=Kn(e);if(r!==n)return ie(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ie(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=Ve(i.integerValue||i.doubleValue),u=Ve(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return ey(t.timestampValue,e.timestampValue);case 4:return ey(_o(t),_o(e));case 5:return sf(t.stringValue,e.stringValue);case 6:return function(i,a){const c=Wn(i),u=Wn(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),u=a.split("/");for(let d=0;d<c.length&&d<u.length;d++){const f=ie(c[d],u[d]);if(f!==0)return f}return ie(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=ie(Ve(i.latitude),Ve(a.latitude));return c!==0?c:ie(Ve(i.longitude),Ve(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return ty(t.arrayValue,e.arrayValue);case 10:return function(i,a){var p,_,A,P;const c=i.fields||{},u=a.fields||{},d=(p=c[Kc])==null?void 0:p.arrayValue,f=(_=u[Kc])==null?void 0:_.arrayValue,g=ie(((A=d==null?void 0:d.values)==null?void 0:A.length)||0,((P=f==null?void 0:f.values)==null?void 0:P.length)||0);return g!==0?g:ty(d,f)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Ll.mapValue&&a===Ll.mapValue)return 0;if(i===Ll.mapValue)return 1;if(a===Ll.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=a.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let g=0;g<u.length&&g<f.length;++g){const p=sf(u[g],f[g]);if(p!==0)return p;const _=Ui(c[u[g]],d[f[g]]);if(_!==0)return _}return ie(u.length,f.length)}(t.mapValue,e.mapValue);default:throw J(23264,{he:r})}}function ey(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ie(t,e);const r=Hn(t),n=Hn(e),s=ie(r.seconds,n.seconds);return s!==0?s:ie(r.nanos,n.nanos)}function ty(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Ui(r[s],n[s]);if(i)return i}return ie(r.length,n.length)}function zi(t){return af(t)}function af(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Hn(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Wn(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return G.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=af(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${af(r.fields[a])}`;return s+"}"}(t.mapValue):J(61005,{value:t})}function oc(t){switch(Kn(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ru(t);return e?16+oc(e):16;case 5:return 2*t.stringValue.length;case 6:return Wn(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,i)=>s+oc(i),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return es(n.fields,(i,a)=>{s+=i.length+oc(a)}),s}(t.mapValue);default:throw J(13486,{value:t})}}function ry(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function of(t){return!!t&&"integerValue"in t}function Mm(t){return!!t&&"arrayValue"in t}function ny(t){return!!t&&"nullValue"in t}function sy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function lc(t){return!!t&&"mapValue"in t}function fS(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[ww])==null?void 0:n.stringValue)===bw}function Qa(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return es(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Qa(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Qa(t.arrayValue.values[r]);return e}return{...t}}function mS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===kw}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.value=e}static empty(){return new Et({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!lc(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qa(r)}setAll(e){let r=tt.emptyPath(),n={},s=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,s),n={},s=[],r=c.popLast()}a?n[c.lastSegment()]=Qa(a):s.push(c.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());lc(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Dr(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];lc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){es(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new Et(Qa(this.value))}}function Ew(t){const e=[];return es(t.fields,(r,n)=>{const s=new tt([r]);if(lc(n)){const i=Ew(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Vt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,r,n,s,i,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new ht(e,0,Z.min(),Z.min(),Z.min(),Et.empty(),0)}static newFoundDocument(e,r,n,s){return new ht(e,1,r,Z.min(),n,s,0)}static newNoDocument(e,r){return new ht(e,2,r,Z.min(),Z.min(),Et.empty(),0)}static newUnknownDocument(e,r){return new ht(e,3,r,Z.min(),Z.min(),Et.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Et.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Et.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ht&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ht(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(e,r){this.position=e,this.inclusive=r}}function iy(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=G.comparator(G.fromName(a.referenceValue),r.key):n=Ui(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function ay(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Dr(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,r="asc"){this.field=e,this.dir=r}}function pS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tw=class{};class Be extends Tw{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new yS(e,r,n):r==="array-contains"?new _S(e,n):r==="in"?new wS(e,n):r==="not-in"?new kS(e,n):r==="array-contains-any"?new bS(e,n):new Be(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new xS(e,n):new vS(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Ui(r,this.value)):r!==null&&Kn(this.value)===Kn(r)&&this.matchesComparison(Ui(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yr extends Tw{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new yr(e,r)}matches(e){return Iw(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Iw(t){return t.op==="and"}function Nw(t){return gS(t)&&Iw(t)}function gS(t){for(const e of t.filters)if(e instanceof yr)return!1;return!0}function lf(t){if(t instanceof Be)return t.field.canonicalString()+t.op.toString()+zi(t.value);if(Nw(t))return t.filters.map(e=>lf(e)).join(",");{const e=t.filters.map(r=>lf(r)).join(",");return`${t.op}(${e})`}}function Sw(t,e){return t instanceof Be?function(n,s){return s instanceof Be&&n.op===s.op&&n.field.isEqual(s.field)&&Dr(n.value,s.value)}(t,e):t instanceof yr?function(n,s){return s instanceof yr&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,c)=>i&&Sw(a,s.filters[c]),!0):!1}(t,e):void J(19439)}function Aw(t){return t instanceof Be?function(r){return`${r.field.canonicalString()} ${r.op} ${zi(r.value)}`}(t):t instanceof yr?function(r){return r.op.toString()+" {"+r.getFilters().map(Aw).join(" ,")+"}"}(t):"Filter"}class yS extends Be{constructor(e,r,n){super(e,r,n),this.key=G.fromName(n.referenceValue)}matches(e){const r=G.comparator(e.key,this.key);return this.matchesComparison(r)}}class xS extends Be{constructor(e,r){super(e,"in",r),this.keys=Cw("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class vS extends Be{constructor(e,r){super(e,"not-in",r),this.keys=Cw("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Cw(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>G.fromName(n.referenceValue))}class _S extends Be{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Mm(r)&&ko(r.arrayValue,this.value)}}class wS extends Be{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&ko(this.value.arrayValue,r)}}class kS extends Be{constructor(e,r){super(e,"not-in",r)}matches(e){if(ko(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!ko(this.value.arrayValue,r)}}class bS extends Be{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Mm(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>ko(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,r=null,n=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function oy(t,e=null,r=[],n=[],s=null,i=null,a=null){return new ES(t,e,r,n,s,i,a)}function Lm(t){const e=te(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>lf(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Cu(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>zi(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>zi(n)).join(",")),e.Te=r}return e.Te}function Fm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!pS(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Sw(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ay(t.startAt,e.startAt)&&ay(t.endAt,e.endAt)}function cf(t){return G.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,r=null,n=[],s=[],i=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function TS(t,e,r,n,s,i,a,c){return new Uo(t,e,r,n,s,i,a,c)}function Pu(t){return new Uo(t)}function ly(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Rw(t){return t.collectionGroup!==null}function Ya(t){const e=te(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Ke(tt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Qc(i,n))}),r.has(tt.keyField().canonicalString())||e.Ie.push(new Qc(tt.keyField(),n))}return e.Ie}function Cr(t){const e=te(t);return e.Ee||(e.Ee=IS(e,Ya(t))),e.Ee}function IS(t,e){if(t.limitType==="F")return oy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Qc(s.field,i)});const r=t.endAt?new Gc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Gc(t.startAt.position,t.startAt.inclusive):null;return oy(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function uf(t,e){const r=t.filters.concat([e]);return new Uo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function df(t,e,r){return new Uo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function ju(t,e){return Fm(Cr(t),Cr(e))&&t.limitType===e.limitType}function Pw(t){return`${Lm(Cr(t))}|lt:${t.limitType}`}function si(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Aw(s)).join(", ")}]`),Cu(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>zi(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>zi(s)).join(",")),`Target(${n})`}(Cr(t))}; limitType=${t.limitType})`}function Du(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):G.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of Ya(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,c,u){const d=iy(a,c,u);return a.inclusive?d<=0:d<0}(n.startAt,Ya(n),s)||n.endAt&&!function(a,c,u){const d=iy(a,c,u);return a.inclusive?d>=0:d>0}(n.endAt,Ya(n),s))}(t,e)}function NS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function jw(t){return(e,r)=>{let n=!1;for(const s of Ya(t)){const i=SS(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function SS(t,e,r){const n=t.field.isKeyField()?G.comparator(e.key,r.key):function(i,a,c){const u=a.data.field(i),d=c.data.field(i);return u!==null&&d!==null?Ui(u,d):J(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return J(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){es(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return pw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=new je(G.comparator);function an(){return AS}const Dw=new je(G.comparator);function Oa(...t){let e=Dw;for(const r of t)e=e.insert(r.key,r);return e}function Ow(t){let e=Dw;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function xs(){return Xa()}function Vw(){return Xa()}function Xa(){return new Bs(t=>t.toString(),(t,e)=>t.isEqual(e))}const CS=new je(G.comparator),RS=new Ke(G.comparator);function ae(...t){let e=RS;for(const r of t)e=e.add(r);return e}const PS=new Ke(ie);function jS(){return PS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hc(e)?"-0":e}}function Mw(t){return{integerValue:""+t}}function DS(t,e){return lS(e)?Mw(e):Um(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(){this._=void 0}}function OS(t,e,r){return t instanceof bo?function(s,i){const a={fields:{[xw]:{stringValue:yw},[_w]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Vm(i)&&(i=Ru(i)),i&&(a.fields[vw]=i),{mapValue:a}}(r,e):t instanceof Eo?Fw(t,e):t instanceof To?Uw(t,e):function(s,i){const a=Lw(s,i),c=cy(a)+cy(s.Ae);return of(a)&&of(s.Ae)?Mw(c):Um(s.serializer,c)}(t,e)}function VS(t,e,r){return t instanceof Eo?Fw(t,e):t instanceof To?Uw(t,e):r}function Lw(t,e){return t instanceof Yc?function(n){return of(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class bo extends Ou{}class Eo extends Ou{constructor(e){super(),this.elements=e}}function Fw(t,e){const r=zw(e);for(const n of t.elements)r.some(s=>Dr(s,n))||r.push(n);return{arrayValue:{values:r}}}class To extends Ou{constructor(e){super(),this.elements=e}}function Uw(t,e){let r=zw(e);for(const n of t.elements)r=r.filter(s=>!Dr(s,n));return{arrayValue:{values:r}}}class Yc extends Ou{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function cy(t){return Ve(t.integerValue||t.doubleValue)}function zw(t){return Mm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,r){this.field=e,this.transform=r}}function LS(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Eo&&s instanceof Eo||n instanceof To&&s instanceof To?Fi(n.elements,s.elements,Dr):n instanceof Yc&&s instanceof Yc?Dr(n.Ae,s.Ae):n instanceof bo&&s instanceof bo}(t.transform,e.transform)}class FS{constructor(e,r){this.version=e,this.transformResults=r}}class Ct{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Ct}static exists(e){return new Ct(void 0,e)}static updateTime(e){return new Ct(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Vu{}function Bw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Mu(t.key,Ct.none()):new zo(t.key,t.data,Ct.none());{const r=t.data,n=Et.empty();let s=new Ke(tt.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new ts(t.key,n,new Vt(s.toArray()),Ct.none())}}function US(t,e,r){t instanceof zo?function(s,i,a){const c=s.value.clone(),u=dy(s.fieldTransforms,i,a.transformResults);c.setAll(u),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof ts?function(s,i,a){if(!cc(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=dy(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll($w(s)),u.setAll(c),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Ja(t,e,r,n){return t instanceof zo?function(i,a,c,u){if(!cc(i.precondition,a))return c;const d=i.value.clone(),f=hy(i.fieldTransforms,u,a);return d.setAll(f),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof ts?function(i,a,c,u){if(!cc(i.precondition,a))return c;const d=hy(i.fieldTransforms,u,a),f=a.data;return f.setAll($w(i)),f.setAll(d),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,r,n):function(i,a,c){return cc(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function zS(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=Lw(n.transform,s||null);i!=null&&(r===null&&(r=Et.empty()),r.set(n.field,i))}return r||null}function uy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Fi(n,s,(i,a)=>LS(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class zo extends Vu{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ts extends Vu{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function $w(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function dy(t,e,r){const n=new Map;fe(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,c=e.data.field(i.field);n.set(i.field,VS(a,c,r[s]))}return n}function hy(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,OS(i,a,e))}return n}class Mu extends Vu{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class BS extends Vu{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&US(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Ja(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Ja(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Vw();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=r.has(s.key)?null:c;const u=Bw(a,c);u!==null&&n.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(Z.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),ae())}isEqual(e){return this.batchId===e.batchId&&Fi(this.mutations,e.mutations,(r,n)=>uy(r,n))&&Fi(this.baseMutations,e.baseMutations,(r,n)=>uy(r,n))}}class zm{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){fe(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return CS}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new zm(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue,le;function WS(t){switch(t){case V.OK:return J(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return J(15467,{code:t})}}function qw(t){if(t===void 0)return sn("GRPC error has no .code"),V.UNKNOWN;switch(t){case Ue.OK:return V.OK;case Ue.CANCELLED:return V.CANCELLED;case Ue.UNKNOWN:return V.UNKNOWN;case Ue.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case Ue.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case Ue.INTERNAL:return V.INTERNAL;case Ue.UNAVAILABLE:return V.UNAVAILABLE;case Ue.UNAUTHENTICATED:return V.UNAUTHENTICATED;case Ue.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case Ue.NOT_FOUND:return V.NOT_FOUND;case Ue.ALREADY_EXISTS:return V.ALREADY_EXISTS;case Ue.PERMISSION_DENIED:return V.PERMISSION_DENIED;case Ue.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case Ue.ABORTED:return V.ABORTED;case Ue.OUT_OF_RANGE:return V.OUT_OF_RANGE;case Ue.UNIMPLEMENTED:return V.UNIMPLEMENTED;case Ue.DATA_LOSS:return V.DATA_LOSS;default:return J(39323,{code:t})}}(le=Ue||(Ue={}))[le.OK=0]="OK",le[le.CANCELLED=1]="CANCELLED",le[le.UNKNOWN=2]="UNKNOWN",le[le.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",le[le.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",le[le.NOT_FOUND=5]="NOT_FOUND",le[le.ALREADY_EXISTS=6]="ALREADY_EXISTS",le[le.PERMISSION_DENIED=7]="PERMISSION_DENIED",le[le.UNAUTHENTICATED=16]="UNAUTHENTICATED",le[le.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",le[le.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",le[le.ABORTED=10]="ABORTED",le[le.OUT_OF_RANGE=11]="OUT_OF_RANGE",le[le.UNIMPLEMENTED=12]="UNIMPLEMENTED",le[le.INTERNAL=13]="INTERNAL",le[le.UNAVAILABLE=14]="UNAVAILABLE",le[le.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS=new Fn([4294967295,4294967295],0);function fy(t){const e=KS().encode(t),r=new sw;return r.update(e),new Uint8Array(r.digest())}function my(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Fn([r,n],0),new Fn([s,i],0)]}class Bm{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Va(`Invalid padding: ${r}`);if(n<0)throw new Va(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Va(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Va(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Fn.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(Fn.fromNumber(n)));return s.compare(GS)===1&&(s=new Fn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=fy(e),[n,s]=my(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);if(!this.we(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Bm(i,s,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=fy(e),[n,s]=my(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,s,i);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Va extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Bo.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Lu(Z.min(),s,new je(ie),an(),ae())}}class Bo{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Bo(n,r,ae(),ae(),ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class Hw{constructor(e,r){this.targetId=e,this.Ce=r}}class Ww{constructor(e,r,n=st.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class py{constructor(){this.ve=0,this.Fe=gy(),this.Me=st.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ae(),r=ae(),n=ae();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:J(38017,{changeType:i})}}),new Bo(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=gy()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,fe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class QS{constructor(e){this.Ge=e,this.ze=new Map,this.je=an(),this.Je=Fl(),this.He=Fl(),this.Ye=new je(ie)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:J(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,s)=>{this.rt(s)&&r(s)})}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const i=s.target;if(cf(i))if(n===0){const a=new G(i.path);this.et(r,a,ht.newNoDocument(a,Z.min()))}else fe(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(r);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,c;try{a=Wn(n).toUint8Array()}catch(u){if(u instanceof gw)return Li("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Bm(a,s,i)}catch(u){return Li(u instanceof Va?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(r,i,null),s++)}),s}Tt(e){const r=new Map;this.ze.forEach((i,a)=>{const c=this.ot(a);if(c){if(i.current&&cf(c.target)){const u=new G(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,ht.newNoDocument(u,e))}i.Be&&(r.set(a,i.ke()),i.qe())}});let n=ae();this.He.forEach((i,a)=>{let c=!0;a.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const s=new Lu(e,r,this.Ye,this.je,n);return this.je=an(),this.Je=Fl(),this.He=Fl(),this.Ye=new je(ie),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new py,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Ke(ie),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Ke(ie),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||W("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new py),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Fl(){return new je(G.comparator)}function gy(){return new je(G.comparator)}const YS={asc:"ASCENDING",desc:"DESCENDING"},XS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JS={and:"AND",or:"OR"};class ZS{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function hf(t,e){return t.useProto3Json||Cu(e)?e:{value:e}}function Xc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function eA(t,e){return Xc(t,e.toTimestamp())}function Rr(t){return fe(!!t,49232),Z.fromTimestamp(function(r){const n=Hn(r);return new ge(n.seconds,n.nanos)}(t))}function $m(t,e){return ff(t,e).canonicalString()}function ff(t,e){const r=function(s){return new xe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Gw(t){const e=xe.fromString(t);return fe(Zw(e),10190,{key:e.toString()}),e}function mf(t,e){return $m(t.databaseId,e.path)}function Qd(t,e){const r=Gw(e);if(r.get(1)!==t.databaseId.projectId)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new G(Yw(r))}function Qw(t,e){return $m(t.databaseId,e)}function tA(t){const e=Gw(t);return e.length===4?xe.emptyPath():Yw(e)}function pf(t){return new xe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Yw(t){return fe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function yy(t,e,r){return{name:mf(t,e),fields:r.value.mapValue.fields}}function rA(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:J(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(fe(f===void 0||typeof f=="string",58123),st.fromBase64String(f||"")):(fe(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),st.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){const f=d.code===void 0?V.UNKNOWN:qw(d.code);return new H(f,d.message||"")}(a);r=new Ww(n,s,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Qd(t,n.document.name),i=Rr(n.document.updateTime),a=n.document.createTime?Rr(n.document.createTime):Z.min(),c=new Et({mapValue:{fields:n.document.fields}}),u=ht.newFoundDocument(s,i,a,c),d=n.targetIds||[],f=n.removedTargetIds||[];r=new uc(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Qd(t,n.document),i=n.readTime?Rr(n.readTime):Z.min(),a=ht.newNoDocument(s,i),c=n.removedTargetIds||[];r=new uc([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Qd(t,n.document),i=n.removedTargetIds||[];r=new uc([],i,s,null)}else{if(!("filter"in e))return J(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new HS(s,i),c=n.targetId;r=new Hw(c,a)}}return r}function nA(t,e){let r;if(e instanceof zo)r={update:yy(t,e.key,e.value)};else if(e instanceof Mu)r={delete:mf(t,e.key)};else if(e instanceof ts)r={update:yy(t,e.key,e.data),updateMask:hA(e.fieldMask)};else{if(!(e instanceof BS))return J(16599,{Vt:e.type});r={verify:mf(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const c=a.transform;if(c instanceof bo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Eo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof To)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Yc)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw J(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:eA(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:J(27497)}(t,e.precondition)),r}function sA(t,e){return t&&t.length>0?(fe(e!==void 0,14353),t.map(r=>function(s,i){let a=s.updateTime?Rr(s.updateTime):Rr(i);return a.isEqual(Z.min())&&(a=Rr(i)),new FS(a,s.transformResults||[])}(r,e))):[]}function iA(t,e){return{documents:[Qw(t,e.path)]}}function aA(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Qw(t,s);const i=function(d){if(d.length!==0)return Jw(yr.create(d,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(d){if(d.length!==0)return d.map(f=>function(p){return{field:ii(p.field),direction:cA(p.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=hf(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:r,parent:s}}function oA(t){let e=tA(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){fe(n===1,65062);const f=r.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];r.where&&(i=function(g){const p=Xw(g);return p instanceof yr&&Nw(p)?p.getFilters():[p]}(r.where));let a=[];r.orderBy&&(a=function(g){return g.map(p=>function(A){return new Qc(ai(A.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(p))}(r.orderBy));let c=null;r.limit&&(c=function(g){let p;return p=typeof g=="object"?g.value:g,Cu(p)?null:p}(r.limit));let u=null;r.startAt&&(u=function(g){const p=!!g.before,_=g.values||[];return new Gc(_,p)}(r.startAt));let d=null;return r.endAt&&(d=function(g){const p=!g.before,_=g.values||[];return new Gc(_,p)}(r.endAt)),TS(e,s,a,i,c,"F",u,d)}function lA(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Xw(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ai(r.unaryFilter.field);return Be.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=ai(r.unaryFilter.field);return Be.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ai(r.unaryFilter.field);return Be.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ai(r.unaryFilter.field);return Be.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J(61313);default:return J(60726)}}(t):t.fieldFilter!==void 0?function(r){return Be.create(ai(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J(58110);default:return J(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return yr.create(r.compositeFilter.filters.map(n=>Xw(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return J(1026)}}(r.compositeFilter.op))}(t):J(30097,{filter:t})}function cA(t){return YS[t]}function uA(t){return XS[t]}function dA(t){return JS[t]}function ii(t){return{fieldPath:t.canonicalString()}}function ai(t){return tt.fromServerFormat(t.fieldPath)}function Jw(t){return t instanceof Be?function(r){if(r.op==="=="){if(sy(r.value))return{unaryFilter:{field:ii(r.field),op:"IS_NAN"}};if(ny(r.value))return{unaryFilter:{field:ii(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(sy(r.value))return{unaryFilter:{field:ii(r.field),op:"IS_NOT_NAN"}};if(ny(r.value))return{unaryFilter:{field:ii(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ii(r.field),op:uA(r.op),value:r.value}}}(t):t instanceof yr?function(r){const n=r.getFilters().map(s=>Jw(s));return n.length===1?n[0]:{compositeFilter:{op:dA(r.op),filters:n}}}(t):J(54877,{filter:t})}function hA(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Zw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e,r,n,s,i=Z.min(),a=Z.min(),c=st.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Sn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Sn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Sn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Sn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e){this.yt=e}}function mA(t){const e=oA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?df(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(){this.Cn=new gA}addToCollectionParentIndex(e,r){return this.Cn.add(r),M.resolve()}getCollectionParents(e,r){return M.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return M.resolve()}deleteFieldIndex(e,r){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,r){return M.resolve()}getDocumentsMatchingTarget(e,r){return M.resolve(null)}getIndexType(e,r){return M.resolve(0)}getFieldIndexes(e,r){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,r){return M.resolve(qn.min())}getMinOffsetFromCollectionGroup(e,r){return M.resolve(qn.min())}updateCollectionGroup(e,r,n){return M.resolve()}updateIndexEntries(e,r){return M.resolve()}}class gA{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Ke(xe.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Ke(xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},e1=41943040;class kt{static withCacheSize(e){return new kt(e,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kt.DEFAULT_COLLECTION_PERCENTILE=10,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kt.DEFAULT=new kt(e1,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kt.DISABLED=new kt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Bi(0)}static cr(){return new Bi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy="LruGarbageCollector",yA=1048576;function _y([t,e],[r,n]){const s=ie(t,r);return s===0?ie(e,n):s}class xA{constructor(e){this.Ir=e,this.buffer=new Ke(_y),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();_y(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class vA{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){W(vy,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Yi(r)?W(vy,"Ignoring IndexedDB error during garbage collection: ",r):await Qi(r)}await this.Vr(3e5)})}}class _A{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return M.resolve(Au.ce);const n=new xA(r);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(W("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(xy)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xy):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,i,a,c,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),s=this.params.maximumSequenceNumbersToCollect):s=g,a=Date.now(),this.nthSequenceNumber(e,s))).next(g=>(n=g,c=Date.now(),this.removeTargets(e,n,r))).next(g=>(i=g,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(g=>(d=Date.now(),ni()<=se.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:g})))}}function wA(t,e){return new _A(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(){this.changes=new Bs(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,ht.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?M.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Ja(n.mutation,s,Vt.empty(),ge.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,ae()).next(()=>n))}getLocalViewOfDocuments(e,r,n=ae()){const s=xs();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=Oa();return i.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=xs();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,ae()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,s){let i=an();const a=Xa(),c=function(){return Xa()}();return r.forEach((u,d)=>{const f=n.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof ts)?i=i.insert(d.key,d):f!==void 0?(a.set(d.key,f.mutation.getFieldMask()),Ja(f.mutation,d,f.mutation.getFieldMask(),ge.now())):a.set(d.key,Vt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>a.set(d,f)),r.forEach((d,f)=>c.set(d,new bA(f,a.get(d)??null))),c))}recalculateAndSaveOverlays(e,r){const n=Xa();let s=new je((a,c)=>a-c),i=ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(u=>{const d=r.get(u);if(d===null)return;let f=n.get(u)||Vt.empty();f=c.applyToLocalView(d,f),n.set(u,f);const g=(s.get(c.batchId)||ae()).add(u);s=s.insert(c.batchId,g)})}).next(()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,f=u.value,g=Vw();f.forEach(p=>{if(!i.has(p)){const _=Bw(r.get(p),n.get(p));_!==null&&g.set(p,_),i=i.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,g))}return M.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return G.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Rw(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):M.resolve(xs());let c=vo,u=i;return a.next(d=>M.forEach(d,(f,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(f)?M.resolve():this.remoteDocumentCache.getEntry(e,f).next(p=>{u=u.insert(f,p)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,ae())).next(f=>({batchId:c,changes:Ow(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new G(r)).next(n=>{let s=Oa();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=Oa();return this.indexManager.getCollectionParents(e,i).next(c=>M.forEach(c,u=>{const d=function(g,p){return new Uo(p,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(r,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,n,s).next(f=>{f.forEach((g,p)=>{a=a.insert(g,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((u,d)=>{const f=d.getKey();a.get(f)===null&&(a=a.insert(f,ht.newInvalidDocument(f)))});let c=Oa();return a.forEach((u,d)=>{const f=i.get(u);f!==void 0&&Ja(f.mutation,d,Vt.empty(),ge.now()),Du(r,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return M.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Rr(s.createTime)}}(r)),M.resolve()}getNamedQuery(e,r){return M.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(s){return{name:s.name,query:mA(s.bundledQuery),readTime:Rr(s.readTime)}}(r)),M.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(){this.overlays=new je(G.comparator),this.qr=new Map}getOverlay(e,r){return M.resolve(this.overlays.get(r))}getOverlays(e,r){const n=xs();return M.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.St(e,r,i)}),M.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),M.resolve()}getOverlaysForCollection(e,r,n){const s=xs(),i=r.length+1,a=new G(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>n&&s.set(u.getKey(),u)}return M.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new je((d,f)=>d-f);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let f=i.get(d.largestBatchId);f===null&&(f=xs(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const c=xs(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=s)););return M.resolve(c)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new qS(r,n));let i=this.qr.get(r);i===void 0&&(i=ae(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(){this.sessionToken=st.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,M.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(){this.Qr=new Ke(Ge.$r),this.Ur=new Ke(Ge.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Ge(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Ge(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new G(new xe([])),n=new Ge(r,e),s=new Ge(r,e+1),i=[];return this.Ur.forEachInRange([n,s],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new G(new xe([])),n=new Ge(r,e),s=new Ge(r,e+1);let i=ae();return this.Ur.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new Ge(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Ge{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return G.comparator(e.key,r.key)||ie(e.Yr,r.Yr)}static Kr(e,r){return ie(e.Yr,r.Yr)||G.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Ke(Ge.$r)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new $S(i,r,n,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new Ge(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return M.resolve(a)}lookupMutationBatch(e,r){return M.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),i=s<0?0:s;return M.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?Om:this.tr-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Ge(r,0),s=new Ge(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],a=>{const c=this.Xr(a.Yr);i.push(c)}),M.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Ke(ie);return r.forEach(s=>{const i=new Ge(s,0),a=new Ge(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],c=>{n=n.add(c.Yr)})}),M.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;G.isDocumentKey(i)||(i=i.child(""));const a=new Ge(new G(i),0);let c=new Ke(ie);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!n.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.Yr)),!0)},a),M.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){fe(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return M.forEach(r.mutations,s=>{const i=new Ge(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Ge(r,0),s=this.Zr.firstAfterOrEqual(n);return M.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e){this.ri=e,this.docs=function(){return new je(G.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return M.resolve(n?n.document.mutableCopy():ht.newInvalidDocument(r))}getEntries(e,r){let n=an();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():ht.newInvalidDocument(s))}),M.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=an();const a=r.path,c=new G(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||sS(nS(f),n)<=0||(s.has(f.key)||Du(r,f))&&(i=i.insert(f.key,f.mutableCopy()))}return M.resolve(i)}getAllFromCollectionGroup(e,r,n,s){J(9500)}ii(e,r){return M.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new CA(this)}getSize(e){return M.resolve(this.size)}}class CA extends kA{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),M.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e){this.persistence=e,this.si=new Bs(r=>Lm(r),Fm),this.lastRemoteSnapshotVersion=Z.min(),this.highestTargetId=0,this.oi=0,this._i=new qm,this.targetCount=0,this.ai=Bi.ur()}forEachTarget(e,r){return this.si.forEach((n,s)=>r(s)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),M.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Bi(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,M.resolve()}updateTargetData(e,r){return this.Pr(r),M.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),M.waitFor(i).next(()=>s)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return M.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),M.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),M.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),M.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return M.resolve(n)}containsKey(e,r){return M.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e,r){this.ui={},this.overlays={},this.ci=new Au(0),this.li=!1,this.li=!0,this.hi=new NA,this.referenceDelegate=e(this),this.Pi=new RA(this),this.indexManager=new pA,this.remoteDocumentCache=function(s){return new AA(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new fA(r),this.Ii=new TA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new IA,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new SA(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){W("MemoryPersistence","Starting transaction:",e);const s=new PA(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,r){return M.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class PA extends aS{constructor(e){super(),this.currentSequenceNumber=e}}class Hm{constructor(e){this.persistence=e,this.Ri=new qm,this.Vi=null}static mi(e){return new Hm(e)}get fi(){if(this.Vi)return this.Vi;throw J(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),M.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),M.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),M.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.fi,n=>{const s=G.fromPath(n);return this.gi(e,s).next(i=>{i||r.removeEntry(s,Z.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return M.or([()=>M.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Jc{constructor(e,r){this.persistence=e,this.pi=new Bs(n=>cS(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=wA(this,r)}static mi(e,r){return new Jc(e,r)}Ei(){}di(e){return M.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return M.forEach(this.pi,(n,s)=>this.br(e,n,s).next(i=>i?M.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,i.removeEntry(a,Z.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),M.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),M.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),M.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=oc(e.data.value)),r}br(e,r,n){return M.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return M.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=ae(),s=ae();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Wm(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return i2()?8:oS(mt())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ys(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new jA;return this.Ss(e,r,a).next(c=>{if(i.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>i.result)}bs(e,r,n,s){return n.documentReadCount<this.fs?(ni()<=se.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",si(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),M.resolve()):(ni()<=se.DEBUG&&W("QueryEngine","Query:",si(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(ni()<=se.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",si(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cr(r))):M.resolve())}ys(e,r){if(ly(r))return M.resolve(null);let n=Cr(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=df(r,null,"F"),n=Cr(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=ae(...i);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const d=this.Ds(r,c);return this.Cs(r,d,a,u.readTime)?this.ys(e,df(r,null,"F")):this.vs(e,d,r,u)}))})))}ws(e,r,n,s){return ly(r)||s.isEqual(Z.min())?M.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(r,i);return this.Cs(r,a,n,s)?M.resolve(null):(ni()<=se.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),si(r)),this.vs(e,a,r,rS(s,vo)).next(c=>c))})}Ds(e,r){let n=new Ke(jw(e));return r.forEach((s,i)=>{Du(e,i)&&(n=n.add(i))}),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,r,n){return ni()<=se.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",si(r)),this.ps.getDocumentsMatchingQuery(e,r,qn.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="LocalStore",OA=3e8;class VA{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new je(ie),this.xs=new Bs(i=>Lm(i),Fm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new EA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function MA(t,e,r,n){return new VA(t,e,r,n)}async function r1(t,e){const r=te(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],c=[];let u=ae();for(const d of s){a.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){c.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return r.localDocuments.getDocuments(n,u).next(d=>({Ls:d,removedBatchIds:a,addedBatchIds:c}))})})}function LA(t,e){const r=te(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,d,f){const g=d.batch,p=g.keys();let _=M.resolve();return p.forEach(A=>{_=_.next(()=>f.getEntry(u,A)).next(P=>{const S=d.docVersions.get(A);fe(S!==null,48541),P.version.compareTo(S)<0&&(g.applyToRemoteDocument(P,d),P.isValidDocument()&&(P.setReadTime(d.commitVersion),f.addEntry(P)))})}),_.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=ae();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function n1(t){const e=te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function FA(t,e){const r=te(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const c=[];e.targetChanges.forEach((f,g)=>{const p=s.get(g);if(!p)return;c.push(r.Pi.removeMatchingKeys(i,f.removedDocuments,g).next(()=>r.Pi.addMatchingKeys(i,f.addedDocuments,g)));let _=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?_=_.withResumeToken(st.EMPTY_BYTE_STRING,Z.min()).withLastLimboFreeSnapshotVersion(Z.min()):f.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(f.resumeToken,n)),s=s.insert(g,_),function(P,S,w){return P.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=OA?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(p,_,f)&&c.push(r.Pi.updateTargetData(i,_))});let u=an(),d=ae();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(UA(i,a,e.documentUpdates).next(f=>{u=f.ks,d=f.qs})),!n.isEqual(Z.min())){const f=r.Pi.getLastRemoteSnapshotVersion(i).next(g=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));c.push(f)}return M.waitFor(c).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(r.Ms=s,i))}function UA(t,e,r){let n=ae(),s=ae();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=an();return r.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(Z.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):W(Km,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{ks:a,qs:s}})}function zA(t,e){const r=te(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Om),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function BA(t,e){const r=te(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Pi.getTargetData(n,e).next(i=>i?(s=i,M.resolve(s)):r.Pi.allocateTargetId(n).next(a=>(s=new Sn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function gf(t,e,r){const n=te(t),s=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Yi(a))throw a;W(Km,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function wy(t,e,r){const n=te(t);let s=Z.min(),i=ae();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,f){const g=te(u),p=g.xs.get(f);return p!==void 0?M.resolve(g.Ms.get(p)):g.Pi.getTargetData(d,f)}(n,a,Cr(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{i=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?s:Z.min(),r?i:ae())).next(c=>($A(n,NS(e),c),{documents:c,Qs:i})))}function $A(t,e,r){let n=t.Os.get(e)||Z.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.Os.set(e,n)}class ky{constructor(){this.activeTargetIds=jS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qA{constructor(){this.Mo=new ky,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new ky,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by="ConnectivityMonitor";class Ey{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){W(by,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){W(by,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ul=null;function yf(){return Ul===null?Ul=function(){return 268435456+Math.round(2147483648*Math.random())}():Ul++,"0x"+Ul.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="RestConnection",WA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class KA{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Wc?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,i){const a=yf(),c=this.zo(e,r.toUriEncodedString());W(Yd,`Sending RPC '${e}' ${a}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:d}=new URL(c),f=Us(d);return this.Jo(e,c,u,n,f).then(g=>(W(Yd,`Received RPC '${e}' ${a}: `,g),g),g=>{throw Li(Yd,`RPC '${e}' ${a} failed with error: `,g,"url: ",c,"request:",n),g})}Ho(e,r,n,s,i,a){return this.Go(e,r,n,s,i)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Gi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,i)=>e[i]=s),n&&n.headers.forEach((s,i)=>e[i]=s)}zo(e,r){const n=WA[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct="WebChannelConnection";class QA extends KA{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,i){const a=yf();return new Promise((c,u)=>{const d=new iw;d.setWithCredentials(!0),d.listenOnce(aw.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case ac.NO_ERROR:const g=d.getResponseJson();W(ct,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),c(g);break;case ac.TIMEOUT:W(ct,`RPC '${e}' ${a} timed out`),u(new H(V.DEADLINE_EXCEEDED,"Request time out"));break;case ac.HTTP_ERROR:const p=d.getStatus();if(W(ct,`RPC '${e}' ${a} failed with status:`,p,"response text:",d.getResponseText()),p>0){let _=d.getResponseJson();Array.isArray(_)&&(_=_[0]);const A=_==null?void 0:_.error;if(A&&A.status&&A.message){const P=function(w){const k=w.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(k)>=0?k:V.UNKNOWN}(A.status);u(new H(P,A.message))}else u(new H(V.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new H(V.UNAVAILABLE,"Connection failed."));break;default:J(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{W(ct,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(s);W(ct,`RPC '${e}' ${a} sending request:`,s),d.send(r,"POST",f,n,15)})}T_(e,r,n){const s=yf(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=cw(),c=lw(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const f=i.join("");W(ct,`Creating RPC '${e}' stream ${s}: ${f}`,u);const g=a.createWebChannel(f,u);this.I_(g);let p=!1,_=!1;const A=new GA({Yo:S=>{_?W(ct,`Not sending because RPC '${e}' stream ${s} is closed:`,S):(p||(W(ct,`Opening RPC '${e}' stream ${s} transport.`),g.open(),p=!0),W(ct,`RPC '${e}' stream ${s} sending:`,S),g.send(S))},Zo:()=>g.close()}),P=(S,w,k)=>{S.listen(w,I=>{try{k(I)}catch(N){setTimeout(()=>{throw N},0)}})};return P(g,Da.EventType.OPEN,()=>{_||(W(ct,`RPC '${e}' stream ${s} transport opened.`),A.o_())}),P(g,Da.EventType.CLOSE,()=>{_||(_=!0,W(ct,`RPC '${e}' stream ${s} transport closed`),A.a_(),this.E_(g))}),P(g,Da.EventType.ERROR,S=>{_||(_=!0,Li(ct,`RPC '${e}' stream ${s} transport errored. Name:`,S.name,"Message:",S.message),A.a_(new H(V.UNAVAILABLE,"The operation could not be completed")))}),P(g,Da.EventType.MESSAGE,S=>{var w;if(!_){const k=S.data[0];fe(!!k,16349);const I=k,N=(I==null?void 0:I.error)||((w=I[0])==null?void 0:w.error);if(N){W(ct,`RPC '${e}' stream ${s} received error:`,N);const O=N.status;let F=function(E){const T=Ue[E];if(T!==void 0)return qw(T)}(O),x=N.message;F===void 0&&(F=V.INTERNAL,x="Unknown error status: "+O+" with message "+N.message),_=!0,A.a_(new H(F,x)),g.close()}else W(ct,`RPC '${e}' stream ${s} received:`,k),A.u_(k)}}),P(c,ow.STAT_EVENT,S=>{S.stat===nf.PROXY?W(ct,`RPC '${e}' stream ${s} detected buffering proxy`):S.stat===nf.NOPROXY&&W(ct,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.__()},0),A}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Xd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fu(t){return new ZS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&W("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ty="PersistentStream";class i1{constructor(e,r,n,s,i,a,c,u){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new s1(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===V.RESOURCE_EXHAUSTED?(sn(r.toString()),sn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===r&&this.G_(n,s)},n=>{e(()=>{const s=new H(V.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return W(Ty,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(W(Ty,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class YA extends i1{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=rA(this.serializer,e),n=function(i){if(!("targetChange"in i))return Z.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Z.min():a.readTime?Rr(a.readTime):Z.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=pf(this.serializer),r.addTarget=function(i,a){let c;const u=a.target;if(c=cf(u)?{documents:iA(i,u)}:{query:aA(i,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Kw(i,a.resumeToken);const d=hf(i,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(Z.min())>0){c.readTime=Xc(i,a.snapshotVersion.toTimestamp());const d=hf(i,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const n=lA(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=pf(this.serializer),r.removeTarget=e,this.q_(r)}}class XA extends i1{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return fe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,fe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){fe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=sA(e.writeResults,e.commitTime),n=Rr(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=pf(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>nA(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{}class ZA extends JA{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,ff(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new H(V.UNKNOWN,i.toString())})}Ho(e,r,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,ff(r,n),s,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new H(V.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class eC{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(sn(r),this.aa=!1):W("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds="RemoteStore";class tC{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{$s(this)&&(W(Ds,"Restarting streams for network reachability change."),await async function(u){const d=te(u);d.Ea.add(4),await $o(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Uu(d)}(this))})}),this.Ra=new eC(n,s)}}async function Uu(t){if($s(t))for(const e of t.da)await e(!0)}async function $o(t){for(const e of t.da)await e(!1)}function a1(t,e){const r=te(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Xm(r)?Ym(r):Xi(r).O_()&&Qm(r,e))}function Gm(t,e){const r=te(t),n=Xi(r);r.Ia.delete(e),n.O_()&&o1(r,e),r.Ia.size===0&&(n.O_()?n.L_():$s(r)&&r.Ra.set("Unknown"))}function Qm(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Z.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Xi(t).Y_(e)}function o1(t,e){t.Va.Ue(e),Xi(t).Z_(e)}function Ym(t){t.Va=new QS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Xi(t).start(),t.Ra.ua()}function Xm(t){return $s(t)&&!Xi(t).x_()&&t.Ia.size>0}function $s(t){return te(t).Ea.size===0}function l1(t){t.Va=void 0}async function rC(t){t.Ra.set("Online")}async function nC(t){t.Ia.forEach((e,r)=>{Qm(t,e)})}async function sC(t,e){l1(t),Xm(t)?(t.Ra.ha(e),Ym(t)):t.Ra.set("Unknown")}async function iC(t,e,r){if(t.Ra.set("Online"),e instanceof Ww&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))}(t,e)}catch(n){W(Ds,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Zc(t,n)}else if(e instanceof uc?t.Va.Ze(e):e instanceof Hw?t.Va.st(e):t.Va.tt(e),!r.isEqual(Z.min()))try{const n=await n1(t.localStore);r.compareTo(n)>=0&&await function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.Ia.get(d);f&&i.Ia.set(d,f.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,d)=>{const f=i.Ia.get(u);if(!f)return;i.Ia.set(u,f.withResumeToken(st.EMPTY_BYTE_STRING,f.snapshotVersion)),o1(i,u);const g=new Sn(f.target,u,d,f.sequenceNumber);Qm(i,g)}),i.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){W(Ds,"Failed to raise snapshot:",n),await Zc(t,n)}}async function Zc(t,e,r){if(!Yi(e))throw e;t.Ea.add(1),await $o(t),t.Ra.set("Offline"),r||(r=()=>n1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{W(Ds,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Uu(t)})}function c1(t,e){return e().catch(r=>Zc(t,r,e))}async function zu(t){const e=te(t),r=Gn(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Om;for(;aC(e);)try{const s=await zA(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,oC(e,s)}catch(s){await Zc(e,s)}u1(e)&&d1(e)}function aC(t){return $s(t)&&t.Ta.length<10}function oC(t,e){t.Ta.push(e);const r=Gn(t);r.O_()&&r.X_&&r.ea(e.mutations)}function u1(t){return $s(t)&&!Gn(t).x_()&&t.Ta.length>0}function d1(t){Gn(t).start()}async function lC(t){Gn(t).ra()}async function cC(t){const e=Gn(t);for(const r of t.Ta)e.ea(r.mutations)}async function uC(t,e,r){const n=t.Ta.shift(),s=zm.from(n,e,r);await c1(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await zu(t)}async function dC(t,e){e&&Gn(t).X_&&await async function(n,s){if(function(a){return WS(a)&&a!==V.ABORTED}(s.code)){const i=n.Ta.shift();Gn(n).B_(),await c1(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await zu(n)}}(t,e),u1(t)&&d1(t)}async function Iy(t,e){const r=te(t);r.asyncQueue.verifyOperationInProgress(),W(Ds,"RemoteStore received new credentials");const n=$s(r);r.Ea.add(3),await $o(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Uu(r)}async function hC(t,e){const r=te(t);e?(r.Ea.delete(2),await Uu(r)):e||(r.Ea.add(2),await $o(r),r.Ra.set("Unknown"))}function Xi(t){return t.ma||(t.ma=function(r,n,s){const i=te(r);return i.sa(),new YA(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:rC.bind(null,t),t_:nC.bind(null,t),r_:sC.bind(null,t),H_:iC.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Xm(t)?Ym(t):t.Ra.set("Unknown")):(await t.ma.stop(),l1(t))})),t.ma}function Gn(t){return t.fa||(t.fa=function(r,n,s){const i=te(r);return i.sa(),new XA(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:lC.bind(null,t),r_:dC.bind(null,t),ta:cC.bind(null,t),na:uC.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await zu(t)):(await t.fa.stop(),t.Ta.length>0&&(W(Ds,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Xr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,c=new Jm(e,r,a,s,i);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Zm(t,e){if(sn("AsyncQueue",`${e}: ${t}`),Yi(t))return new H(V.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{static emptySet(e){return new Ai(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||G.comparator(r.key,n.key):(r,n)=>G.comparator(r.key,n.key),this.keyedMap=Oa(),this.sortedSet=new je(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Ai)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Ai;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(){this.ga=new je(G.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):J(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class $i{constructor(e,r,n,s,i,a,c,u,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new $i(e,r,Ai.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ju(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class mC{constructor(){this.queries=Sy(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=te(r),i=s.queries;s.queries=Sy(),i.forEach((a,c)=>{for(const u of c.Sa)u.onError(n)})})(this,new H(V.ABORTED,"Firestore shutting down"))}}function Sy(){return new Bs(t=>Pw(t),ju)}async function ep(t,e){const r=te(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new fC,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(s,!0);break;case 1:i.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const c=Zm(a,`Initialization of query '${si(e.query)}' failed`);return void e.onError(c)}r.queries.set(s,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&rp(r)}async function tp(t,e){const r=te(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function pC(t,e){const r=te(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(n=!0);a.wa=s}}n&&rp(r)}function gC(t,e,r){const n=te(t),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(r);n.queries.delete(e)}function rp(t){t.Ca.forEach(e=>{e.next()})}var xf,Ay;(Ay=xf||(xf={})).Ma="default",Ay.Cache="cache";class np{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new $i(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=$i.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==xf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.key=e}}class f1{constructor(e){this.key=e}}class yC{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ae(),this.mutatedKeys=ae(),this.eu=jw(e),this.tu=new Ai(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Ny,s=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,g)=>{const p=s.get(f),_=Du(this.query,g)?g:null,A=!!p&&this.mutatedKeys.has(p.key),P=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let S=!1;p&&_?p.data.isEqual(_.data)?A!==P&&(n.track({type:3,doc:_}),S=!0):this.su(p,_)||(n.track({type:2,doc:_}),S=!0,(u&&this.eu(_,u)>0||d&&this.eu(_,d)<0)&&(c=!0)):!p&&_?(n.track({type:0,doc:_}),S=!0):p&&!_&&(n.track({type:1,doc:p}),S=!0,(u||d)&&(c=!0)),S&&(_?(a=a.add(_),i=P?i.add(f):i.delete(f)):(a=a.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),i=i.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:c,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,g)=>function(_,A){const P=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J(20277,{Rt:S})}};return P(_)-P(A)}(f.type,g.type)||this.eu(f.doc,g.doc)),this.ou(n),s=s??!1;const c=r&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,d=u!==this.Za;return this.Za=u,a.length!==0||d?{snapshot:new $i(this.query,e.tu,i,a,e.mutatedKeys,u===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ny,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ae(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new f1(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new h1(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=ae();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return $i.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const sp="SyncEngine";class xC{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class vC{constructor(e){this.key=e,this.hu=!1}}class _C{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Bs(c=>Pw(c),ju),this.Iu=new Map,this.Eu=new Set,this.du=new je(G.comparator),this.Au=new Map,this.Ru=new qm,this.Vu={},this.mu=new Map,this.fu=Bi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function wC(t,e,r=!0){const n=v1(t);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await m1(n,e,r,!0),s}async function kC(t,e){const r=v1(t);await m1(r,e,!0,!1)}async function m1(t,e,r,n){const s=await BA(t.localStore,Cr(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let c;return n&&(c=await bC(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&a1(t.remoteStore,s),c}async function bC(t,e,r,n,s){t.pu=(g,p,_)=>async function(P,S,w,k){let I=S.view.ru(w);I.Cs&&(I=await wy(P.localStore,S.query,!1).then(({documents:x})=>S.view.ru(x,I)));const N=k&&k.targetChanges.get(S.targetId),O=k&&k.targetMismatches.get(S.targetId)!=null,F=S.view.applyChanges(I,P.isPrimaryClient,N,O);return Ry(P,S.targetId,F.au),F.snapshot}(t,g,p,_);const i=await wy(t.localStore,e,!0),a=new yC(e,i.Qs),c=a.ru(i.documents),u=Bo.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),d=a.applyChanges(c,t.isPrimaryClient,u);Ry(t,r,d.au);const f=new xC(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function EC(t,e,r){const n=te(t),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter(a=>!ju(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await gf(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Gm(n.remoteStore,s.targetId),vf(n,s.targetId)}).catch(Qi)):(vf(n,s.targetId),await gf(n.localStore,s.targetId,!0))}async function TC(t,e){const r=te(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Gm(r.remoteStore,n.targetId))}async function IC(t,e,r){const n=jC(t);try{const s=await function(a,c){const u=te(a),d=ge.now(),f=c.reduce((_,A)=>_.add(A.key),ae());let g,p;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let A=an(),P=ae();return u.Ns.getEntries(_,f).next(S=>{A=S,A.forEach((w,k)=>{k.isValidDocument()||(P=P.add(w))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,A)).next(S=>{g=S;const w=[];for(const k of c){const I=zS(k,g.get(k.key).overlayedDocument);I!=null&&w.push(new ts(k.key,I,Ew(I.value.mapValue),Ct.exists(!0)))}return u.mutationQueue.addMutationBatch(_,d,w,c)}).next(S=>{p=S;const w=S.applyToLocalDocumentSet(g,P);return u.documentOverlayCache.saveOverlays(_,S.batchId,w)})}).then(()=>({batchId:p.batchId,changes:Ow(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,c,u){let d=a.Vu[a.currentUser.toKey()];d||(d=new je(ie)),d=d.insert(c,u),a.Vu[a.currentUser.toKey()]=d}(n,s.batchId,r),await qo(n,s.changes),await zu(n.remoteStore)}catch(s){const i=Zm(s,"Failed to persist write");r.reject(i)}}async function p1(t,e){const r=te(t);try{const n=await FA(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Au.get(i);a&&(fe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?fe(a.hu,14607):s.removedDocuments.size>0&&(fe(a.hu,42227),a.hu=!1))}),await qo(r,n,e)}catch(n){await Qi(n)}}function Cy(t,e,r){const n=te(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(a,c){const u=te(a);u.onlineState=c;let d=!1;u.queries.forEach((f,g)=>{for(const p of g.Sa)p.va(c)&&(d=!0)}),d&&rp(u)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function NC(t,e,r){const n=te(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),i=s&&s.key;if(i){let a=new je(G.comparator);a=a.insert(i,ht.newNoDocument(i,Z.min()));const c=ae().add(i),u=new Lu(Z.min(),new Map,new je(ie),a,c);await p1(n,u),n.du=n.du.remove(i),n.Au.delete(e),ip(n)}else await gf(n.localStore,e,!1).then(()=>vf(n,e,r)).catch(Qi)}async function SC(t,e){const r=te(t),n=e.batch.batchId;try{const s=await LA(r.localStore,e);y1(r,n,null),g1(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await qo(r,s)}catch(s){await Qi(s)}}async function AC(t,e,r){const n=te(t);try{const s=await function(a,c){const u=te(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,c).next(g=>(fe(g!==null,37113),f=g.keys(),u.mutationQueue.removeMutationBatch(d,g))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(n.localStore,e);y1(n,e,r),g1(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await qo(n,s)}catch(s){await Qi(s)}}function g1(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function y1(t,e,r){const n=te(t);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function vf(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||x1(t,n)})}function x1(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Gm(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),ip(t))}function Ry(t,e,r){for(const n of r)n instanceof h1?(t.Ru.addReference(n.key,e),CC(t,n)):n instanceof f1?(W(sp,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||x1(t,n.key)):J(19791,{wu:n})}function CC(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(W(sp,"New document in limbo: "+r),t.Eu.add(n),ip(t))}function ip(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new G(xe.fromString(e)),n=t.fu.next();t.Au.set(n,new vC(r)),t.du=t.du.insert(r,n),a1(t.remoteStore,new Sn(Cr(Pu(r.path)),n,"TargetPurposeLimboResolution",Au.ce))}}async function qo(t,e,r){const n=te(t),s=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{a.push(n.pu(u,e,r).then(d=>{var f;if((d||r)&&n.isPrimaryClient){const g=d?!d.fromCache:(f=r==null?void 0:r.targetChanges.get(u.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(d){s.push(d);const g=Wm.As(u.targetId,d);i.push(g)}}))}),await Promise.all(a),n.Pu.H_(s),await async function(u,d){const f=te(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>M.forEach(d,p=>M.forEach(p.Es,_=>f.persistence.referenceDelegate.addReference(g,p.targetId,_)).next(()=>M.forEach(p.ds,_=>f.persistence.referenceDelegate.removeReference(g,p.targetId,_)))))}catch(g){if(!Yi(g))throw g;W(Km,"Failed to update sequence numbers: "+g)}for(const g of d){const p=g.targetId;if(!g.fromCache){const _=f.Ms.get(p),A=_.snapshotVersion,P=_.withLastLimboFreeSnapshotVersion(A);f.Ms=f.Ms.insert(p,P)}}}(n.localStore,i))}async function RC(t,e){const r=te(t);if(!r.currentUser.isEqual(e)){W(sp,"User change. New user:",e.toKey());const n=await r1(r.localStore,e);r.currentUser=e,function(i,a){i.mu.forEach(c=>{c.forEach(u=>{u.reject(new H(V.CANCELLED,a))})}),i.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await qo(r,n.Ls)}}function PC(t,e){const r=te(t),n=r.Au.get(e);if(n&&n.hu)return ae().add(n.key);{let s=ae();const i=r.Iu.get(e);if(!i)return s;for(const a of i){const c=r.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function v1(t){const e=te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=p1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=PC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=NC.bind(null,e),e.Pu.H_=pC.bind(null,e.eventManager),e.Pu.yu=gC.bind(null,e.eventManager),e}function jC(t){const e=te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=AC.bind(null,e),e}class eu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Fu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return MA(this.persistence,new DA,e.initialUser,this.serializer)}Cu(e){return new t1(Hm.mi,this.serializer)}Du(e){return new qA}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}eu.provider={build:()=>new eu};class DC extends eu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){fe(this.persistence.referenceDelegate instanceof Jc,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new vA(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?kt.withCacheSize(this.cacheSizeBytes):kt.DEFAULT;return new t1(n=>Jc.mi(n,r),this.serializer)}}class _f{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Cy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=RC.bind(null,this.syncEngine),await hC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new mC}()}createDatastore(e){const r=Fu(e.databaseInfo.databaseId),n=function(i){return new QA(i)}(e.databaseInfo);return function(i,a,c,u){return new ZA(i,a,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,c){return new tC(n,s,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>Cy(this.syncEngine,r,0),function(){return Ey.v()?new Ey:new HA}())}createSyncEngine(e,r){return function(s,i,a,c,u,d,f){const g=new _C(s,i,a,c,u,d);return f&&(g.gu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=te(s);W(Ds,"RemoteStore shutting down."),i.Ea.add(5),await $o(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}_f.provider={build:()=>new _f};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):sn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn="FirestoreClient";class OC{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=ut.UNAUTHENTICATED,this.clientId=Dm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{W(Qn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(W(Qn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Zm(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Jd(t,e){t.asyncQueue.verifyOperationInProgress(),W(Qn,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await r1(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Py(t,e){t.asyncQueue.verifyOperationInProgress();const r=await VC(t);W(Qn,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Iy(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>Iy(e.remoteStore,s)),t._onlineComponents=e}async function VC(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){W(Qn,"Using user provided OfflineComponentProvider");try{await Jd(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Li("Error using user provided cache. Falling back to memory cache: "+r),await Jd(t,new eu)}}else W(Qn,"Using default OfflineComponentProvider"),await Jd(t,new DC(void 0));return t._offlineComponents}async function _1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(W(Qn,"Using user provided OnlineComponentProvider"),await Py(t,t._uninitializedComponentsProvider._online)):(W(Qn,"Using default OnlineComponentProvider"),await Py(t,new _f))),t._onlineComponents}function MC(t){return _1(t).then(e=>e.syncEngine)}async function tu(t){const e=await _1(t),r=e.eventManager;return r.onListen=wC.bind(null,e.syncEngine),r.onUnlisten=EC.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=kC.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=TC.bind(null,e.syncEngine),r}function LC(t,e,r={}){const n=new Xr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const f=new ap({next:p=>{f.Nu(),a.enqueueAndForget(()=>tp(i,g));const _=p.docs.has(c);!_&&p.fromCache?d.reject(new H(V.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&u&&u.source==="server"?d.reject(new H(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),g=new np(Pu(c.path),f,{includeMetadataChanges:!0,qa:!0});return ep(i,g)}(await tu(t),t.asyncQueue,e,r,n)),n.promise}function FC(t,e,r={}){const n=new Xr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,d){const f=new ap({next:p=>{f.Nu(),a.enqueueAndForget(()=>tp(i,g)),p.fromCache&&u.source==="server"?d.reject(new H(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),g=new np(c,f,{includeMetadataChanges:!0,qa:!0});return ep(i,g)}(await tu(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="firestore.googleapis.com",Dy=!0;class Oy{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new H(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=k1,this.ssl=Dy}else this.host=e.host,this.ssl=e.ssl??Dy;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=e1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yA)throw new H(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}tS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=w1(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bu{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Oy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Oy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new HN;switch(n.type){case"firstParty":return new QN(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new H(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=jy.get(r);n&&(W("ComponentProvider","Removing Datastore"),jy.delete(r),n.terminate())}(this),Promise.resolve()}}function UC(t,e,r,n={}){var d;t=Ft(t,Bu);const s=Us(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;s&&(_m(`https://${c}`),wm("Firestore",!0)),i.host!==k1&&i.host!==c&&Li("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:c,ssl:s,emulatorOptions:n};if(!As(u,a)&&(t._setSettings(u),n.mockUserToken)){let f,g;if(typeof n.mockUserToken=="string")f=n.mockUserToken,g=ut.MOCK_USER;else{f=x_(n.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new H(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new ut(p)}t._authCredentials=new WN(new dw(f,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new qs(this.firestore,e,this._query)}}class Le{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Un(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Le(this.firestore,e,this._key)}toJSON(){return{type:Le._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Fo(r,Le._jsonSchema))return new Le(e,n||null,new G(xe.fromString(r.referencePath)))}}Le._jsonSchemaVersion="firestore/documentReference/1.0",Le._jsonSchema={type:$e("string",Le._jsonSchemaVersion),referencePath:$e("string")};class Un extends qs{constructor(e,r,n){super(e,r,Pu(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Le(this.firestore,null,new G(e))}withConverter(e){return new Un(this.firestore,e,this._path)}}function Ie(t,e,...r){if(t=Pe(t),hw("collection","path",e),t instanceof Bu){const n=xe.fromString(e,...r);return G0(n),new Un(t,null,n)}{if(!(t instanceof Le||t instanceof Un))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(xe.fromString(e,...r));return G0(n),new Un(t.firestore,null,n)}}function He(t,e,...r){if(t=Pe(t),arguments.length===1&&(e=Dm.newId()),hw("doc","path",e),t instanceof Bu){const n=xe.fromString(e,...r);return K0(n),new Le(t,null,new G(n))}{if(!(t instanceof Le||t instanceof Un))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(xe.fromString(e,...r));return K0(n),new Le(t.firestore,t instanceof Un?t.converter:null,new G(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vy="AsyncQueue";class My{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new s1(this,"async_queue_retry"),this._c=()=>{const n=Xd();n&&W(Vy,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Xd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Xd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Xr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Yi(e))throw e;W(Vy,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,sn("INTERNAL UNHANDLED ERROR: ",Ly(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=Jm.createAndSchedule(this,e,r,n,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&J(47125,{Pc:Ly(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Ly(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fy(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class on extends Bu{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new My,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new My(e),this._firestoreClient=void 0,await e}}}function zC(t,e){const r=typeof t=="object"?t:Em(),n=typeof t=="string"?t:Wc,s=Eu(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=p_("firestore");i&&UC(s,...i)}return s}function Ho(t){if(t._terminated)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||BC(t),t._firestoreClient}function BC(t){var n,s,i;const e=t._freezeSettings(),r=function(c,u,d,f){return new hS(c,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,w1(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new OC(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gt(st.fromBase64String(e))}catch(r){throw new H(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Gt(st.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Fo(e,Gt._jsonSchema))return Gt.fromBase64String(e.bytes)}}Gt._jsonSchemaVersion="firestore/bytes/1.0",Gt._jsonSchema={type:$e("string",Gt._jsonSchemaVersion),bytes:$e("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new H(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new H(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new H(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ie(this._lat,e._lat)||ie(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pr._jsonSchemaVersion}}static fromJSON(e){if(Fo(e,Pr._jsonSchema))return new Pr(e.latitude,e.longitude)}}Pr._jsonSchemaVersion="firestore/geoPoint/1.0",Pr._jsonSchema={type:$e("string",Pr._jsonSchemaVersion),latitude:$e("number"),longitude:$e("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:jr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Fo(e,jr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new jr(e.vectorValues);throw new H(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}jr._jsonSchemaVersion="firestore/vectorValue/1.0",jr._jsonSchema={type:$e("string",jr._jsonSchemaVersion),vectorValues:$e("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=/^__.*__$/;class qC{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ts(e,this.data,this.fieldMask,r,this.fieldTransforms):new zo(e,this.data,r,this.fieldTransforms)}}class b1{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ts(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function E1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J(40011,{Ac:t})}}class op{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new op({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ru(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(E1(this.Ac)&&$C.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class HC{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Fu(e)}Cc(e,r,n,s=!1){return new op({Ac:e,methodName:r,Dc:n,path:tt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qu(t){const e=t._freezeSettings(),r=Fu(t._databaseId);return new HC(t._databaseId,!!e.ignoreUndefinedProperties,r)}function T1(t,e,r,n,s,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,r,s);cp("Data must be an object, but it was:",a,n);const c=S1(n,a);let u,d;if(i.merge)u=new Vt(a.fieldMask),d=a.fieldTransforms;else if(i.mergeFields){const f=[];for(const g of i.mergeFields){const p=wf(e,g,r);if(!a.contains(p))throw new H(V.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);C1(f,p)||f.push(p)}u=new Vt(f),d=a.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,d=a.fieldTransforms;return new qC(new Et(c),u,d)}class Hu extends $u{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hu}}class lp extends $u{_toFieldTransform(e){return new MS(e.path,new bo)}isEqual(e){return e instanceof lp}}function I1(t,e,r,n){const s=t.Cc(1,e,r);cp("Data must be an object, but it was:",s,n);const i=[],a=Et.empty();es(n,(u,d)=>{const f=up(e,u,r);d=Pe(d);const g=s.yc(f);if(d instanceof Hu)i.push(f);else{const p=Ko(d,g);p!=null&&(i.push(f),a.set(f,p))}});const c=new Vt(i);return new b1(a,c,s.fieldTransforms)}function N1(t,e,r,n,s,i){const a=t.Cc(1,e,r),c=[wf(e,n,r)],u=[s];if(i.length%2!=0)throw new H(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)c.push(wf(e,i[p])),u.push(i[p+1]);const d=[],f=Et.empty();for(let p=c.length-1;p>=0;--p)if(!C1(d,c[p])){const _=c[p];let A=u[p];A=Pe(A);const P=a.yc(_);if(A instanceof Hu)d.push(_);else{const S=Ko(A,P);S!=null&&(d.push(_),f.set(_,S))}}const g=new Vt(d);return new b1(f,g,a.fieldTransforms)}function WC(t,e,r,n=!1){return Ko(r,t.Cc(n?4:3,e))}function Ko(t,e){if(A1(t=Pe(t)))return cp("Unsupported field value:",e,t),S1(t,e);if(t instanceof $u)return function(n,s){if(!E1(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const c of n){let u=Ko(c,s.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=Pe(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return DS(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=ge.fromDate(n);return{timestampValue:Xc(s.serializer,i)}}if(n instanceof ge){const i=new ge(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Xc(s.serializer,i)}}if(n instanceof Pr)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Gt)return{bytesValue:Kw(s.serializer,n._byteString)};if(n instanceof Le){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:$m(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof jr)return function(a,c){return{mapValue:{fields:{[ww]:{stringValue:bw},[Kc]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Um(c.serializer,d)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${Su(n)}`)}(t,e)}function S1(t,e){const r={};return pw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):es(t,(n,s)=>{const i=Ko(s,e.mc(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function A1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ge||t instanceof Pr||t instanceof Gt||t instanceof Le||t instanceof $u||t instanceof jr)}function cp(t,e,r){if(!A1(r)||!fw(r)){const n=Su(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function wf(t,e,r){if((e=Pe(e))instanceof Wo)return e._internalPath;if(typeof e=="string")return up(t,e);throw ru("Field path arguments must be of type string or ",t,!1,void 0,r)}const KC=new RegExp("[~\\*/\\[\\]]");function up(t,e,r){if(e.search(KC)>=0)throw ru(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Wo(...e.split("."))._internalPath}catch{throw ru(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function ru(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${n}`),a&&(u+=` in document ${s}`),u+=")"),new H(V.INVALID_ARGUMENT,c+t+u)}function C1(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Le(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new GC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(dp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class GC extends R1{data(){return super.data()}}function dp(t,e){return typeof e=="string"?up(t,e):e instanceof Wo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new H(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hp{}class QC extends hp{}function er(t,e,...r){let n=[];e instanceof hp&&n.push(e),n=n.concat(r),function(i){const a=i.filter(u=>u instanceof fp).length,c=i.filter(u=>u instanceof Wu).length;if(a>1||a>0&&c>0)throw new H(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Wu extends QC{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Wu(e,r,n)}_apply(e){const r=this._parse(e);return j1(e._query,r),new qs(e.firestore,e.converter,uf(e._query,r))}_parse(e){const r=qu(e.firestore);return function(i,a,c,u,d,f,g){let p;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new H(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){zy(g,f);const A=[];for(const P of g)A.push(Uy(u,i,P));p={arrayValue:{values:A}}}else p=Uy(u,i,g)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||zy(g,f),p=WC(c,a,g,f==="in"||f==="not-in");return Be.create(d,f,p)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function tr(t,e,r){const n=e,s=dp("where",t);return Wu._create(s,n,r)}class fp extends hp{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new fp(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:yr.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const c=i.getFlattenedFilters();for(const u of c)j1(a,u),a=uf(a,u)}(e._query,r),new qs(e.firestore,e.converter,uf(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Uy(t,e,r){if(typeof(r=Pe(r))=="string"){if(r==="")throw new H(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rw(e)&&r.indexOf("/")!==-1)throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(xe.fromString(r));if(!G.isDocumentKey(n))throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ry(t,new G(n))}if(r instanceof Le)return ry(t,r._key);throw new H(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Su(r)}.`)}function zy(t,e){if(!Array.isArray(t)||t.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function j1(t,e){const r=function(s,i){for(const a of s)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new H(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new H(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class YC{convertValue(e,r="none"){switch(Kn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ve(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Wn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw J(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return es(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var n,s,i;const r=(i=(s=(n=e.fields)==null?void 0:n[Kc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(a=>Ve(a.doubleValue));return new jr(r)}convertGeoPoint(e){return new Pr(Ve(e.latitude),Ve(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Ru(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(_o(e));default:return null}}convertTimestamp(e){const r=Hn(e);return new ge(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=xe.fromString(e);fe(Zw(n),9688,{name:e});const s=new wo(n.get(1),n.get(3)),i=new G(n.popFirst(5));return s.isEqual(r)||sn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D1(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Ma{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ws extends R1{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new dc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(dp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=ws._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}ws._jsonSchemaVersion="firestore/documentSnapshot/1.0",ws._jsonSchema={type:$e("string",ws._jsonSchemaVersion),bundleSource:$e("string","DocumentSnapshot"),bundleName:$e("string"),bundle:$e("string")};class dc extends ws{data(e={}){return super.data(e)}}class ks{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Ma(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new dc(this._firestore,this._userDataWriter,n.key,n,new Ma(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new H(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(c=>{const u=new dc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ma(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new dc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ma(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:XC(c.type),doc:u,oldIndex:d,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ks._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Dm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function XC(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JC(t){t=Ft(t,Le);const e=Ft(t.firestore,on);return LC(Ho(e),t._key).then(r=>O1(e,t,r))}ks._jsonSchemaVersion="firestore/querySnapshot/1.0",ks._jsonSchema={type:$e("string",ks._jsonSchemaVersion),bundleSource:$e("string","QuerySnapshot"),bundleName:$e("string"),bundle:$e("string")};class mp extends YC{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gt(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,r)}}function Os(t){t=Ft(t,qs);const e=Ft(t.firestore,on),r=Ho(e),n=new mp(e);return P1(t._query),FC(r,t._query).then(s=>new ks(e,n,t,s))}function Ji(t,e,r,...n){t=Ft(t,Le);const s=Ft(t.firestore,on),i=qu(s);let a;return a=typeof(e=Pe(e))=="string"||e instanceof Wo?N1(i,"updateDoc",t._key,e,r,n):I1(i,"updateDoc",t._key,e),Ku(s,[a.toMutation(t._key,Ct.exists(!0))])}function Go(t){return Ku(Ft(t.firestore,on),[new Mu(t._key,Ct.none())])}function Zi(t,e){const r=Ft(t.firestore,on),n=He(t),s=D1(t.converter,e);return Ku(r,[T1(qu(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Ct.exists(!1))]).then(()=>n)}function Qo(t,...e){var u,d,f;t=Pe(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Fy(e[n])||(r=e[n++]);const s={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(Fy(e[n])){const g=e[n];e[n]=(u=g.next)==null?void 0:u.bind(g),e[n+1]=(d=g.error)==null?void 0:d.bind(g),e[n+2]=(f=g.complete)==null?void 0:f.bind(g)}let i,a,c;if(t instanceof Le)a=Ft(t.firestore,on),c=Pu(t._key.path),i={next:g=>{e[n]&&e[n](O1(a,t,g))},error:e[n+1],complete:e[n+2]};else{const g=Ft(t,qs);a=Ft(g.firestore,on),c=g._query;const p=new mp(a);i={next:_=>{e[n]&&e[n](new ks(a,p,g,_))},error:e[n+1],complete:e[n+2]},P1(t._query)}return function(p,_,A,P){const S=new ap(P),w=new np(_,S,A);return p.asyncQueue.enqueueAndForget(async()=>ep(await tu(p),w)),()=>{S.Nu(),p.asyncQueue.enqueueAndForget(async()=>tp(await tu(p),w))}}(Ho(a),c,s,i)}function Ku(t,e){return function(n,s){const i=new Xr;return n.asyncQueue.enqueueAndForget(async()=>IC(await MC(n),s,i)),i.promise}(Ho(t),e)}function O1(t,e,r){const n=r.docs.get(e._key),s=new mp(t);return new ws(t,s,e._key,n,new Ma(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=qu(e)}set(e,r,n){this._verifyNotCommitted();const s=Zd(e,this._firestore),i=D1(s.converter,r,n),a=T1(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(a.toMutation(s._key,Ct.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=Zd(e,this._firestore);let a;return a=typeof(r=Pe(r))=="string"||r instanceof Wo?N1(this._dataReader,"WriteBatch.update",i._key,r,n,s):I1(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(a.toMutation(i._key,Ct.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Zd(e,this._firestore);return this._mutations=this._mutations.concat(new Mu(r._key,Ct.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new H(V.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Zd(t,e){if((t=Pe(t)).firestore!==e)throw new H(V.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Ee(){return new lp("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eR(t){return Ho(t=Ft(t,on)),new ZC(t,e=>Ku(t,e))}(function(e,r=!0){(function(s){Gi=s})(zs),Cs(new $n("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),c=new on(new KN(n.getProvider("auth-internal")),new YN(a,n.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new H(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wo(d.options.projectId,f)}(a,s),a);return i={useFetchStreams:r,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Nr($0,q0,e),Nr($0,q0,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V1="firebasestorage.googleapis.com",tR="storageBucket",rR=2*60*1e3,nR=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr extends Vr{constructor(e,r,n=0){super(eh(e),`Firebase Storage: ${r} (${eh(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Lr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return eh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Or;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Or||(Or={}));function eh(t){return"storage/"+t}function sR(){const t="An unknown error occurred, please check the error payload for server response.";return new Lr(Or.UNKNOWN,t)}function iR(){return new Lr(Or.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function aR(){return new Lr(Or.CANCELED,"User canceled the upload/download.")}function oR(t){return new Lr(Or.INVALID_URL,"Invalid URL '"+t+"'.")}function lR(t){return new Lr(Or.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function By(t){return new Lr(Or.INVALID_ARGUMENT,t)}function M1(){return new Lr(Or.APP_DELETED,"The Firebase app was deleted.")}function cR(t){return new Lr(Or.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=hr.makeFromUrl(e,r)}catch{return new hr(e,"")}if(n.path==="")return n;throw lR(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const a="(/(.*))?$",c=new RegExp("^gs://"+s+a,"i"),u={bucket:1,path:3};function d(N){N.path_=decodeURIComponent(N.path)}const f="v[A-Za-z0-9_]+",g=r.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",_=new RegExp(`^https?://${g}/${f}/b/${s}/o${p}`,"i"),A={bucket:1,path:3},P=r===V1?"(?:storage.googleapis.com|storage.cloud.google.com)":r,S="([^?#]*)",w=new RegExp(`^https?://${P}/${s}/${S}`,"i"),I=[{regex:c,indices:u,postModify:i},{regex:_,indices:A,postModify:d},{regex:w,indices:{bucket:1,path:2},postModify:d}];for(let N=0;N<I.length;N++){const O=I[N],F=O.regex.exec(e);if(F){const x=F[O.indices.bucket];let y=F[O.indices.path];y||(y=""),n=new hr(x,y),O.postModify(n);break}}if(n==null)throw oR(e);return n}}class uR{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dR(t,e,r){let n=1,s=null,i=null,a=!1,c=0;function u(){return c===2}let d=!1;function f(...S){d||(d=!0,e.apply(null,S))}function g(S){s=setTimeout(()=>{s=null,t(_,u())},S)}function p(){i&&clearTimeout(i)}function _(S,...w){if(d){p();return}if(S){p(),f.call(null,S,...w);return}if(u()||a){p(),f.call(null,S,...w);return}n<64&&(n*=2);let I;c===1?(c=2,I=0):I=(n+Math.random())*1e3,g(I)}let A=!1;function P(S){A||(A=!0,p(),!d&&(s!==null?(S||(c=2),clearTimeout(s),g(0)):S||(c=1)))}return g(0),i=setTimeout(()=>{a=!0,P(!0)},r),P}function hR(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(t){return t!==void 0}function $y(t,e,r,n){if(n<e)throw By(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw By(`Invalid value for '${t}'. Expected ${r} or less.`)}function mR(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var nu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(nu||(nu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pR(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e,r,n,s,i,a,c,u,d,f,g,p=!0,_=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=f,this.connectionFactory_=g,this.retry=p,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((A,P)=>{this.resolve_=A,this.reject_=P,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new zl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=c=>{const u=c.loaded,d=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const c=i.getErrorCode()===nu.NO_ERROR,u=i.getStatus();if(!c||pR(u,this.additionalRetryCodes_)&&this.retry){const f=i.getErrorCode()===nu.ABORT;n(!1,new zl(!1,null,f));return}const d=this.successCodes_.indexOf(u)!==-1;n(!0,new zl(d,i))})},r=(n,s)=>{const i=this.resolve_,a=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(c,c.getResponse());fR(u)?i(u):i()}catch(u){a(u)}else if(c!==null){const u=sR();u.serverResponse=c.getErrorText(),this.errorCallback_?a(this.errorCallback_(c,u)):a(u)}else if(s.canceled){const u=this.appDelete_?M1():aR();a(u)}else{const u=iR();a(u)}};this.canceled_?r(!1,new zl(!1,null,!0)):this.backoffId_=dR(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&hR(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class zl{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function yR(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function xR(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function vR(t,e){e&&(t["X-Firebase-GMPID"]=e)}function _R(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function wR(t,e,r,n,s,i,a=!0,c=!1){const u=mR(t.urlParams),d=t.url+u,f=Object.assign({},t.headers);return vR(f,e),yR(f,r),xR(f,i),_R(f,n),new gR(d,t.method,f,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kR(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function bR(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,r){this._service=e,r instanceof hr?this._location=r:this._location=hr.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new su(e,r)}get root(){const e=new hr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return bR(this._location.path)}get storage(){return this._service}get parent(){const e=kR(this._location.path);if(e===null)return null;const r=new hr(this._location.bucket,e);return new su(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw cR(e)}}function qy(t,e){const r=e==null?void 0:e[tR];return r==null?null:hr.makeFromBucketSpec(r,t)}function ER(t,e,r,n={}){t.host=`${e}:${r}`;const s=Us(e);s&&(_m(`https://${t.host}/b`),wm("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=n;i&&(t._overrideAuthToken=typeof i=="string"?i:x_(i,t.app.options.projectId))}class TR{constructor(e,r,n,s,i,a=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=a,this._bucket=null,this._host=V1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=rR,this._maxUploadRetryTime=nR,this._requests=new Set,s!=null?this._bucket=hr.makeFromBucketSpec(s,this._host):this._bucket=qy(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=hr.makeFromBucketSpec(this._url,e):this._bucket=qy(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$y("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$y("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(Dt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new su(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new uR(M1());{const a=wR(e,this._appId,n,s,r,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const Hy="@firebase/storage",Wy="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1="storage";function IR(t=Em(),e){t=Pe(t);const n=Eu(t,L1).getImmediate({identifier:e}),s=p_("storage");return s&&NR(n,...s),n}function NR(t,e,r,n={}){ER(t,e,r,n)}function SR(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new TR(r,n,s,e,zs)}function AR(){Cs(new $n(L1,SR,"PUBLIC").setMultipleInstances(!0)),Nr(Hy,Wy,""),Nr(Hy,Wy,"esm2020")}AR();const CR={apiKey:"AIzaSyABIO6LGK1pUPB-zh0jIM-0XunBlq2GvI0",authDomain:"kefir-627a0.firebaseapp.com",projectId:"kefir-627a0",storageBucket:"kefir-627a0.firebasestorage.app",messagingSenderId:"661808265565",appId:"1:661808265565:web:cc47b6445aa701a45690b4"},pp=w_(CR),re=zC(pp),Na=zN(pp);IR(pp);const F1=L.createContext(void 0),un=()=>{const t=L.useContext(F1);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},RR=({children:t})=>{const[e,r]=L.useState(null),[n,s]=L.useState(!0),i=async(g,p)=>{try{await EI(Na,g,p)}catch(_){throw new Error(d(_.code))}},a=async(g,p,_)=>{try{const{user:A}=await bI(Na,g,p);await II(A,{displayName:_})}catch(A){throw new Error(d(A.code))}},c=async()=>{try{await CI(Na)}catch{throw new Error("Erreur lors de la déconnexion")}},u=async g=>{try{await kI(Na,g)}catch(p){throw new Error(d(p.code))}},d=g=>{switch(g){case"auth/user-not-found":return"Aucun compte trouvé avec cette adresse email";case"auth/wrong-password":return"Mot de passe incorrect";case"auth/email-already-in-use":return"Cette adresse email est déjà utilisée";case"auth/weak-password":return"Le mot de passe doit contenir au moins 6 caractères";case"auth/invalid-email":return"Adresse email invalide";case"auth/too-many-requests":return"Trop de tentatives. Veuillez réessayer plus tard";default:return"Une erreur est survenue. Veuillez réessayer"}};L.useEffect(()=>AI(Na,p=>{r(p),s(!1)}),[]);const f={currentUser:e,loading:n,login:i,register:a,logout:c,resetPassword:u};return o.jsx(F1.Provider,{value:f,children:!n&&t})},It=(t,e,r,n)=>{const s=new Date().toISOString(),i={timestamp:s,operation:t,collection:e,success:!n,data:r?JSON.stringify(r,null,2):null,error:n?n.message:null};console.group(`🔥 Firebase ${t} - ${e}`),console.log(`⏰ Timestamp: ${s}`),console.log(`✅ Success: ${!n}`),r&&console.log("📄 Data:",r),n&&console.error("❌ Error:",n),console.groupEnd();const a=JSON.parse(localStorage.getItem("firebase-logs")||"[]");a.push(i),a.length>100&&a.shift(),localStorage.setItem("firebase-logs",JSON.stringify(a))},oe={CONTACTS:"contacts",PRODUCTS:"products",ORDERS:"orders",NOTES:"notes",REMINDERS:"reminders",VENDOR_INFO:"vendorInfo"},Xt=t=>{if(!t)return t;const e={...t};return Object.keys(e).forEach(r=>{e[r]instanceof ge?e[r]=e[r].toDate():e[r]&&typeof e[r]=="object"&&(e[r]=Xt(e[r]))}),e},Mt=t=>{if(!t)return t;const e={...t};return Object.keys(e).forEach(r=>{if(e[r]===void 0){delete e[r];return}e[r]instanceof Date?e[r]=ge.fromDate(e[r]):e[r]&&typeof e[r]=="object"&&!Array.isArray(e[r])&&(e[r]=Mt(e[r]))}),e},Bl={async getAll(t){const e=[];return t&&e.push(tr("userId","==",t)),(await Os(er(Ie(re,oe.CONTACTS),...e))).docs.map(n=>({id:n.id,...Xt(n.data())}))},async getById(t){const e=He(re,oe.CONTACTS,t),r=await JC(e);return r.exists()?{id:r.id,...Xt(r.data())}:null},async add(t,e){console.log("🚀 Starting contact creation...",t);const r=Mt(t),n={...r,totalSpent:r.totalSpent||0,averageOrderValue:r.averageOrderValue||0,preferredProducts:r.preferredProducts||[],customerStatus:r.customerStatus||"active",orderFrequency:r.orderFrequency||"monthly",deliveryPreferences:r.deliveryPreferences||{preferredDay:"saturday",preferredTime:"morning",frequency:"weekly"}};try{const s=await Zi(Ie(re,oe.CONTACTS),{...n,userId:e,createdAt:Ee(),updatedAt:Ee()});return It("ADD","contacts",{id:s.id,...n}),s.id}catch(s){throw It("ADD","contacts",n,s),s}},async update(t,e){console.log("🔄 Starting contact update...",{id:t,contact:e});const r=He(re,oe.CONTACTS,t),n=Mt(e),s=Object.fromEntries(Object.entries(n).filter(([i,a])=>a!==void 0));try{await Ji(r,{...s,updatedAt:Ee()}),It("UPDATE","contacts",{id:t,...s})}catch(i){throw It("UPDATE","contacts",{id:t,...s},i),i}},async delete(t){await Go(He(re,oe.CONTACTS,t))},onSnapshot(t,e){const r=[];return e&&r.push(tr("userId","==",e)),Qo(er(Ie(re,oe.CONTACTS),...r),n=>{const s=n.docs.map(i=>({id:i.id,...Xt(i.data())}));t(s)})}},$l={async getAll(t){const e=[];return t&&e.push(tr("userId","==",t)),(await Os(er(Ie(re,oe.PRODUCTS),...e))).docs.map(s=>({id:s.id,...Xt(s.data())})).sort((s,i)=>{const a=s.createdAt?new Date(s.createdAt).getTime():0;return(i.createdAt?new Date(i.createdAt).getTime():0)-a})},async add(t,e){console.log("🚀 Starting product creation...",t);try{const r=await Zi(Ie(re,oe.PRODUCTS),{...t,userId:e,createdAt:Ee(),updatedAt:Ee()});return It("ADD","products",{id:r.id,...t}),r.id}catch(r){throw It("ADD","products",t,r),r}},async update(t,e){console.log("🔄 Starting product update...",{id:t,product:e});const r=He(re,oe.PRODUCTS,t);try{await Ji(r,{...e,updatedAt:Ee()}),It("UPDATE","products",{id:t,...e})}catch(n){throw It("UPDATE","products",{id:t,...e},n),n}},async delete(t){await Go(He(re,oe.PRODUCTS,t))},onSnapshot(t,e){const r=[];return e&&r.push(tr("userId","==",e)),Qo(er(Ie(re,oe.PRODUCTS),...r),n=>{let s=n.docs.map(i=>({id:i.id,...Xt(i.data())}));s=s.sort((i,a)=>{const c=i.createdAt?new Date(i.createdAt).getTime():0;return(a.createdAt?new Date(a.createdAt).getTime():0)-c}),t(s)})}},th={async getAll(t){const e=[];return t&&e.push(tr("userId","==",t)),(await Os(er(Ie(re,oe.ORDERS),...e))).docs.map(s=>({id:s.id,...Xt(s.data())})).sort((s,i)=>{const a=s.orderDate?new Date(s.orderDate).getTime():0;return(i.orderDate?new Date(i.orderDate).getTime():0)-a})},async add(t,e){console.log("🚀 Starting order creation...",t);const r=Mt(t);try{const n=await Zi(Ie(re,oe.ORDERS),{...r,userId:e,createdAt:Ee(),updatedAt:Ee()});return It("ADD","orders",{id:n.id,...r}),n.id}catch(n){throw It("ADD","orders",r,n),n}},async update(t,e){const r=He(re,oe.ORDERS,t),n=Mt(e);await Ji(r,{...n,updatedAt:Ee()})},async delete(t){await Go(He(re,oe.ORDERS,t))},onSnapshot(t,e){const r=[];return e&&r.push(tr("userId","==",e)),Qo(er(Ie(re,oe.ORDERS),...r),n=>{let s=n.docs.map(i=>({id:i.id,...Xt(i.data())}));s=s.sort((i,a)=>{const c=i.orderDate?new Date(i.orderDate).getTime():0;return(a.orderDate?new Date(a.orderDate).getTime():0)-c}),t(s)})}},Ky={async getAll(t){const e=[];return t&&e.push(tr("userId","==",t)),(await Os(er(Ie(re,oe.NOTES),...e))).docs.map(s=>({id:s.id,...Xt(s.data())})).sort((s,i)=>{const a=s.date?new Date(s.date).getTime():0;return(i.date?new Date(i.date).getTime():0)-a})},async add(t,e){console.log("🚀 Starting note creation...",t);const r=Mt(t);try{const n=await Zi(Ie(re,oe.NOTES),{...r,userId:e,createdAt:Ee()});return It("ADD","notes",{id:n.id,contactId:t.contactId}),n.id}catch(n){throw It("ADD","notes",{contactId:t.contactId},n),n}},async update(t,e){const r=He(re,oe.NOTES,t),n=Mt(e);await Ji(r,n)},async delete(t){await Go(He(re,oe.NOTES,t))},onSnapshot(t,e){const r=[];return e&&r.push(tr("userId","==",e)),Qo(er(Ie(re,oe.NOTES),...r),n=>{let s=n.docs.map(i=>({id:i.id,...Xt(i.data())}));s=s.sort((i,a)=>{const c=i.date?new Date(i.date).getTime():0;return(a.date?new Date(a.date).getTime():0)-c}),t(s)})}},Gy={async getAll(t){const e=[];return t&&e.push(tr("userId","==",t)),(await Os(er(Ie(re,oe.REMINDERS),...e))).docs.map(s=>({id:s.id,...Xt(s.data())})).sort((s,i)=>{const a=s.date?new Date(s.date).getTime():0,c=i.date?new Date(i.date).getTime():0;return a-c})},async add(t,e){const r=Mt(t);return(await Zi(Ie(re,oe.REMINDERS),{...r,userId:e,createdAt:Ee()})).id},async update(t,e){const r=He(re,oe.REMINDERS,t),n=Mt(e);await Ji(r,n)},async delete(t){await Go(He(re,oe.REMINDERS,t))},onSnapshot(t,e){const r=[];return e&&r.push(tr("userId","==",e)),Qo(er(Ie(re,oe.REMINDERS),...r),n=>{let s=n.docs.map(i=>({id:i.id,...Xt(i.data())}));s=s.sort((i,a)=>{const c=i.date?new Date(i.date).getTime():0,u=a.date?new Date(a.date).getTime():0;return c-u}),t(s)})}},Qy={async get(t){const e=[];t&&e.push(tr("userId","==",t));const r=await Os(er(Ie(re,oe.VENDOR_INFO),...e));if(!r.empty){const n=r.docs[0];return{id:n.id,...n.data()}}return null},async set(t,e){const r=await Os(er(Ie(re,oe.VENDOR_INFO),tr("userId","==",e)));if(r.empty)await Zi(Ie(re,oe.VENDOR_INFO),{...t,userId:e,createdAt:Ee(),updatedAt:Ee()});else{const n=He(re,oe.VENDOR_INFO,r.docs[0].id);await Ji(n,{...t,userId:e,updatedAt:Ee()})}}},PR={async migrateAllData(t,e){console.log("🚀 Starting complete data migration...",{contactsCount:t.contacts.length,productsCount:t.products.length,ordersCount:t.orders.length,notesCount:t.notes.length,remindersCount:t.reminders.length});const r=eR(re);let n=0,s=0;try{console.log("📋 Migrating contacts...");for(const a of t.contacts){const{id:c,...u}=a,d=He(Ie(re,oe.CONTACTS)),f=Mt(u);r.set(d,{...f,userId:e,createdAt:Ee(),updatedAt:Ee()}),n++}console.log("📦 Migrating products...");for(const a of t.products){const{id:c,...u}=a,d=He(Ie(re,oe.PRODUCTS));r.set(d,{...u,userId:e,createdAt:Ee(),updatedAt:Ee()}),n++}console.log("🛒 Migrating orders...");for(const a of t.orders){const{id:c,...u}=a,d=He(Ie(re,oe.ORDERS)),f=Mt(u);r.set(d,{...f,userId:e,createdAt:Ee(),updatedAt:Ee()}),n++}console.log("📝 Migrating notes...");for(const a of t.notes){const{id:c,...u}=a,d=He(Ie(re,oe.NOTES)),f=Mt(u);r.set(d,{...f,userId:e,createdAt:Ee()}),n++}console.log("⏰ Migrating reminders...");for(const a of t.reminders){const{id:c,...u}=a,d=He(Ie(re,oe.REMINDERS)),f=Mt(u);r.set(d,{...f,userId:e,createdAt:Ee()}),n++}if(console.log("🏢 Migrating vendor info..."),t.vendorInfo){const a=He(Ie(re,oe.VENDOR_INFO));r.set(a,{...t.vendorInfo,userId:e,createdAt:Ee(),updatedAt:Ee()}),n++}await r.commit();const i={totalItems:n,contacts:t.contacts.length,products:t.products.length,orders:t.orders.length,notes:t.notes.length,reminders:t.reminders.length};console.log("✅ Migration completed successfully!",i),It("MIGRATE","all-collections",i)}catch(i){throw console.error("❌ Migration failed:",i),It("MIGRATE","all-collections",{successCount:n,errorCount:s},i),i}}},jR=()=>{const[t,e]=L.useState([]),[r,n]=L.useState([]),[s,i]=L.useState([]),[a,c]=L.useState([]),[u,d]=L.useState([]),[f,g]=L.useState({name:"Kéfir Madagascar SARL",address:"Lot II M 15 Bis Antanimena, 101 Antananarivo, Madagascar",phone:"+261 32 12 345 67",email:"contact@kefir-madagascar.mg",nif:"",stat:""}),[p,_]=L.useState(!0),[A,P]=L.useState(null),{currentUser:S}=un();return L.useEffect(()=>{if(!S){_(!1);return}const R=[];return(async()=>{try{_(!0);const ce=Bl.onSnapshot(e,S.uid),rr=$l.onSnapshot(n,S.uid),xr=th.onSnapshot(i,S.uid),Rt=Ky.onSnapshot(c,S.uid),$=Gy.onSnapshot(d,S.uid);R.push(ce,rr,xr,Rt,$);const Y=await Qy.get(S.uid);Y&&g(Y),_(!1)}catch(ce){console.error("Error initializing Firebase data:",ce),P("Erreur lors du chargement des données"),_(!1)}})(),()=>{R.forEach(ce=>ce())}},[S]),{contacts:t,products:r,orders:s,notes:a,reminders:u,vendorInfo:f,loading:p,error:A,addContact:async R=>{if(!S)throw new Error("User not authenticated");console.log("🎯 Hook: Adding contact...",R);try{const b=await Bl.add(R,S.uid);return console.log("✅ Hook: Contact added successfully"),b}catch(b){throw console.error("❌ Hook: Error adding contact:",b),P("Erreur lors de l'ajout du contact"),b}},updateContact:async(R,b)=>{console.log("🎯 Hook: Updating contact...",{id:R,contact:b});try{await Bl.update(R,b),console.log("✅ Hook: Contact updated successfully")}catch(ce){throw console.error("❌ Hook: Error updating contact:",ce),P("Erreur lors de la mise à jour du contact"),ce}},deleteContact:async R=>{try{await Bl.delete(R)}catch(b){throw console.error("Error deleting contact:",b),P("Erreur lors de la suppression du contact"),b}},addProduct:async R=>{if(!S)throw new Error("User not authenticated");console.log("🎯 Hook: Adding product...",R);try{const b=await $l.add(R,S.uid);return console.log("✅ Hook: Product added successfully"),b}catch(b){throw console.error("❌ Hook: Error adding product:",b),P("Erreur lors de l'ajout du produit"),b}},updateProduct:async(R,b)=>{console.log("🎯 Hook: Updating product...",{id:R,product:b});try{await $l.update(R,b),console.log("✅ Hook: Product updated successfully")}catch(ce){throw console.error("❌ Hook: Error updating product:",ce),P("Erreur lors de la mise à jour du produit"),ce}},deleteProduct:async R=>{try{await $l.delete(R)}catch(b){throw console.error("Error deleting product:",b),P("Erreur lors de la suppression du produit"),b}},addOrder:async R=>{if(!S)throw new Error("User not authenticated");console.log("🎯 Hook: Adding order...",R);try{const b=await th.add(R,S.uid);return console.log("✅ Hook: Order added successfully"),b}catch(b){throw console.error("❌ Hook: Error adding order:",b),P("Erreur lors de l'ajout de la commande"),b}},updateOrder:async(R,b)=>{console.log("🔄 Hook: Updating order...",{id:R,order:b});try{await th.update(R,b),console.log("✅ Hook: Order updated successfully")}catch(ce){throw console.error("Error updating order:",ce),P("Erreur lors de la mise à jour de la commande"),ce}},addNote:async R=>{if(!S)throw new Error("User not authenticated");console.log("🎯 Hook: Adding note...",R);try{const b=await Ky.add(R,S.uid);return console.log("✅ Hook: Note added successfully"),b}catch(b){throw console.error("❌ Hook: Error adding note:",b),P("Erreur lors de l'ajout de la note"),b}},updateReminder:async(R,b)=>{try{await Gy.update(R,b)}catch(ce){throw console.error("Error updating reminder:",ce),P("Erreur lors de la mise à jour du rappel"),ce}},saveVendorInfo:async R=>{if(!S)throw new Error("User not authenticated");console.log("🎯 Hook: Saving vendor info...",R);try{return await Qy.set(R,S.uid),g(R),console.log("✅ Hook: Vendor info saved successfully"),!0}catch(b){throw console.error("❌ Hook: Error saving vendor info:",b),P("Erreur lors de la sauvegarde des informations vendeur"),b}}}};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var DR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Q=(t,e)=>{const r=L.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:c="",children:u,...d},f)=>L.createElement("svg",{ref:f,...DR,width:s,height:s,stroke:n,strokeWidth:a?Number(i)*24/Number(s):i,className:["lucide",`lucide-${OR(t)}`,c].join(" "),...d},[...e.map(([g,p])=>L.createElement(g,p)),...Array.isArray(u)?u:[u]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=Q("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=Q("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=Q("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=Q("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=Q("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=Q("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=Q("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=Q("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=Q("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=Q("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=Q("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=Q("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z1=Q("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B1=Q("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=Q("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yy=Q("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kf=Q("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $1=Q("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q1=Q("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gp=Q("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H1=Q("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=Q("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xy=Q("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=Q("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=Q("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=Q("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=Q("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=Q("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=Q("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=Q("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=Q("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=Q("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=Q("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=Q("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=Q("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=Q("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=Q("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=Q("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=Q("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=Q("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W1=Q("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K1=Q("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZR=Q("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yp=Q("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G1=Q("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=Q("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=Q("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=Q("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=Q("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Q("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xp=Q("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=Q("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),nP=({isOpen:t,onClose:e,localData:r,onMigrationComplete:n})=>{const[s,i]=L.useState("idle"),[a,c]=L.useState(null),{currentUser:u}=un(),d=async()=>{if(!u){c("Utilisateur non authentifié"),i("error");return}try{i("migrating"),c(null),await PR.migrateAllData(r,u.uid),i("success"),setTimeout(()=>{n(),e()},2e3)}catch(f){console.error("Migration error:",f),c(f instanceof Error?f.message:"Erreur inconnue lors de la migration"),i("error")}};return t?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(zR,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Migration vers Firebase"})]}),s==="idle"&&o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsxs("div",{className:"p-6",children:[s==="idle"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"Cette opération va migrer toutes vos données locales vers Firebase. Voici un résumé de ce qui sera migré :"}),o.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4 space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Clients :"}),o.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.contacts.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Produits :"}),o.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.products.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Commandes :"}),o.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.orders.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Notes :"}),o.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.notes.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Rappels :"}),o.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.reminders.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Informations vendeur :"}),o.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.vendorInfo?"✓":"✗"})]})]})]}),o.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mb-6",children:o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Io,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-1",children:"Important"}),o.jsx("p",{className:"text-blue-700 dark:text-blue-400 text-sm",children:"Cette opération est irréversible. Assurez-vous d'avoir une sauvegarde de vos données si nécessaire. Après la migration, l'application utilisera exclusivement Firebase pour le stockage des données."})]})]})}),o.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:d,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all hover:scale-105 hover:shadow-lg hover:shadow-blue-600/25",children:[o.jsx(tP,{className:"w-4 h-4"}),o.jsx("span",{children:"Commencer la migration"})]})]})]}),s==="migrating"&&o.jsxs("div",{className:"text-center py-8",children:[o.jsx($R,{className:"w-12 h-12 text-blue-600 dark:text-blue-400 animate-spin mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Migration en cours..."}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Veuillez patienter pendant que nous transférons vos données vers Firebase."})]}),s==="success"&&o.jsxs("div",{className:"text-center py-8",children:[o.jsx(No,{className:"w-12 h-12 text-emerald-600 dark:text-emerald-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Migration réussie !"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Toutes vos données ont été transférées avec succès vers Firebase. L'application va maintenant utiliser le cloud pour le stockage."})]}),s==="error"&&o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Io,{className:"w-12 h-12 text-red-600 dark:text-red-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Erreur de migration"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Une erreur s'est produite lors de la migration :"}),o.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 mb-4",children:o.jsx("p",{className:"text-red-700 dark:text-red-400 text-sm font-mono",children:a})}),o.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Fermer"}),o.jsx("button",{onClick:()=>{i("idle"),c(null)},className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Réessayer"})]})]})]})]})}):null},Ef=({className:t="w-8 h-8"})=>o.jsx("div",{className:t,children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 48 48",children:o.jsxs("g",{fill:"none",stroke:"currentColor",strokeWidth:"4",children:[o.jsx("path",{d:"M13.5 39.37A16.93 16.93 0 0 0 24 43c3.963 0 7.61-1.356 10.5-3.63M19 9.747C12.051 11.882 7 18.351 7 26c0 1.925.32 3.775.91 5.5M29 9.747C35.949 11.882 41 18.351 41 26c0 1.925-.32 3.775-.91 5.5"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M43 36c0 1.342-.528 2.56-1.388 3.458A5 5 0 1 1 43 36m-28 0c0 1.342-.528 2.56-1.388 3.458A5 5 0 1 1 15 36M29 9c0 1.342-.528 2.56-1.388 3.458A5 5 0 1 1 29 9"})]})})}),sP=({onToggleMode:t,isRegisterMode:e})=>{const{login:r,register:n,resetPassword:s}=un(),[i,a]=L.useState({email:"",password:"",confirmPassword:"",displayName:""}),[c,u]=L.useState(!1),[d,f]=L.useState(!1),[g,p]=L.useState(!1),[_,A]=L.useState(""),[P,S]=L.useState(!1),[w,k]=L.useState(""),[I,N]=L.useState(""),O=async y=>{y.preventDefault(),A(""),p(!0);try{if(e){if(i.password!==i.confirmPassword)throw new Error("Les mots de passe ne correspondent pas");if(i.password.length<6)throw new Error("Le mot de passe doit contenir au moins 6 caractères");if(!i.displayName.trim())throw new Error("Le nom est requis");await n(i.email,i.password,i.displayName)}else await r(i.email,i.password)}catch(E){A(E.message)}finally{p(!1)}},F=async y=>{y.preventDefault(),A(""),N("");try{await s(w),N("Un email de réinitialisation a été envoyé à votre adresse"),k("")}catch(E){A(E.message)}},x=(y,E)=>{a(T=>({...T,[y]:E}))};return P?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sage-50 to-sage-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl p-8 w-full max-w-md border border-gray-200 dark:border-gray-800",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx(Ef,{className:"w-16 h-16 mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Réinitialiser le mot de passe"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Entrez votre adresse email pour recevoir un lien de réinitialisation"})]}),o.jsxs("form",{onSubmit:F,className:"space-y-6",children:[_&&o.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Io,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),o.jsx("p",{className:"text-red-700 dark:text-red-400 text-sm",children:_})]})}),I&&o.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:o.jsx("p",{className:"text-green-700 dark:text-green-400 text-sm",children:I})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adresse email"}),o.jsxs("div",{className:"relative",children:[o.jsx(Ms,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:"email",value:w,onChange:y=>k(y.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",placeholder:"votre@email.com",required:!0})]})]}),o.jsx("button",{type:"submit",className:"w-full bg-sage-600 hover:bg-sage-700 text-white py-3 px-4 rounded-xl font-medium transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25",children:"Envoyer le lien de réinitialisation"}),o.jsx("button",{type:"button",onClick:()=>S(!1),className:"w-full text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:"Retour à la connexion"})]})]})}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sage-50 to-sage-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl p-8 w-full max-w-md border border-gray-200 dark:border-gray-800",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx(Ef,{className:"w-16 h-16 mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e?"Créer un compte":"Connexion"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:e?"Rejoignez votre équipe CRM Kéfir":"Accédez à votre CRM Kéfir"})]}),o.jsxs("form",{onSubmit:O,className:"space-y-6",children:[_&&o.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Io,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),o.jsx("p",{className:"text-red-700 dark:text-red-400 text-sm",children:_})]})}),e&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nom complet"}),o.jsx("input",{type:"text",value:i.displayName,onChange:y=>x("displayName",y.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",placeholder:"Jean Dupont",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adresse email"}),o.jsxs("div",{className:"relative",children:[o.jsx(Ms,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:"email",value:i.email,onChange:y=>x("email",y.target.value),className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",placeholder:"votre@email.com",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(Xy,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:c?"text":"password",value:i.password,onChange:y=>x("password",y.target.value),className:"w-full pl-10 pr-12 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",placeholder:"••••••••",required:!0}),o.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:c?o.jsx(Yy,{className:"w-5 h-5"}):o.jsx(kf,{className:"w-5 h-5"})})]})]}),e&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirmer le mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(Xy,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:d?"text":"password",value:i.confirmPassword,onChange:y=>x("confirmPassword",y.target.value),className:"w-full pl-10 pr-12 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",placeholder:"••••••••",required:!0}),o.jsx("button",{type:"button",onClick:()=>f(!d),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d?o.jsx(Yy,{className:"w-5 h-5"}):o.jsx(kf,{className:"w-5 h-5"})})]})]}),o.jsx("button",{type:"submit",disabled:g,className:`w-full flex items-center justify-center space-x-2 py-3 px-4 rounded-xl font-medium transition-all duration-200 ${g?"bg-gray-400 cursor-not-allowed":"bg-sage-600 hover:bg-sage-700 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"} text-white`,children:g?o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):o.jsxs(o.Fragment,{children:[e?o.jsx(rP,{className:"w-5 h-5"}):o.jsx(qR,{className:"w-5 h-5"}),o.jsx("span",{children:e?"Créer le compte":"Se connecter"})]})}),!e&&o.jsx("button",{type:"button",onClick:()=>S(!0),className:"w-full text-sage-600 dark:text-sage-400 hover:text-sage-700 dark:hover:text-sage-300 text-sm transition-colors",children:"Mot de passe oublié ?"}),o.jsx("div",{className:"text-center",children:o.jsx("button",{type:"button",onClick:t,className:"text-sage-600 dark:text-sage-400 hover:text-sage-700 dark:hover:text-sage-300 font-medium transition-colors",children:e?"Déjà un compte ? Se connecter":"Pas de compte ? Créer un compte"})})]})]})})},iP=({children:t})=>{const{currentUser:e}=un(),[r,n]=Af.useState(!1);return e?o.jsx(o.Fragment,{children:t}):o.jsx(sP,{onToggleMode:()=>n(!r),isRegisterMode:r})},Q1=L.createContext(void 0),aP=()=>{const t=L.useContext(Q1);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},oP=({children:t})=>{const[e,r]=L.useState("system"),[n,s]=L.useState("dark");L.useEffect(()=>{const a=localStorage.getItem("theme");a&&["light","dark","system"].includes(a)&&r(a)},[]),L.useEffect(()=>{const a=()=>{if(e==="system"){const c=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";s(c)}else s(e)};if(a(),e==="system"){const c=window.matchMedia("(prefers-color-scheme: dark)");return c.addEventListener("change",a),()=>c.removeEventListener("change",a)}},[e]),L.useEffect(()=>{localStorage.setItem("theme",e);const a=document.documentElement;n==="dark"?a.classList.add("dark"):a.classList.remove("dark")},[e,n]);const i=a=>{r(a)};return o.jsx(Q1.Provider,{value:{theme:e,resolvedTheme:n,setTheme:i},children:t})},lP=()=>{const{theme:t,setTheme:e}=aP(),r=[{id:"light",icon:ZR,label:"Clair"},{id:"dark",icon:GR,label:"Sombre"},{id:"system",icon:KR,label:"Système"}];return o.jsx("div",{className:"flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:r.map(n=>{const s=n.icon,i=t===n.id;return o.jsxs("button",{onClick:()=>e(n.id),className:`flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 ${i?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,title:`Basculer vers le thème ${n.label.toLowerCase()}`,children:[o.jsx(s,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:n.label})]},n.id)})})},cP=()=>{var i,a;const{currentUser:t,logout:e}=un(),[r,n]=L.useState(!1),s=async()=>{try{await e()}catch(c){console.error("Erreur lors de la déconnexion:",c)}};return t?o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>n(!r),className:"flex items-center space-x-2 bg-white/10 hover:bg-white/20 dark:bg-gray-800/50 dark:hover:bg-gray-800/70 backdrop-blur-sm border border-white/20 dark:border-gray-700 rounded-xl px-3 py-2 transition-all duration-200",children:[o.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-sage-600 to-sage-700 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:((i=t.displayName)==null?void 0:i.charAt(0))||((a=t.email)==null?void 0:a.charAt(0))||"U"}),o.jsxs("div",{className:"hidden sm:block text-left",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.displayName||"Utilisateur"}),o.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:t.email})]}),o.jsx(U1,{className:`w-4 h-4 text-gray-600 dark:text-gray-400 transition-transform ${r?"rotate-180":""}`})]}),r&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),o.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-xl shadow-lg z-20 overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-800",children:[o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.displayName||"Utilisateur"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.email})]}),o.jsxs("div",{className:"py-2",children:[o.jsxs("button",{onClick:()=>{n(!1)},className:"flex items-center space-x-2 w-full px-4 py-2 text-left text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[o.jsx(YR,{className:"w-4 h-4"}),o.jsx("span",{children:"Paramètres du compte"})]}),o.jsxs("button",{onClick:s,className:"flex items-center space-x-2 w-full px-4 py-2 text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[o.jsx(HR,{className:"w-4 h-4"}),o.jsx("span",{children:"Se déconnecter"})]})]})]})]})]}):null},uP=({children:t,activeTab:e,onTabChange:r,onNewNote:n,onVendorSettings:s})=>{const i=[{id:"dashboard",label:"Tableau de bord",icon:VR},{id:"contacts",label:"Clients",icon:xp},{id:"orders",label:"Commandes",icon:XR},{id:"products",label:"Produits",icon:xt},{id:"timeline",label:"Mémoire",icon:UR}];return o.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 text-gray-900 dark:text-white transition-colors",children:[o.jsx("header",{className:"sticky top-0 z-50 bg-white/80 dark:bg-gray-950/80 backdrop-blur-xl border-b border-gray-200 dark:border-gray-800",children:o.jsx("div",{className:"max-w-6xl mx-auto px-6 py-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Ef,{className:"w-10 h-10"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Connections"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Your personal relationship journal"})]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx(lP,{}),o.jsx(cP,{}),o.jsxs("button",{onClick:s,className:"flex items-center space-x-2 bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105",children:[o.jsx(xt,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Paramètres"})]}),o.jsxs("button",{onClick:n,className:"flex items-center space-x-2 bg-sage-600 hover:bg-sage-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25",children:[o.jsx(Qu,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Ajouter une note"})]})]})]})})}),o.jsx("nav",{className:"sticky top-20 z-40 bg-white/80 dark:bg-gray-950/80 backdrop-blur-xl border-b border-gray-200 dark:border-gray-800",children:o.jsx("div",{className:"max-w-6xl mx-auto px-6",children:o.jsx("div",{className:"flex space-x-1",children:i.map(a=>{const c=a.icon,u=e===a.id;return o.jsxs("button",{onClick:()=>r(a.id),className:`flex items-center space-x-2 px-4 py-3 transition-all duration-200 border-b-2 ${u?"bg-sage-600/20 text-sage-600 dark:text-sage-400 border-sage-600 dark:border-sage-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800/50 border-transparent"}`,children:[o.jsx(c,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline font-medium",children:a.label})]},a.id)})})})}),o.jsx("main",{className:"max-w-6xl mx-auto px-6 py-8",children:t})]})},dP=({customers:t,orders:e,deliveries:r,analytics:n,reminders:s,onContactClick:i,onReminderComplete:a})=>{const c=new Date;c.setHours(0,0,0,0);const u=new Date(c);u.setDate(u.getDate()+1);const d=e.filter(w=>{if(w.status!=="delivered"||!w.deliveryDate)return!1;const k=new Date(w.deliveryDate);return k>=c&&k<u}),f=e.filter(w=>{if(w.status!=="delivered")return!1;const k=w.deliveryDate||w.orderDate;if(!k)return!1;const I=new Date;I.setHours(0,0,0,0);const N=new Date(I);N.setDate(N.getDate()+1);const O=new Date(k);return O>=I&&O<N}),g=d.length>0?d:f,p=e.filter(w=>w.status==="pending"),_=e.filter(w=>w.paymentStatus==="overdue"),A=s.filter(w=>!w.completed),P=w=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(w),S=w=>new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}).format(w);return o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"text-center py-6",children:[o.jsx("h2",{className:"text-3xl font-light text-gray-900 dark:text-white mb-2",children:"Tableau de Bord Kéfir"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"Vue d'ensemble de votre activité commerciale"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx("div",{className:"bg-gradient-to-br from-emerald-100 to-emerald-200 dark:from-emerald-600/20 dark:to-emerald-700/20 border border-emerald-200 dark:border-emerald-600/30 rounded-2xl p-6",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(BR,{className:"w-8 h-8 text-emerald-600 dark:text-emerald-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:P(n.monthlyRevenue)}),o.jsx("p",{className:"text-emerald-700 dark:text-emerald-300 text-sm",children:"CA ce mois"})]})]})}),o.jsx("div",{className:"bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-600/20 dark:to-blue-700/20 border border-blue-200 dark:border-blue-600/30 rounded-2xl p-6",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(xp,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:n.activeCustomers}),o.jsx("p",{className:"text-blue-700 dark:text-blue-300 text-sm",children:"Clients actifs"})]})]})}),o.jsx("div",{className:"bg-gradient-to-br from-purple-100 to-purple-200 dark:from-purple-600/20 dark:to-purple-700/20 border border-purple-200 dark:border-purple-600/30 rounded-2xl p-6",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(xt,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:p.length}),o.jsx("p",{className:"text-purple-700 dark:text-purple-300 text-sm",children:"Commandes en attente"})]})]})}),o.jsx("div",{className:"bg-gradient-to-br from-orange-100 to-orange-200 dark:from-orange-600/20 dark:to-orange-700/20 border border-orange-200 dark:border-orange-600/30 rounded-2xl p-6",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(au,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:g.length}),o.jsx("p",{className:"text-orange-700 dark:text-orange-300 text-sm",children:"Livraisons aujourd'hui"})]})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[o.jsx(au,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),o.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Commandes livrées aujourd'hui"})]}),o.jsx("div",{className:"space-y-4",children:g.length===0?o.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center py-8",children:"Aucune commande livrée aujourd'hui"}):g.map(w=>o.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700",children:[o.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full mt-2"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:w.customerName}),o.jsxs("p",{className:"text-gray-700 dark:text-gray-300 text-sm",children:[w.deliveryAddress.street,", ",w.deliveryAddress.city]}),o.jsxs("p",{className:"text-gray-500 dark:text-gray-500 text-xs mt-1",children:["Livrée le ",S(w.deliveryDate||w.orderDate)," • Total: ",P(w.totalAmount)]}),o.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:(Array.isArray(w.items)?w.items:[]).map((k,I)=>o.jsxs("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 dark:bg-orange-600/20 dark:text-orange-300 text-xs rounded-full",children:[k.quantity,"x ",k.productName]},I))})]})]},w.id))})]}),o.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[o.jsx(Io,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),o.jsxs("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Alertes ",_.length+p.length+A.length>0&&`(${_.length+p.length+A.length})`]})]}),o.jsxs("div",{className:"space-y-4",children:[_.length>0&&o.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl",children:[o.jsxs("h4",{className:"font-medium text-red-800 dark:text-red-300 mb-2",children:["Paiements en retard (",_.length,")"]}),_.slice(0,3).map(w=>o.jsxs("p",{className:"text-red-700 dark:text-red-400 text-sm",children:[w.customerName," - ",P(w.totalAmount)]},w.id))]}),p.length>0&&o.jsxs("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:[o.jsxs("h4",{className:"font-medium text-amber-800 dark:text-amber-300 mb-2",children:["Commandes à traiter (",p.length,")"]}),p.slice(0,3).map(w=>o.jsxs("p",{className:"text-amber-700 dark:text-amber-400 text-sm",children:[w.customerName," - ",S(w.orderDate)]},w.id))]}),A.length>0&&o.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl",children:[o.jsxs("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-2",children:["Rappels en attente (",A.length,")"]}),A.slice(0,3).map(w=>o.jsxs("div",{className:"flex items-center justify-between text-blue-700 dark:text-blue-400 text-sm mb-1",children:[o.jsxs("span",{children:[w.contactName," - ",w.message]}),o.jsx("button",{onClick:()=>a(w.id),className:"text-xs bg-blue-100 dark:bg-blue-800/30 px-2 py-1 rounded hover:bg-blue-200 dark:hover:bg-blue-800/50",children:"Marquer fait"})]},w.id))]}),_.length===0&&p.length===0&&A.length===0&&o.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center py-8",children:"Aucune alerte pour le moment 🎉"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[o.jsx(K1,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"}),o.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Meilleurs clients"})]}),o.jsx("div",{className:"space-y-3",children:n.topCustomers.slice(0,5).map((w,k)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50/50 dark:bg-gray-800/30 rounded-xl",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-amber-600 to-amber-700 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:k+1}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:w.customerName}),o.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:[w.orderCount," commandes"]})]})]}),o.jsx("div",{className:"text-right",children:o.jsx("p",{className:"text-gray-900 dark:text-white font-semibold",children:P(w.totalSpent)})})]},w.customerId))})]}),o.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[o.jsx(eP,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-400"}),o.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Produits populaires"})]}),o.jsx("div",{className:"space-y-3",children:n.topProducts.slice(0,5).map((w,k)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50/50 dark:bg-gray-800/30 rounded-xl",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-600 to-emerald-700 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:k+1}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:w.productName}),o.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:[w.quantity," vendus"]})]})]}),o.jsx("div",{className:"text-right",children:o.jsx("p",{className:"text-gray-900 dark:text-white font-semibold",children:P(w.revenue)})})]},w.productId))})]})]})]})},hP=({contact:t,onClick:e,onToggleStar:r})=>{const n=i=>{switch(i){case"positive":return"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-400";case"needs-attention":return"bg-amber-100 text-amber-600 dark:bg-amber-500/20 dark:text-amber-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-500/20 dark:text-gray-400"}},s=i=>{if(!i)return"Aucun contact récent";const c=new Date().getTime()-i.getTime(),u=Math.floor(c/(1e3*60*60*24));return u===0?"Aujourd'hui":u===1?"Hier":u<7?`Il y a ${u} jour${u>1?"s":""}`:u<30?`Il y a ${Math.floor(u/7)} semaine${Math.floor(u/7)>1?"s":""}`:`Il y a ${Math.floor(u/30)} mois`};return o.jsxs("div",{onClick:e,className:"group bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:bg-gray-50 dark:hover:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-700 transition-all duration-300 hover:scale-[1.02] hover:shadow-lg hover:shadow-sage-600/10 cursor-pointer",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-sage-600 to-sage-700 rounded-full flex items-center justify-center text-white font-semibold text-lg",children:t.name.split(" ").map(i=>i[0]).join("")}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-lg text-gray-900 dark:text-white group-hover:text-sage-600 dark:group-hover:text-sage-300 transition-colors",children:t.name}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:t.relationship})]})]}),o.jsx("button",{onClick:i=>{i.stopPropagation(),r(t.id)},className:`p-2 rounded-full transition-all duration-200 hover:scale-110 ${t.starred?"text-amber-500 hover:text-amber-400":"text-gray-400 dark:text-gray-500 hover:text-amber-500"}`,children:o.jsx(K1,{className:`w-5 h-5 ${t.starred?"fill-current":""}`})})]}),o.jsxs("div",{className:"flex items-center space-x-4 mb-4 text-sm text-gray-600 dark:text-gray-400",children:[t.email&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Ms,{className:"w-4 h-4"}),o.jsx("span",{className:"truncate max-w-32",children:t.email})]}),t.phone&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Xo,{className:"w-4 h-4"}),o.jsx("span",{children:t.phone})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[(Array.isArray(t.tags)?t.tags:[]).slice(0,3).map(i=>o.jsx("span",{className:"px-2 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-xs rounded-full border border-sage-200 dark:border-sage-600/30",children:i},i)),(Array.isArray(t.tags)?t.tags:[]).length>3&&o.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 dark:bg-gray-700/50 dark:text-gray-400 text-xs rounded-full",children:["+",(Array.isArray(t.tags)?t.tags:[]).length-3," more"]})]}),o.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-800",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${n(t.sentiment).replace("text-","bg-").replace("/20","/60")}`}),o.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Dernier contact : ",s(t.lastContact)]})]}),o.jsxs("div",{className:"flex items-center space-x-1 text-gray-500 dark:text-gray-500",children:[o.jsx(bf,{className:"w-4 h-4"}),o.jsx("span",{className:"text-sm",children:t.notes.length})]})]})]})},fP=({contacts:t,onContactClick:e,onToggleStar:r,onAddContact:n})=>{const[s,i]=L.useState(""),[a,c]=L.useState("all"),u=t.filter(f=>{const g=f.name.toLowerCase().includes(s.toLowerCase())||f.tags.some(_=>_.toLowerCase().includes(s.toLowerCase())),p=a==="all"||a==="starred"&&f.starred||a==="needs-attention"&&f.sentiment==="needs-attention";return g&&p}),d=[{id:"all",label:"Toutes les personnes",count:t.length},{id:"starred",label:"Favoris",count:t.filter(f=>f.starred).length},{id:"needs-attention",label:"Nécessite attention",count:t.filter(f=>f.sentiment==="needs-attention").length}];return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Vos Personnes"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gérez votre réseau personnel"})]}),o.jsxs("button",{onClick:n,className:"flex items-center space-x-2 bg-sage-600 hover:bg-sage-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25",children:[o.jsx(Qu,{className:"w-4 h-4"}),o.jsx("span",{children:"Ajouter une personne"})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(iu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-400 w-5 h-5"}),o.jsx("input",{type:"text",placeholder:"Rechercher des personnes ou des tags...",value:s,onChange:f=>i(f.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent transition-all"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(q1,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),o.jsx("select",{value:a,onChange:f=>c(f.target.value),className:"bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:d.map(f=>o.jsxs("option",{value:f.id,children:[f.label," (",f.count,")"]},f.id))})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(f=>o.jsx(hP,{contact:f,onClick:()=>e(f),onToggleStar:r},f.id))}),u.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(iu,{className:"w-8 h-8 text-gray-500 dark:text-gray-500"})}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aucune personne trouvée"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:s?"Essayez d'ajuster vos termes de recherche":"Commencez à ajouter des personnes à votre réseau"})]})]})},mP=({orders:t,customers:e,products:r,onCreateOrder:n,onViewOrder:s,onEditOrder:i,onValidateOrder:a,onValidatePayment:c,onShowReceipt:u})=>{const[d,f]=L.useState(""),[g,p]=L.useState("all"),_=t.filter(N=>{const O=N.customerName.toLowerCase().includes(d.toLowerCase())||N.id.toLowerCase().includes(d.toLowerCase()),F=g==="all"||N.status===g;return O&&F}),A=N=>{switch(N){case"pending":return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-300";case"confirmed":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"delivered":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},P=N=>{switch(N){case"paid":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300";case"pending":return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-300";case"overdue":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},S=N=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(N),w=N=>new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"short",year:"numeric"}).format(N),k={pending:"En attente",confirmed:"Confirmée",delivered:"Livrée",cancelled:"Annulée"},I={paid:"Payé",pending:"En attente",overdue:"En retard"};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Commandes"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gérez toutes vos commandes de kéfir"})]}),o.jsxs("button",{onClick:n,className:"flex items-center space-x-2 bg-sage-600 hover:bg-sage-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25",children:[o.jsx(Qu,{className:"w-4 h-4"}),o.jsx("span",{children:"Nouvelle commande"})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(iu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:"text",placeholder:"Rechercher par client ou numéro de commande...",value:d,onChange:N=>f(N.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(q1,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),o.jsxs("select",{value:g,onChange:N=>p(N.target.value),className:"bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:[o.jsx("option",{value:"all",children:"Tous les statuts"}),o.jsx("option",{value:"pending",children:"En attente"}),o.jsx("option",{value:"confirmed",children:"Confirmées"}),o.jsx("option",{value:"delivered",children:"Livrées"}),o.jsx("option",{value:"cancelled",children:"Annulées"})]})]})]}),o.jsx("div",{className:"space-y-4",children:_.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(xt,{className:"w-8 h-8 text-gray-500"})}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aucune commande trouvée"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:d?"Essayez d'ajuster vos critères de recherche":"Créez votre première commande"})]}):_.map(N=>o.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all duration-200",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-start space-x-4",children:[o.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-sage-600 to-sage-700 rounded-full flex items-center justify-center text-white font-semibold",children:o.jsx(xt,{className:"w-6 h-6"})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Commande #",N.id]}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:N.customerName}),o.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:[w(N.orderDate),N.deliveryDate&&` • Livraison: ${w(N.deliveryDate)}`]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${A(N.status)}`,children:k[N.status]}),o.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${P(N.paymentStatus)}`,children:I[N.paymentStatus]})]})]}),o.jsx("div",{className:"mb-4",children:o.jsx("div",{className:"flex flex-wrap gap-2",children:(Array.isArray(N.items)?N.items:[]).map((O,F)=>o.jsxs("span",{className:"px-3 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-sm rounded-full border border-sage-200 dark:border-sage-600/30",children:[O.quantity,"x ",O.productName]},F))})}),o.jsx("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(au,{className:"w-4 h-4 text-gray-500 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:N.deliveryAddress.street}),o.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:[N.deliveryAddress.postalCode," ",N.deliveryAddress.city]})]})]})}),o.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-800",children:[o.jsxs("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Total: ",S(N.totalAmount)]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("button",{onClick:()=>s(N),className:"flex items-center space-x-1 px-3 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:[o.jsx(kf,{className:"w-4 h-4"}),o.jsx("span",{children:"Voir"})]}),N.status==="pending"&&o.jsxs("button",{onClick:()=>a(N),className:"flex items-center space-x-1 px-3 py-2 text-emerald-600 dark:text-emerald-400 hover:text-emerald-700 dark:hover:text-emerald-300 hover:bg-emerald-100 dark:hover:bg-emerald-600/20 rounded-lg transition-colors",children:[o.jsx(No,{className:"w-4 h-4"}),o.jsx("span",{children:"Valider"})]}),(N.status==="confirmed"||N.status==="delivered")&&N.paymentStatus==="pending"&&o.jsxs("button",{onClick:()=>c(N),className:"flex items-center space-x-1 px-3 py-2 text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-600/20 rounded-lg transition-colors",children:[o.jsx(bs,{className:"w-4 h-4"}),o.jsx("span",{children:"Paiement reçu"})]}),o.jsxs("button",{onClick:()=>i(N),className:"flex items-center space-x-1 px-3 py-2 text-sage-600 dark:text-sage-400 hover:text-sage-700 dark:hover:text-sage-300 hover:bg-sage-100 dark:hover:bg-sage-600/20 rounded-lg transition-colors",children:[o.jsx(W1,{className:"w-4 h-4"}),o.jsx("span",{children:"Modifier"})]}),o.jsxs("button",{onClick:()=>u(N),className:"flex items-center space-x-1 px-3 py-2 text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-600/20 rounded-lg transition-colors",children:[o.jsx(xt,{className:"w-4 h-4"}),o.jsx("span",{children:"Reçu"})]})]})]}),N.notes&&o.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl",children:o.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[o.jsx("strong",{children:"Note:"})," ",N.notes]})})]},N.id))})]})},pP=({products:t,onAddProduct:e,onEditProduct:r,onDeleteProduct:n})=>{const[s,i]=L.useState(""),[a,c]=L.useState("all"),u=t.filter(_=>{const A=_.name.toLowerCase().includes(s.toLowerCase())||_.description.toLowerCase().includes(s.toLowerCase()),P=a==="all"||_.type===a;return A&&P}),d=_=>{switch(_){case"milk-kefir":return"Kéfir de lait";case"water-kefir":return"Kéfir d'eau";case"kombucha":return"Kombucha";case"cheese":return"Fromages";case"fermented-vegetables":return"Légumes fermentés";case"accessories":return"Accessoires";default:return _.charAt(0).toUpperCase()+_.slice(1)}},f=_=>{switch(_){case"milk-kefir":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"water-kefir":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300";case"kombucha":return"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300";case"cheese":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300";case"fermented-vegetables":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"accessories":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},g=_=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(_),p=t.filter(_=>_.inStock<=_.minStock);return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Produits"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gérez votre catalogue de kéfir"})]}),o.jsxs("button",{onClick:e,className:"flex items-center space-x-2 bg-sage-600 hover:bg-sage-700 text-white px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25",children:[o.jsx(Qu,{className:"w-4 h-4"}),o.jsx("span",{children:"Nouveau produit"})]})]}),p.length>0&&o.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-2xl p-4",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(Vs,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"}),o.jsxs("h3",{className:"font-medium text-amber-800 dark:text-amber-300",children:["Alerte stock faible (",p.length," produits)"]})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(_=>o.jsxs("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 dark:bg-amber-800/30 dark:text-amber-300 text-sm rounded-full",children:[_.name," (",_.inStock," restants)"]},_.id))})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(iu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx("input",{type:"text",placeholder:"Rechercher des produits...",value:s,onChange:_=>i(_.target.value),className:"w-full pl-10 pr-4 py-3 bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("select",{value:a,onChange:_=>c(_.target.value),className:"bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:[o.jsx("option",{value:"all",children:"Tous les types"}),o.jsx("option",{value:"milk-kefir",children:"Kéfir de lait"}),o.jsx("option",{value:"water-kefir",children:"Kéfir d'eau"}),o.jsx("option",{value:"kombucha",children:"Kombucha"}),o.jsx("option",{value:"cheese",children:"Fromages"}),o.jsx("option",{value:"fermented-vegetables",children:"Légumes fermentés"}),o.jsx("option",{value:"accessories",children:"Accessoires"})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.length===0?o.jsxs("div",{className:"col-span-full text-center py-12",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(xt,{className:"w-8 h-8 text-gray-500"})}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aucun produit trouvé"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:s?"Essayez d'ajuster vos critères de recherche":"Ajoutez votre premier produit"})]}):u.map(_=>o.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all duration-200 hover:scale-[1.02] hover:shadow-lg",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-sage-600 to-sage-700 rounded-full flex items-center justify-center text-white font-semibold",children:o.jsx(xt,{className:"w-6 h-6"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-lg text-gray-900 dark:text-white",children:_.name}),o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f(_.type)}`,children:d(_.type)})]})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("button",{onClick:()=>r(_),className:"p-2 text-gray-500 hover:text-sage-600 dark:hover:text-sage-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:o.jsx(W1,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>n(_.id),className:"p-2 text-gray-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:o.jsx(G1,{className:"w-4 h-4"})})]})]}),o.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-2",children:[g(_.price)," / ",_.unit==="liter"?"litre":_.unit==="piece"?"pièce":_.unit]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Prix"}),o.jsxs("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[g(_.price)," / ",_.unit==="liter"?"litre":_.unit==="piece"?"pièce":_.unit]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Stock"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:`font-medium ${_.inStock<=_.minStock?"text-red-600 dark:text-red-400":"text-gray-900 dark:text-white"}`,children:_.inStock}),_.inStock<=_.minStock&&o.jsx(Vs,{className:"w-4 h-4 text-red-500"})]})]}),o.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:o.jsx("div",{className:`h-2 rounded-full transition-all ${_.inStock<=_.minStock?"bg-red-500":_.inStock<=_.minStock*2?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${Math.min(_.inStock/(_.minStock*3)*100,100)}%`}})}),o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:["Stock minimum: ",_.minStock]})]})]},_.id))})]})},gP=({notes:t,contacts:e})=>{const r=u=>{const d=e.find(f=>f.id===u);return(d==null?void 0:d.name)||"Contact inconnu"},n=u=>{switch(u){case"appel":return Xo;case"email":return Ms;case"rencontre":return xp;default:return bf}},s=u=>{switch(u){case"appel":return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-500/20";case"email":return"text-purple-600 bg-purple-100 dark:text-purple-400 dark:bg-purple-500/20";case"rencontre":return"text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-500/20";default:return"text-sage-600 bg-sage-100 dark:text-sage-400 dark:bg-sage-500/20"}},i=u=>{switch(u){case"positive":return"border-l-emerald-500";case"needs-attention":return"border-l-amber-500";default:return"border-l-gray-400 dark:border-l-gray-500"}},a=u=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}).format(u),c=[...t].sort((u,d)=>d.date.getTime()-u.date.getTime());return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Fil de mémoire"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Votre historique d'interactions et notes"})]}),o.jsx("div",{className:"space-y-6",children:c.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(bf,{className:"w-8 h-8 text-gray-500 dark:text-gray-500"})}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Aucune mémoire pour le moment"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Commencez à ajouter des notes sur vos interactions pour construire votre fil de mémoire"})]}):c.map((u,d)=>{const f=n(u.type),g=s(u.type),p=i(u.sentiment);return o.jsxs("div",{className:`relative bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-gray-200 dark:border-gray-800 rounded-2xl p-6 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-all duration-300 border-l-4 ${p}`,children:[d<c.length-1&&o.jsx("div",{className:"absolute left-8 -bottom-6 w-px h-6 bg-gray-300 dark:bg-gray-700"}),o.jsxs("div",{className:"flex items-start space-x-4",children:[o.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${g}`,children:o.jsx(f,{className:"w-5 h-5"})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:r(u.contactId)}),o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[o.jsx("span",{className:"capitalize",children:u.type}),o.jsx("span",{children:"•"}),o.jsx("span",{children:a(u.date)})]})]}),o.jsx("div",{className:`w-3 h-3 rounded-full ${u.sentiment==="positive"?"bg-emerald-500":u.sentiment==="needs-attention"?"bg-amber-500":"bg-gray-400 dark:bg-gray-500"}`})]}),o.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed mb-4",children:u.content}),u.tags.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2",children:u.tags.map(_=>o.jsx("span",{className:"px-2 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-xs rounded-full border border-sage-200 dark:border-sage-600/30",children:_},_))})]})]})]},u.id)})})]})},yP=({isOpen:t,onClose:e,contacts:r,onSave:n})=>{const{currentUser:s}=un(),[i,a]=L.useState(""),[c,u]=L.useState(""),[d,f]=L.useState("note"),[g,p]=L.useState("neutral"),[_,A]=L.useState([]),[P,S]=L.useState(""),[w,k]=L.useState(!1),I=async()=>{if(!i||!c.trim()||!s)return;k(!0);const x={contactId:i,content:c.trim(),date:new Date,tags:_,sentiment:g,type:d,userId:s.uid,createdAt:new Date};try{await n(x),a(""),u(""),f("note"),p("neutral"),A([]),S(""),k(!1),e()}catch(y){console.error("Erreur lors de la sauvegarde de la note:",y),k(!1),alert("Erreur lors de la sauvegarde. Veuillez réessayer.")}},N=()=>{P.trim()&&!_.includes(P.trim())&&(A([..._,P.trim()]),S(""))},O=x=>{A(_.filter(y=>y!==x))},F=[{value:"positive",icon:JR,color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-100 dark:bg-emerald-500/20"},{value:"neutral",icon:WR,color:"text-gray-600 dark:text-gray-400",bgColor:"bg-gray-100 dark:bg-gray-500/20"},{value:"needs-attention",icon:Vs,color:"text-amber-600 dark:text-amber-400",bgColor:"bg-amber-100 dark:bg-amber-500/20"}];return t?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Ajouter une nouvelle note"}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Personne"}),o.jsxs("select",{value:i,onChange:x=>a(x.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"Sélectionner une personne..."}),r.map(x=>o.jsx("option",{value:x.id,children:x.name},x.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type d'interaction"}),o.jsx("div",{className:"grid grid-cols-4 gap-2",children:["note","appel","email","rencontre"].map(x=>o.jsx("button",{onClick:()=>f(x),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${d===x?"bg-sage-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,children:x.charAt(0).toUpperCase()+x.slice(1)},x))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contenu de la note"}),o.jsx("textarea",{value:c,onChange:x=>u(x.target.value),placeholder:"Que s'est-il passé ? Comment ça s'est déroulé ? Des détails importants à retenir...",rows:6,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent resize-none"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Comment vous êtes-vous senti ?"}),o.jsx("div",{className:"flex space-x-2",children:F.map(x=>{const y=x.icon;return o.jsxs("button",{onClick:()=>p(x.value),className:`flex items-center space-x-2 px-4 py-3 rounded-xl transition-all ${g===x.value?`${x.bgColor} ${x.color} border border-current`:"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700"}`,children:[o.jsx(y,{className:"w-5 h-5"}),o.jsx("span",{className:"capitalize",children:x.value==="positive"?"Positif":x.value==="needs-attention"?"Nécessite attention":"Neutre"})]},x.value)})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Tags"}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:_.map(x=>o.jsxs("span",{className:"flex items-center space-x-1 px-3 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-sm rounded-full border border-sage-200 dark:border-sage-600/30",children:[o.jsx("span",{children:x}),o.jsx("button",{onClick:()=>O(x),className:"hover:text-sage-600 dark:hover:text-sage-200",children:o.jsx(pt,{className:"w-3 h-3"})})]},x))}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("input",{type:"text",value:P,onChange:x=>S(x.target.value),onKeyPress:x=>x.key==="Enter"&&N(),placeholder:"Ajouter un tag...",className:"flex-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}),o.jsxs("button",{onClick:N,className:"px-4 py-2 bg-sage-600 hover:bg-sage-700 text-white rounded-lg transition-colors flex items-center space-x-1",children:[o.jsx(yp,{className:"w-4 h-4"}),o.jsx("span",{children:"Ajouter"})]})]})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:I,disabled:!i||!c.trim()||w,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!i||!c.trim()||w?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[o.jsx(ea,{className:`w-4 h-4 ${w?"animate-pulse":""}`}),o.jsx("span",{children:w?"Enregistrement...":"Enregistrer la note"})]})]})]})}):null},xP=({isOpen:t,onClose:e,onSave:r})=>{const{currentUser:n}=un(),[s,i]=L.useState({name:"",email:"",phone:"",relationship:"",metAt:"",sentiment:"neutral"}),[a,c]=L.useState([]),[u,d]=L.useState(""),[f,g]=L.useState(!1),[p,_]=L.useState(!1),A=(N,O)=>{i(F=>({...F,[N]:O}))},P=()=>{u.trim()&&!a.includes(u.trim())&&(c([...a,u.trim()]),d(""))},S=N=>{c(a.filter(O=>O!==N))},w=async()=>{if(!s.name.trim()||!n)return;_(!0);const N={name:s.name.trim(),email:s.email.trim()||void 0,phone:s.phone.trim()||void 0,relationship:s.relationship.trim()||"Contact",metAt:s.metAt.trim()||void 0,sentiment:s.sentiment,tags:a,starred:f,lastContact:void 0,nextReminder:void 0,userId:n.uid,createdAt:new Date,totalSpent:0,averageOrderValue:0,orderFrequency:"monthly",preferredProducts:[],deliveryPreferences:{preferredDay:"saturday",preferredTime:"morning",frequency:"weekly"},customerStatus:"active"};try{await r(N),i({name:"",email:"",phone:"",relationship:"",metAt:"",sentiment:"neutral"}),c([]),d(""),g(!1),_(!1),e()}catch(O){console.error("Erreur lors de la sauvegarde du contact:",O),_(!1),alert("Erreur lors de la sauvegarde. Veuillez réessayer.")}},k=["Ami proche","Ami","Collègue","Ex-collègue","Client","Fournisseur","Mentor","Famille","Voisin","Contact professionnel","Partenaire"],I=["ami","famille","collègue","client","mentor","créatif","tech","startup","designer","développeur","manager","entrepreneur"];return t?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Ajouter une nouvelle personne"}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(ta,{className:"w-4 h-4 inline mr-1"}),"Nom complet *"]}),o.jsx("input",{type:"text",value:s.name,onChange:N=>A("name",N.target.value),placeholder:"Jean Dupont",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(H1,{className:"w-4 h-4 inline mr-1"}),"Relation"]}),o.jsx("input",{type:"text",value:s.relationship,onChange:N=>A("relationship",N.target.value),placeholder:"Ami, Collègue, Client...",list:"relationship-suggestions",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}),o.jsx("datalist",{id:"relationship-suggestions",children:k.map(N=>o.jsx("option",{value:N},N))})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(Ms,{className:"w-4 h-4 inline mr-1"}),"Email"]}),o.jsx("input",{type:"email",value:s.email,onChange:N=>A("email",N.target.value),placeholder:"jean@example.com",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(Xo,{className:"w-4 h-4 inline mr-1"}),"Téléphone"]}),o.jsx("input",{type:"tel",value:s.phone,onChange:N=>A("phone",N.target.value),placeholder:"+261 32 12 345 67",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(Gu,{className:"w-4 h-4 inline mr-1"}),"Où vous vous êtes rencontrés"]}),o.jsx("input",{type:"text",value:s.metAt,onChange:N=>A("metAt",N.target.value),placeholder:"Conférence, travail, ami commun...",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Première impression"}),o.jsx("div",{className:"flex space-x-2",children:[{value:"positive",label:"Positive",color:"text-emerald-600 bg-emerald-100 dark:text-emerald-400 dark:bg-emerald-500/20"},{value:"neutral",label:"Neutre",color:"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-500/20"},{value:"needs-attention",label:"À revoir",color:"text-amber-600 bg-amber-100 dark:text-amber-400 dark:bg-amber-500/20"}].map(N=>o.jsx("button",{onClick:()=>A("sentiment",N.value),className:`px-4 py-2 rounded-xl transition-all ${s.sentiment===N.value?`${N.color} border border-current`:"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700"}`,children:N.label},N.value))})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(yp,{className:"w-4 h-4 inline mr-1"}),"Tags"]}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:a.map(N=>o.jsxs("span",{className:"flex items-center space-x-1 px-3 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-sm rounded-full border border-sage-200 dark:border-sage-600/30",children:[o.jsx("span",{children:N}),o.jsx("button",{onClick:()=>S(N),className:"hover:text-sage-600 dark:hover:text-sage-200",children:o.jsx(pt,{className:"w-3 h-3"})})]},N))}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("input",{type:"text",value:u,onChange:N=>d(N.target.value),onKeyPress:N=>N.key==="Enter"&&P(),placeholder:"Ajouter un tag...",list:"tag-suggestions",className:"flex-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}),o.jsx("datalist",{id:"tag-suggestions",children:I.map(N=>o.jsx("option",{value:N},N))}),o.jsx("button",{onClick:P,className:"px-4 py-2 bg-sage-600 hover:bg-sage-700 text-white rounded-lg transition-colors",children:"Ajouter"})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",id:"starred",checked:f,onChange:N=>g(N.target.checked),className:"w-4 h-4 text-sage-600 bg-gray-100 border-gray-300 rounded focus:ring-sage-500 dark:focus:ring-sage-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),o.jsx("label",{htmlFor:"starred",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Marquer comme favori"})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:w,disabled:!s.name.trim()||p||!n,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!s.name.trim()||p||!n?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[o.jsx(ea,{className:`w-4 h-4 ${p?"animate-pulse":""}`}),o.jsx("span",{children:p?"Enregistrement...":"Ajouter la personne"})]})]})]})}):null},vP=({isOpen:t,onClose:e,contact:r,onSave:n})=>{const[s,i]=L.useState({name:"",email:"",phone:"",relationship:"",metAt:"",sentiment:"neutral",customerStatus:"active",orderFrequency:"monthly",paymentMethod:"cash"}),[a,c]=L.useState({street:"",city:"",postalCode:"",country:"Madagascar",deliveryInstructions:""}),[u,d]=L.useState({preferredDay:"saturday",preferredTime:"morning",frequency:"weekly"}),[f,g]=L.useState([]),[p,_]=L.useState(""),[A,P]=L.useState(!1),[S,w]=L.useState(!1);L.useEffect(()=>{var x,y,E;r&&(i({name:r.name,email:r.email||"",phone:r.phone||"",relationship:r.relationship,metAt:r.metAt||"",sentiment:r.sentiment,customerStatus:r.customerStatus,orderFrequency:r.orderFrequency,paymentMethod:r.paymentMethod||"cash"}),c(r.address||{street:"",city:"",postalCode:"",country:"Madagascar",deliveryInstructions:""}),d({preferredDay:((x=r.deliveryPreferences)==null?void 0:x.preferredDay)||"saturday",preferredTime:((y=r.deliveryPreferences)==null?void 0:y.preferredTime)||"morning",frequency:((E=r.deliveryPreferences)==null?void 0:E.frequency)||"weekly"}),g(r.tags),P(r.starred))},[r]);const k=(x,y)=>{i(E=>({...E,[x]:y}))},I=(x,y)=>{c(E=>({...E,[x]:y}))},N=()=>{p.trim()&&!f.includes(p.trim())&&(g([...f,p.trim()]),_(""))},O=x=>{g(f.filter(y=>y!==x))},F=async()=>{var y;if(!r||!s.name.trim())return;w(!0);const x={...r,name:s.name.trim(),email:s.email.trim()||void 0,phone:s.phone.trim()||void 0,relationship:s.relationship.trim()||"Contact",metAt:s.metAt.trim()||void 0,sentiment:s.sentiment,customerStatus:s.customerStatus,orderFrequency:s.orderFrequency,paymentMethod:s.paymentMethod,address:a.street?a:void 0,deliveryPreferences:{...u,nextDelivery:(y=r.deliveryPreferences)==null?void 0:y.nextDelivery},tags:f,starred:A};await new Promise(E=>setTimeout(E,1e3)),n(x),w(!1),e()};return!t||!r?null:o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Modifier le client"}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(ta,{className:"w-4 h-4 inline mr-1"}),"Nom complet *"]}),o.jsx("input",{type:"text",value:s.name,onChange:x=>k("name",x.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(H1,{className:"w-4 h-4 inline mr-1"}),"Relation"]}),o.jsx("input",{type:"text",value:s.relationship,onChange:x=>k("relationship",x.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(Ms,{className:"w-4 h-4 inline mr-1"}),"Email"]}),o.jsx("input",{type:"email",value:s.email,onChange:x=>k("email",x.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(Xo,{className:"w-4 h-4 inline mr-1"}),"Téléphone"]}),o.jsx("input",{type:"tel",value:s.phone,onChange:x=>k("phone",x.target.value),placeholder:"+261 32 12 345 67",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Adresse de livraison"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(Gu,{className:"w-4 h-4 inline mr-1"}),"Rue"]}),o.jsx("input",{type:"text",value:a.street,onChange:x=>I("street",x.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ville"}),o.jsx("input",{type:"text",value:a.city,onChange:x=>I("city",x.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Code postal"}),o.jsx("input",{type:"text",value:a.postalCode,onChange:x=>I("postalCode",x.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Instructions de livraison"}),o.jsx("textarea",{value:a.deliveryInstructions,onChange:x=>I("deliveryInstructions",x.target.value),rows:2,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent resize-none"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Statut client"}),o.jsxs("select",{value:s.customerStatus,onChange:x=>k("customerStatus",x.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500",children:[o.jsx("option",{value:"active",children:"Actif"}),o.jsx("option",{value:"inactive",children:"Inactif"}),o.jsx("option",{value:"prospect",children:"Prospect"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Fréquence de commande"}),o.jsxs("select",{value:s.orderFrequency,onChange:x=>k("orderFrequency",x.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500",children:[o.jsx("option",{value:"weekly",children:"Hebdomadaire"}),o.jsx("option",{value:"bi-weekly",children:"Bi-hebdomadaire"}),o.jsx("option",{value:"monthly",children:"Mensuelle"}),o.jsx("option",{value:"occasional",children:"Occasionnelle"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Méthode de paiement"}),o.jsxs("select",{value:s.paymentMethod,onChange:x=>k("paymentMethod",x.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500",children:[o.jsx("option",{value:"cash",children:"Espèces"}),o.jsx("option",{value:"mvola",children:"MVola"}),o.jsx("option",{value:"orange-money",children:"Orange Money"}),o.jsx("option",{value:"airtel-money",children:"Airtel Money"}),o.jsx("option",{value:"transfer",children:"Virement"}),o.jsx("option",{value:"check",children:"Chèque"})]})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(yp,{className:"w-4 h-4 inline mr-1"}),"Tags"]}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:f.map(x=>o.jsxs("span",{className:"flex items-center space-x-1 px-3 py-1 bg-sage-100 text-sage-700 dark:bg-sage-600/20 dark:text-sage-300 text-sm rounded-full border border-sage-200 dark:border-sage-600/30",children:[o.jsx("span",{children:x}),o.jsx("button",{onClick:()=>O(x),className:"hover:text-sage-600 dark:hover:text-sage-200",children:o.jsx(pt,{className:"w-3 h-3"})})]},x))}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("input",{type:"text",value:p,onChange:x=>_(x.target.value),onKeyPress:x=>x.key==="Enter"&&N(),placeholder:"Ajouter un tag...",className:"flex-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500"}),o.jsx("button",{onClick:N,className:"px-4 py-2 bg-sage-600 hover:bg-sage-700 text-white rounded-lg transition-colors",children:"Ajouter"})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("input",{type:"checkbox",id:"starred",checked:A,onChange:x=>P(x.target.checked),className:"w-4 h-4 text-sage-600 bg-gray-100 border-gray-300 rounded focus:ring-sage-500"}),o.jsx("label",{htmlFor:"starred",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Marquer comme favori"})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:F,disabled:!s.name.trim()||S,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!s.name.trim()||S?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[o.jsx(ea,{className:`w-4 h-4 ${S?"animate-pulse":""}`}),o.jsx("span",{children:S?"Enregistrement...":"Enregistrer les modifications"})]})]})]})})},_P=({isOpen:t,onClose:e,order:r})=>{if(!t||!r)return null;const n=d=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(d),s=d=>new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(d),i=d=>{switch(d){case"pending":return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-300";case"confirmed":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"delivered":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},a=d=>{switch(d){case"paid":return"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300";case"pending":return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-300";case"overdue":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},c={pending:"En attente",confirmed:"Confirmée",delivered:"Livrée",cancelled:"Annulée"},u={paid:"Payé",pending:"En attente",overdue:"En retard"};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-sage-600 to-sage-700 rounded-full flex items-center justify-center text-white",children:o.jsx(xt,{className:"w-5 h-5"})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Commande #",r.id]}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:r.customerName})]})]}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"flex flex-wrap gap-3",children:[o.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${i(r.status)}`,children:c[r.status]}),o.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${a(r.paymentStatus)}`,children:u[r.paymentStatus]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Yo,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Date de commande"}),o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s(r.orderDate)})]})]}),r.deliveryDate&&o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(au,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Date de livraison"}),o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s(r.deliveryDate)})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(bs,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Méthode de paiement"}),o.jsx("p",{className:"font-medium text-gray-900 dark:text-white capitalize",children:r.paymentMethod})]})]})]}),o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(Gu,{className:"w-5 h-5 text-gray-500 mt-1"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Adresse de livraison"}),o.jsxs("div",{className:"font-medium text-gray-900 dark:text-white",children:[o.jsx("p",{children:r.deliveryAddress.street}),o.jsxs("p",{children:[r.deliveryAddress.postalCode," ",r.deliveryAddress.city]}),o.jsx("p",{children:r.deliveryAddress.country}),r.deliveryAddress.deliveryInstructions&&o.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Instructions: ",r.deliveryAddress.deliveryInstructions]})]})]})]})})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Articles commandés"}),o.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-100 dark:bg-gray-800",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 dark:text-gray-300",children:"Produit"}),o.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-700 dark:text-gray-300",children:"Quantité"}),o.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700 dark:text-gray-300",children:"Prix unitaire"}),o.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:(Array.isArray(r.items)?r.items:[]).map((d,f)=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-4 py-3 text-gray-900 dark:text-white",children:d.productName}),o.jsx("td",{className:"px-4 py-3 text-center text-gray-900 dark:text-white",children:d.quantity}),o.jsx("td",{className:"px-4 py-3 text-right text-gray-900 dark:text-white",children:n(d.unitPrice)}),o.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-900 dark:text-white",children:n(d.totalPrice)})]},f))}),o.jsx("tfoot",{className:"bg-gray-100 dark:bg-gray-800",children:o.jsxs("tr",{children:[o.jsx("td",{colSpan:3,className:"px-4 py-3 text-right font-semibold text-gray-900 dark:text-white",children:"Total général"}),o.jsx("td",{className:"px-4 py-3 text-right font-bold text-lg text-sage-600 dark:text-sage-400",children:n(r.totalAmount)})]})})]})})})]}),r.notes&&o.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl",children:o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx($1,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-1",children:"Notes"}),o.jsx("p",{className:"text-blue-700 dark:text-blue-400",children:r.notes})]})]})})]})]})})},wP=({isOpen:t,onClose:e,vendorInfo:r,onSave:n})=>{const[s,i]=L.useState(r),a=u=>{u.preventDefault(),n(s),e()},c=(u,d)=>{i(f=>({...f,[u]:d}))};return t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Paramètres de l'entreprise"}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:o.jsx(pt,{className:"w-6 h-6"})})]}),o.jsxs("form",{onSubmit:a,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o.jsx(LR,{className:"w-4 h-4 inline mr-2"}),"Nom de l'entreprise"]}),o.jsx("input",{type:"text",value:s.name,onChange:u=>c("name",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o.jsx(Gu,{className:"w-4 h-4 inline mr-2"}),"Adresse"]}),o.jsx("textarea",{value:s.address,onChange:u=>c("address",u.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o.jsx(Xo,{className:"w-4 h-4 inline mr-2"}),"Téléphone"]}),o.jsx("input",{type:"tel",value:s.phone,onChange:u=>c("phone",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o.jsx(Ms,{className:"w-4 h-4 inline mr-2"}),"Email"]}),o.jsx("input",{type:"email",value:s.email,onChange:u=>c("email",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o.jsx(gp,{className:"w-4 h-4 inline mr-2"}),"NIF - Facultatif"]}),o.jsx("input",{type:"text",value:s.nif||"",onChange:u=>c("nif",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Numéro d'identification fiscale (optionnel)"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[o.jsx($1,{className:"w-4 h-4 inline mr-2"}),"STAT - Facultatif"]}),o.jsx("input",{type:"text",value:s.stat||"",onChange:u=>c("stat",u.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Numéro statistique (optionnel)"})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Annuler"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Enregistrer"})]})]})]})}):null},kP=({isOpen:t,onClose:e,order:r,vendorInfo:n})=>{if(!t||!r)return null;const s=u=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(u),i=u=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(u),a=()=>{window.print()},c=()=>{console.log("Téléchargement du reçu pour la commande",r.id)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800 print:hidden",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Reçu de vente"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:a,className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",title:"Imprimer",children:o.jsx(QR,{className:"w-5 h-5"})}),o.jsx("button",{onClick:c,className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",title:"Télécharger PDF",children:o.jsx(B1,{className:"w-5 h-5"})}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})]}),o.jsxs("div",{className:"p-8 print:p-4",children:[o.jsxs("div",{className:"text-center mb-8 print:mb-6",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white print:text-black",children:n.name}),o.jsxs("div",{className:"mt-2 text-gray-600 dark:text-gray-400 print:text-gray-700",children:[o.jsx("p",{children:n.address}),o.jsxs("p",{children:["Tél: ",n.phone," | Email: ",n.email]}),o.jsxs("p",{children:["NIF: ",n.nif," | STAT: ",n.stat]})]})]}),o.jsx("div",{className:"border-t border-b border-gray-200 dark:border-gray-700 print:border-gray-300 py-4 mb-6",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white print:text-black mb-2",children:[o.jsx(xt,{className:"w-4 h-4 inline mr-1"}),"Reçu N°"]}),o.jsxs("p",{className:"text-gray-700 dark:text-gray-300 print:text-gray-700",children:["#",r.id]})]}),o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white print:text-black mb-2",children:[o.jsx(Yo,{className:"w-4 h-4 inline mr-1"}),"Date"]}),o.jsx("p",{className:"text-gray-700 dark:text-gray-300 print:text-gray-700",children:i(r.orderDate)})]})]})}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white print:text-black mb-2",children:[o.jsx(ta,{className:"w-4 h-4 inline mr-1"}),"Client"]}),o.jsxs("div",{className:"text-gray-700 dark:text-gray-300 print:text-gray-700",children:[o.jsx("p",{className:"font-medium",children:r.customerName}),o.jsxs("div",{className:"text-sm mt-1",children:[o.jsx("p",{children:r.deliveryAddress.street}),o.jsxs("p",{children:[r.deliveryAddress.postalCode," ",r.deliveryAddress.city]}),o.jsx("p",{children:r.deliveryAddress.country})]})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white print:text-black mb-4",children:"Détail de la commande"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700 print:border-gray-300",children:[o.jsx("th",{className:"text-left py-2 text-gray-900 dark:text-white print:text-black font-medium",children:"Article"}),o.jsx("th",{className:"text-center py-2 text-gray-900 dark:text-white print:text-black font-medium",children:"Qté"}),o.jsx("th",{className:"text-right py-2 text-gray-900 dark:text-white print:text-black font-medium",children:"Prix unit."}),o.jsx("th",{className:"text-right py-2 text-gray-900 dark:text-white print:text-black font-medium",children:"Total"})]})}),o.jsx("tbody",{children:(Array.isArray(r.items)?r.items:[]).map((u,d)=>o.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800 print:border-gray-200",children:[o.jsx("td",{className:"py-3 text-gray-700 dark:text-gray-300 print:text-gray-700",children:u.productName}),o.jsx("td",{className:"py-3 text-center text-gray-700 dark:text-gray-300 print:text-gray-700",children:u.quantity}),o.jsx("td",{className:"py-3 text-right text-gray-700 dark:text-gray-300 print:text-gray-700",children:s(u.unitPrice)}),o.jsx("td",{className:"py-3 text-right font-medium text-gray-900 dark:text-white print:text-black",children:s(u.totalPrice)})]},d))}),o.jsx("tfoot",{children:o.jsxs("tr",{className:"border-t-2 border-gray-300 dark:border-gray-600 print:border-gray-400",children:[o.jsx("td",{colSpan:3,className:"py-4 text-right font-bold text-gray-900 dark:text-white print:text-black text-lg",children:"TOTAL GÉNÉRAL"}),o.jsx("td",{className:"py-4 text-right font-bold text-xl text-sage-600 dark:text-sage-400 print:text-black",children:s(r.totalAmount)})]})})]})})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-900 dark:text-white print:text-black",children:"Méthode de paiement:"}),o.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300 print:text-gray-700",children:r.paymentMethod==="mvola"?"MVola":r.paymentMethod==="orange-money"?"Orange Money":r.paymentMethod==="airtel-money"?"Airtel Money":r.paymentMethod==="cash"?"Espèces":r.paymentMethod==="transfer"?"Virement":r.paymentMethod==="check"?"Chèque":r.paymentMethod})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium text-gray-900 dark:text-white print:text-black",children:"Statut:"}),o.jsx("span",{className:"ml-2 text-gray-700 dark:text-gray-300 print:text-gray-700",children:r.paymentStatus==="paid"?"Payé":r.paymentStatus==="pending"?"En attente":"En retard"})]})]})}),r.notes&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white print:text-black mb-2",children:"Notes"}),o.jsx("p",{className:"text-gray-700 dark:text-gray-300 print:text-gray-700 text-sm bg-gray-50 dark:bg-gray-800 print:bg-gray-100 p-3 rounded-lg",children:r.notes})]}),o.jsxs("div",{className:"text-center text-sm text-gray-600 dark:text-gray-400 print:text-gray-600 border-t border-gray-200 dark:border-gray-700 print:border-gray-300 pt-4",children:[o.jsx("p",{children:"Merci pour votre confiance !"}),o.jsx("p",{className:"mt-1",children:"Ce reçu fait foi de votre achat"})]})]})]})})},bP=({isOpen:t,onClose:e,customers:r,products:n,onSave:s})=>{const{currentUser:i}=un(),[a,c]=L.useState(""),[u,d]=L.useState(""),[f,g]=L.useState("cash"),[p,_]=L.useState(""),[A,P]=L.useState([]),[S,w]=L.useState(!1),k=()=>{P([...A,{productId:"",quantity:1}])},I=(y,E,T)=>{const C=[...A];C[y]={...C[y],[E]:T},P(C)},N=y=>{P(A.filter((E,T)=>T!==y))},O=()=>A.reduce((y,E)=>{const T=n.find(C=>C.id===E.productId);return y+(T?T.price*E.quantity:0)},0),F=async()=>{if(!a||A.length===0||!u||!i)return;w(!0);const y=r.find(C=>C.id===a);if(!y)return;const E=A.map(C=>{const R=n.find(b=>b.id===C.productId);if(!R)throw new Error("Produit non trouvé");return{productId:C.productId,productName:R.name,quantity:C.quantity,unitPrice:R.price,totalPrice:R.price*C.quantity}}),T={customerId:a,customerName:y.name,orderDate:new Date,deliveryDate:new Date(u),status:"pending",items:E,totalAmount:O(),paymentStatus:"pending",paymentMethod:f,deliveryAddress:y.address||{street:"",city:"Antananarivo",postalCode:"101",country:"Madagascar"},notes:p.trim()||void 0,userId:i.uid,createdAt:new Date};try{await s(T),c(""),d(""),g("cash"),_(""),P([]),w(!1),e()}catch(C){console.error("Erreur lors de la sauvegarde de la commande:",C),w(!1),alert("Erreur lors de la sauvegarde. Veuillez réessayer.")}},x=y=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(y);return t?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Nouvelle commande"}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(ta,{className:"w-4 h-4 inline mr-1"}),"Client *"]}),o.jsxs("select",{value:a,onChange:y=>c(y.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"Sélectionner un client..."}),r.map(y=>o.jsx("option",{value:y.id,children:y.name},y.id))]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(Yo,{className:"w-4 h-4 inline mr-1"}),"Date de livraison *"]}),o.jsx("input",{type:"date",value:u,onChange:y=>d(y.target.value),min:new Date().toISOString().split("T")[0],className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(bs,{className:"w-4 h-4 inline mr-1"}),"Méthode de paiement"]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[{value:"cash",label:"Espèces"},{value:"mvola",label:"MVola"},{value:"orange-money",label:"Orange Money"},{value:"airtel-money",label:"Airtel Money"},{value:"transfer",label:"Virement"},{value:"check",label:"Chèque"}].map(y=>o.jsx("button",{onClick:()=>g(y.value),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${f===y.value?"bg-sage-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,children:y.label},y.value))})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(xt,{className:"w-4 h-4 inline mr-1"}),"Articles de la commande *"]}),o.jsx("button",{onClick:k,className:"px-3 py-1 bg-sage-600 hover:bg-sage-700 text-white text-sm rounded-lg transition-colors",children:"Ajouter un article"})]}),o.jsxs("div",{className:"space-y-3",children:[A.map((y,E)=>{var T;return o.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:[o.jsxs("select",{value:y.productId,onChange:C=>I(E,"productId",C.target.value),className:"flex-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500",children:[o.jsx("option",{value:"",children:"Sélectionner un produit..."}),n.map(C=>o.jsxs("option",{value:C.id,children:[C.name," - ",x(C.price)]},C.id))]}),o.jsx("input",{type:"number",min:"1",value:y.quantity,onChange:C=>I(E,"quantity",parseInt(C.target.value)||1),className:"w-20 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500"}),o.jsx("div",{className:"w-24 text-right text-gray-900 dark:text-white font-medium",children:y.productId?x((((T=n.find(C=>C.id===y.productId))==null?void 0:T.price)||0)*y.quantity):"-"}),o.jsx("button",{onClick:()=>N(E),className:"p-2 text-red-500 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:o.jsx(pt,{className:"w-4 h-4"})})]},E)}),A.length===0&&o.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:'Aucun article ajouté. Cliquez sur "Ajouter un article" pour commencer.'})]}),A.length>0&&o.jsx("div",{className:"mt-4 p-4 bg-sage-50 dark:bg-sage-900/20 rounded-xl",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Total"}),o.jsx("span",{className:"text-xl font-bold text-sage-600 dark:text-sage-400",children:x(O())})]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes (optionnel)"}),o.jsx("textarea",{value:p,onChange:y=>_(y.target.value),placeholder:"Instructions spéciales, remarques...",rows:3,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent resize-none"})]})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:F,disabled:!a||A.length===0||!u||S,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!a||A.length===0||!u||S?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[o.jsx(ea,{className:`w-4 h-4 ${S?"animate-pulse":""}`}),o.jsx("span",{children:S?"Création...":"Créer la commande"})]})]})]})}):null},EP=({isOpen:t,onClose:e,onSave:r})=>{const{currentUser:n}=un(),[s,i]=L.useState({name:"",type:"milk-kefir",customType:"",description:"",price:"",unit:"liter",customUnit:"",inStock:"",minStock:""}),[a,c]=L.useState(!1),[u,d]=L.useState(!1),[f,g]=L.useState(!1),p=(S,w)=>{i(k=>({...k,[S]:w}))},_=async()=>{if(!s.name.trim()||!s.price||!s.inStock||!s.minStock||!n)return;g(!0);const S=a&&s.customType.trim()?s.customType.trim():s.type,w=u&&s.customUnit.trim()?s.customUnit.trim():s.unit,k={name:s.name.trim(),type:S,description:s.description.trim(),price:parseInt(s.price),unit:w,inStock:parseInt(s.inStock),minStock:parseInt(s.minStock),userId:n.uid,createdAt:new Date};try{await r(k),i({name:"",type:"milk-kefir",customType:"",description:"",price:"",unit:"liter",customUnit:"",inStock:"",minStock:""}),c(!1),d(!1),g(!1),e()}catch(I){console.error("Erreur lors de la sauvegarde du produit:",I),g(!1),alert("Erreur lors de la sauvegarde. Veuillez réessayer.")}},A=[{value:"milk-kefir",label:"Kéfir de lait"},{value:"water-kefir",label:"Kéfir d'eau"},{value:"kombucha",label:"Kombucha"},{value:"cheese",label:"Fromages"},{value:"fermented-vegetables",label:"Légumes fermentés"},{value:"accessories",label:"Accessoires"}],P=[{value:"liter",label:"Litre"},{value:"piece",label:"Pièce"}];return t?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Nouveau produit"}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(xt,{className:"w-4 h-4 inline mr-1"}),"Nom du produit *"]}),o.jsx("input",{type:"text",value:s.name,onChange:S=>p("name",S.target.value),placeholder:"Ex: Kéfir de lait traditionnel",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type de produit *"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{type:"button",onClick:()=>c(!1),className:`px-3 py-1 text-sm rounded-lg transition-colors ${a?"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600":"bg-sage-600 text-white"}`,children:"Prédéfini"}),o.jsx("button",{type:"button",onClick:()=>c(!0),className:`px-3 py-1 text-sm rounded-lg transition-colors ${a?"bg-sage-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:"Personnalisé"})]}),a?o.jsx("input",{type:"text",value:s.customType,onChange:S=>p("customType",S.target.value),placeholder:"Ex: Yaourt fermenté, Boisson probiotique...",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}):o.jsx("select",{value:s.type,onChange:S=>p("type",S.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:A.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Unité de vente *"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{type:"button",onClick:()=>d(!1),className:`px-3 py-1 text-sm rounded-lg transition-colors ${u?"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600":"bg-sage-600 text-white"}`,children:"Prédéfini"}),o.jsx("button",{type:"button",onClick:()=>d(!0),className:`px-3 py-1 text-sm rounded-lg transition-colors ${u?"bg-sage-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:"Personnalisé"})]}),u?o.jsx("input",{type:"text",value:s.customUnit,onChange:S=>p("customUnit",S.target.value),placeholder:"Ex: bouteille, pot, sachet, kg...",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}):o.jsx("select",{value:s.unit,onChange:S=>p("unit",S.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:P.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),o.jsx("textarea",{value:s.description,onChange:S=>p("description",S.target.value),placeholder:"Description du produit, ingrédients, bienfaits...",rows:3,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent resize-none"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(z1,{className:"w-4 h-4 inline mr-1"}),"Prix (Ariary) *"]}),o.jsx("input",{type:"number",min:"0",step:"1000",value:s.price,onChange:S=>p("price",S.target.value),placeholder:"9000",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(gp,{className:"w-4 h-4 inline mr-1"}),"Stock actuel *"]}),o.jsx("input",{type:"number",min:"0",value:s.inStock,onChange:S=>p("inStock",S.target.value),placeholder:"50",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(Vs,{className:"w-4 h-4 inline mr-1"}),"Stock minimum *"]}),o.jsx("input",{type:"number",min:"0",value:s.minStock,onChange:S=>p("minStock",S.target.value),placeholder:"10",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),s.price&&o.jsx("div",{className:"p-4 bg-sage-50 dark:bg-sage-900/20 rounded-xl",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Prix de vente"}),o.jsxs("span",{className:"text-lg font-bold text-sage-600 dark:text-sage-400",children:[new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(parseInt(s.price)||0)," / ",u&&s.customUnit.trim()?s.customUnit.trim():s.unit==="liter"?"litre":"pièce"]})]})})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:_,disabled:!s.name.trim()||!s.price||!s.inStock||!s.minStock||a&&!s.customType.trim()||u&&!s.customUnit.trim()||f,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!s.name.trim()||!s.price||!s.inStock||!s.minStock||a&&!s.customType.trim()||u&&!s.customUnit.trim()||f?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[o.jsx(ea,{className:`w-4 h-4 ${f?"animate-pulse":""}`}),o.jsx("span",{children:f?"Création...":"Créer le produit"})]})]})]})}):null},TP=({isOpen:t,onClose:e,product:r,onSave:n})=>{const[s,i]=L.useState({name:"",type:"milk-kefir",customType:"",description:"",price:"",unit:"liter",customUnit:"",inStock:"",minStock:""}),[a,c]=L.useState(!1),[u,d]=L.useState(!1),[f,g]=L.useState(!1);L.useEffect(()=>{if(r){const S=!A.some(k=>k.value===r.type),w=!P.some(k=>k.value===r.unit);i({name:r.name,type:S?"milk-kefir":r.type,customType:S?r.type:"",description:r.description,price:r.price.toString(),unit:w?"liter":r.unit,customUnit:w?r.unit:"",inStock:r.inStock.toString(),minStock:r.minStock.toString()}),c(S),d(w)}},[r]);const p=(S,w)=>{i(k=>({...k,[S]:w}))},_=async()=>{if(!r||!s.name.trim()||!s.price||!s.inStock||!s.minStock)return;g(!0);const S=a&&s.customType.trim()?s.customType.trim():s.type,w=u&&s.customUnit.trim()?s.customUnit.trim():s.unit,k={...r,name:s.name.trim(),type:S,description:s.description.trim(),price:parseInt(s.price),unit:w,inStock:parseInt(s.inStock),minStock:parseInt(s.minStock)};await new Promise(I=>setTimeout(I,1e3)),n(k),g(!1),e()},A=[{value:"milk-kefir",label:"Kéfir de lait"},{value:"water-kefir",label:"Kéfir d'eau"},{value:"kombucha",label:"Kombucha"},{value:"cheese",label:"Fromages"},{value:"fermented-vegetables",label:"Légumes fermentés"},{value:"accessories",label:"Accessoires"}],P=[{value:"liter",label:"Litre"},{value:"piece",label:"Pièce"}];return!t||!r?null:o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Modifier le produit"}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(xt,{className:"w-4 h-4 inline mr-1"}),"Nom du produit *"]}),o.jsx("input",{type:"text",value:s.name,onChange:S=>p("name",S.target.value),placeholder:"Ex: Kéfir de lait traditionnel",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type de produit *"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{type:"button",onClick:()=>c(!1),className:`px-3 py-1 text-sm rounded-lg transition-colors ${a?"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600":"bg-sage-600 text-white"}`,children:"Prédéfini"}),o.jsx("button",{type:"button",onClick:()=>c(!0),className:`px-3 py-1 text-sm rounded-lg transition-colors ${a?"bg-sage-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:"Personnalisé"})]}),a?o.jsx("input",{type:"text",value:s.customType,onChange:S=>p("customType",S.target.value),placeholder:"Ex: Yaourt fermenté, Boisson probiotique...",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}):o.jsx("select",{value:s.type,onChange:S=>p("type",S.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:A.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Unité de vente *"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{type:"button",onClick:()=>d(!1),className:`px-3 py-1 text-sm rounded-lg transition-colors ${u?"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600":"bg-sage-600 text-white"}`,children:"Prédéfini"}),o.jsx("button",{type:"button",onClick:()=>d(!0),className:`px-3 py-1 text-sm rounded-lg transition-colors ${u?"bg-sage-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:"Personnalisé"})]}),u?o.jsx("input",{type:"text",value:s.customUnit,onChange:S=>p("customUnit",S.target.value),placeholder:"Ex: bouteille, pot, sachet, kg...",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"}):o.jsx("select",{value:s.unit,onChange:S=>p("unit",S.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent",children:P.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),o.jsx("textarea",{value:s.description,onChange:S=>p("description",S.target.value),placeholder:"Description du produit, ingrédients, bienfaits...",rows:3,className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent resize-none"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(z1,{className:"w-4 h-4 inline mr-1"}),"Prix (Ariary) *"]}),o.jsx("input",{type:"number",min:"0",step:"1000",value:s.price,onChange:S=>p("price",S.target.value),placeholder:"9000",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(gp,{className:"w-4 h-4 inline mr-1"}),"Stock actuel *"]}),o.jsx("input",{type:"number",min:"0",value:s.inStock,onChange:S=>p("inStock",S.target.value),placeholder:"50",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[o.jsx(Vs,{className:"w-4 h-4 inline mr-1"}),"Stock minimum *"]}),o.jsx("input",{type:"number",min:"0",value:s.minStock,onChange:S=>p("minStock",S.target.value),placeholder:"10",className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-sage-500 focus:border-transparent"})]})]}),s.price&&o.jsx("div",{className:"p-4 bg-sage-50 dark:bg-sage-900/20 rounded-xl",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Prix de vente"}),o.jsxs("span",{className:"text-lg font-bold text-sage-600 dark:text-sage-400",children:[new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(parseInt(s.price)||0)," / ",u&&s.customUnit.trim()?s.customUnit.trim():s.unit==="liter"?"litre":"pièce"]})]})})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:_,disabled:!s.name.trim()||!s.price||!s.inStock||!s.minStock||a&&!s.customType.trim()||u&&!s.customUnit.trim()||f,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${!s.name.trim()||!s.price||!s.inStock||!s.minStock||a&&!s.customType.trim()||u&&!s.customUnit.trim()||f?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-sage-600 hover:bg-sage-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-sage-600/25"}`,children:[o.jsx(ea,{className:`w-4 h-4 ${f?"animate-pulse":""}`}),o.jsx("span",{children:f?"Enregistrement...":"Enregistrer les modifications"})]})]})]})})},IP=({isOpen:t,onClose:e,order:r,onValidate:n})=>{const[s,i]=L.useState("pending"),[a,c]=L.useState(!1);if(!t||!r)return null;const u=p=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(p),d=p=>new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric"}).format(p),f=async()=>{c(!0);try{await n(r.id,s),e()}catch(p){console.error("Erreur lors de la validation:",p),alert("Erreur lors de la validation de la commande")}finally{c(!1)}},g=p=>{switch(p){case"mvola":return"MVola";case"orange-money":return"Orange Money";case"airtel-money":return"Airtel Money";case"cash":return"Espèces";case"transfer":return"Virement";case"check":return"Chèque";default:return p}};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-emerald-600 to-emerald-700 rounded-full flex items-center justify-center text-white",children:o.jsx(No,{className:"w-5 h-5"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Validation de commande"}),o.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Commande #",r.id]})]})]}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Résumé de la commande"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(ta,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Client"}),o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.customerName})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Yo,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Date de livraison"}),o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.deliveryDate?d(r.deliveryDate):"Non définie"})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(bs,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Méthode de paiement"}),o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:g(r.paymentMethod||"cash")})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(xt,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total"}),o.jsx("p",{className:"font-bold text-lg text-emerald-600 dark:text-emerald-400",children:u(r.totalAmount)})]})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Articles commandés"}),o.jsx("div",{className:"space-y-2",children:(Array.isArray(r.items)?r.items:[]).map((p,_)=>o.jsxs("div",{className:"flex justify-between items-center text-sm",children:[o.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[p.quantity,"x ",p.productName]}),o.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:u(p.totalPrice)})]},_))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Statut du paiement après validation"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 dark:border-gray-700 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800/50 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"paymentStatus",value:"paid",checked:s==="paid",onChange:p=>i(p.target.value),className:"w-4 h-4 text-emerald-600 focus:ring-emerald-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Paiement reçu"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Le client a déjà payé la commande"})]})]}),o.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 dark:border-gray-700 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800/50 cursor-pointer",children:[o.jsx("input",{type:"radio",name:"paymentStatus",value:"pending",checked:s==="pending",onChange:p=>i(p.target.value),className:"w-4 h-4 text-amber-600 focus:ring-amber-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Paiement en attente"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Le paiement sera effectué à la livraison"})]})]})]})]}),o.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Vs,{className:"w-5 h-5 text-amber-600 dark:text-amber-400 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-amber-800 dark:text-amber-300 mb-1",children:"Validation de commande"}),o.jsx("p",{className:"text-amber-700 dark:text-amber-400 text-sm",children:'Une fois validée, la commande passera au statut "Confirmée" et pourra être préparée pour la livraison. Cette action ne peut pas être annulée.'})]})]})})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:f,disabled:a,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${a?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-emerald-600 hover:bg-emerald-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-emerald-600/25"}`,children:[o.jsx(No,{className:`w-4 h-4 ${a?"animate-pulse":""}`}),o.jsx("span",{children:a?"Validation...":"Valider la commande"})]})]})]})})},NP=({isOpen:t,onClose:e,order:r,onValidate:n})=>{const[s,i]=L.useState(!1);if(!t||!r)return null;const a=f=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"MGA",minimumFractionDigits:0,maximumFractionDigits:0}).format(f),c=f=>new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric"}).format(f),u=async()=>{i(!0);try{await n(r.id),e()}catch(f){console.error("Erreur lors de la validation du paiement:",f),alert("Erreur lors de la validation du paiement")}finally{i(!1)}},d=f=>{switch(f){case"mvola":return"MVola";case"orange-money":return"Orange Money";case"airtel-money":return"Airtel Money";case"cash":return"Espèces";case"transfer":return"Virement";case"check":return"Chèque";default:return f}};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-full flex items-center justify-center text-white",children:o.jsx(bs,{className:"w-5 h-5"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Validation de paiement"}),o.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Commande #",r.id]})]})]}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:o.jsx(pt,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:[o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Résumé de la commande"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(ta,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Client"}),o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.customerName})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Yo,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Date de commande"}),o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:c(r.orderDate)})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(bs,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Méthode de paiement"}),o.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:d(r.paymentMethod||"cash")})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(xt,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Montant à encaisser"}),o.jsx("p",{className:"font-bold text-lg text-blue-600 dark:text-blue-400",children:a(r.totalAmount)})]})]})]}),o.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-3",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Vs,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}),o.jsx("span",{className:"text-sm font-medium text-amber-800 dark:text-amber-300",children:"Statut actuel: Paiement en attente"})]})})]}),o.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(No,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-1",children:"Confirmation de paiement"}),o.jsxs("p",{className:"text-blue-700 dark:text-blue-400 text-sm",children:["Confirmez-vous avoir reçu le paiement de ",o.jsx("strong",{children:a(r.totalAmount)}),"de la part de ",o.jsx("strong",{children:r.customerName})," ?"]}),o.jsx("p",{className:"text-blue-600 dark:text-blue-500 text-xs mt-2",children:'Cette action marquera le paiement comme "Payé" et ne pourra pas être annulée.'})]})]})})]}),o.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-800",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors",children:"Annuler"}),o.jsxs("button",{onClick:u,disabled:s,className:`flex items-center space-x-2 px-6 py-2 rounded-lg font-medium transition-all ${s?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":"bg-blue-600 hover:bg-blue-700 text-white hover:scale-105 hover:shadow-lg hover:shadow-blue-600/25"}`,children:[o.jsx(bs,{className:`w-4 h-4 ${s?"animate-pulse":""}`}),o.jsx("span",{children:s?"Validation...":"Confirmer le paiement reçu"})]})]})]})})},SP=[{id:"1",name:"Kéfir de lait traditionnel",type:"milk-kefir",description:"Kéfir de lait traditionnel, riche en probiotiques naturels",price:9e3,unit:"liter",inStock:50,minStock:10},{id:"2",name:"Kéfir de lait au chia",type:"milk-kefir",description:"Kéfir de lait enrichi aux graines de chia",price:11e3,unit:"liter",inStock:30,minStock:10},{id:"3",name:"Kombucha nature",type:"kombucha",description:"Kombucha traditionnel non aromatisé",price:6e3,unit:"liter",inStock:40,minStock:15},{id:"4",name:"Kombucha aromatisé - Pomme",type:"kombucha",description:"Kombucha saveur pomme",price:9e3,unit:"liter",inStock:25,minStock:10},{id:"5",name:"Kombucha aromatisé - Prune",type:"kombucha",description:"Kombucha saveur prune",price:9e3,unit:"liter",inStock:20,minStock:8},{id:"6",name:"Kombucha aromatisé - Raketa",type:"kombucha",description:"Kombucha saveur raketa (fruit local)",price:9e3,unit:"liter",inStock:18,minStock:8},{id:"7",name:"Kombucha aromatisé - Pokpok",type:"kombucha",description:"Kombucha saveur pokpok (fruit local)",price:9e3,unit:"liter",inStock:22,minStock:8},{id:"8",name:"Kombucha aromatisé - Fraise",type:"kombucha",description:"Kombucha saveur fraise",price:9e3,unit:"liter",inStock:28,minStock:10},{id:"9",name:"Kombucha aromatisé - Letchis",type:"kombucha",description:"Kombucha saveur letchis",price:9e3,unit:"liter",inStock:15,minStock:8},{id:"10",name:"Kombucha aromatisé - Hibiscus",type:"kombucha",description:"Kombucha aux fleurs d'hibiscus",price:9e3,unit:"liter",inStock:20,minStock:8},{id:"11",name:"Kombucha aromatisé - Kaki",type:"kombucha",description:"Kombucha saveur kaki",price:9e3,unit:"liter",inStock:16,minStock:8},{id:"12",name:"Kéfir de fruits",type:"water-kefir",description:"Kéfir de fruits rafraîchissant",price:6e3,unit:"liter",inStock:35,minStock:12},{id:"13",name:"Fromage de kéfir 100g",type:"cheese",description:"Fromage frais à base de kéfir - format 100g",price:6e3,unit:"piece",inStock:40,minStock:15},{id:"14",name:"Fromage de kéfir 200g",type:"cheese",description:"Fromage frais à base de kéfir - format 200g",price:12e3,unit:"piece",inStock:25,minStock:10},{id:"15",name:"Graines de chia 250g",type:"accessories",description:"Graines de chia premium - sachet de 250g",price:2e4,unit:"piece",inStock:20,minStock:5},{id:"16",name:"Légumes lactofermentés",type:"fermented-vegetables",description:"Légumes fermentés traditionnels en pot",price:1e4,unit:"piece",inStock:30,minStock:8}],AP=[{id:"1",name:"Marie Dubois",email:"marie.dubois@email.com",phone:"+261 32 12 345 67",address:{street:"15 rue des Lilas",city:"Antananarivo",postalCode:"101",country:"Madagascar",deliveryInstructions:"Laisser devant la porte si absent"},tags:["client-fidèle","kéfir-lait","livraison-hebdomadaire"],notes:[],starred:!0,relationship:"Cliente fidèle",sentiment:"positive",customerSince:new Date("2023-03-15"),totalSpent:47e4,averageOrderValue:37e3,lastOrderDate:new Date("2024-01-08"),orderFrequency:"weekly",preferredProducts:["1","2"],deliveryPreferences:{preferredDay:"saturday",preferredTime:"morning",frequency:"weekly",nextDelivery:new Date("2024-01-13")},paymentMethod:"card",customerStatus:"active"},{id:"2",name:"Pierre Martin",email:"p.martin@gmail.com",phone:"+261 33 98 765 43",address:{street:"42 avenue de la République",city:"Fianarantsoa",postalCode:"301",country:"Madagascar"},tags:["nouveau-client","kéfir-eau","bio"],notes:[],starred:!1,relationship:"Nouveau client",sentiment:"positive",customerSince:new Date("2024-01-05"),totalSpent:64e3,averageOrderValue:32e3,lastOrderDate:new Date("2024-01-05"),orderFrequency:"bi-weekly",preferredProducts:["3","4"],deliveryPreferences:{preferredDay:"wednesday",preferredTime:"evening",frequency:"bi-weekly",nextDelivery:new Date("2024-01-17")},paymentMethod:"transfer",customerStatus:"active"},{id:"3",name:"Sophie Leroy",email:"sophie.leroy@outlook.fr",phone:"+261 34 11 223 34",address:{street:"8 place Bellecour",city:"Toamasina",postalCode:"501",country:"Madagascar",deliveryInstructions:"Sonner à l'interphone - Apt 3B"},tags:["client-premium","commandes-importantes","événements"],notes:[],starred:!0,relationship:"Cliente premium",sentiment:"positive",customerSince:new Date("2023-06-20"),totalSpent:913500,averageOrderValue:76125,lastOrderDate:new Date("2024-01-06"),orderFrequency:"weekly",preferredProducts:["1","2","3","5"],deliveryPreferences:{preferredDay:"friday",preferredTime:"afternoon",frequency:"weekly",nextDelivery:new Date("2024-01-12")},paymentMethod:"orange-money",customerStatus:"active"}],CP=[{id:"1",customerId:"1",customerName:"Marie Dubois",orderDate:new Date("2024-01-08"),deliveryDate:new Date("2024-01-13"),status:"confirmed",items:[{productId:"1",productName:"Kéfir de lait traditionnel",quantity:2,unitPrice:9e3,totalPrice:18e3},{productId:"3",productName:"Kombucha nature",quantity:2,unitPrice:6e3,totalPrice:12e3}],totalAmount:3e4,paymentStatus:"paid",paymentMethod:"card",deliveryAddress:{street:"15 rue des Lilas",city:"Antananarivo",postalCode:"101",country:"Madagascar"}},{id:"2",customerId:"3",customerName:"Sophie Leroy",orderDate:new Date("2024-01-06"),deliveryDate:new Date("2024-01-12"),status:"pending",items:[{productId:"1",productName:"Kéfir de lait traditionnel",quantity:4,unitPrice:9e3,totalPrice:36e3},{productId:"4",productName:"Kombucha aromatisé - Pomme",quantity:3,unitPrice:9e3,totalPrice:27e3},{productId:"15",productName:"Graines de chia 250g",quantity:1,unitPrice:2e4,totalPrice:2e4}],totalAmount:83e3,paymentStatus:"pending",paymentMethod:"card",deliveryAddress:{street:"8 place Bellecour",city:"Toamasina",postalCode:"501",country:"Madagascar"},notes:"Commande pour événement familial"}],rh=[{id:"1",orderId:"2",customerId:"3",customerName:"Sophie Leroy",scheduledDate:new Date("2024-01-12"),status:"scheduled",address:{street:"8 place Bellecour",city:"Toamasina",postalCode:"501",country:"Madagascar",deliveryInstructions:"Sonner à l'interphone - Apt 3B"},items:[{productId:"1",productName:"Kéfir de lait traditionnel",quantity:4,unitPrice:9e3,totalPrice:36e3},{productId:"4",productName:"Kombucha aromatisé - Pomme",quantity:3,unitPrice:9e3,totalPrice:27e3}],route:"Centre Antananarivo"},{id:"2",orderId:"1",customerId:"1",customerName:"Marie Dubois",scheduledDate:new Date("2024-01-13"),status:"scheduled",address:{street:"15 rue des Lilas",city:"Antananarivo",postalCode:"101",country:"Madagascar",deliveryInstructions:"Laisser devant la porte si absent"},items:[{productId:"1",productName:"Kéfir de lait traditionnel",quantity:2,unitPrice:9e3,totalPrice:18e3}],route:"Nord Antananarivo"}],RP=[{id:"1",contactId:"2",contactName:"Pierre Martin",message:"Relancer pour nouvelle commande - client potentiel régulier",date:new Date("2024-01-15"),completed:!1,type:"reorder"},{id:"2",contactId:"1",contactName:"Marie Dubois",message:"Vérifier satisfaction après livraison",date:new Date("2024-01-14"),completed:!1,type:"follow-up"},{id:"3",contactId:"3",contactName:"Sophie Leroy",message:"Confirmer paiement commande #2",date:new Date("2024-01-11"),completed:!1,type:"payment"}],PP=()=>{const[t,e]=L.useState(!1),[r,n]=L.useState([]),s=()=>{const d=JSON.parse(localStorage.getItem("firebase-logs")||"[]");n(d.reverse())},i=()=>{localStorage.removeItem("firebase-logs"),n([])},a=()=>{const d=JSON.stringify(r,null,2),f=new Blob([d],{type:"application/json"}),g=URL.createObjectURL(f),p=document.createElement("a");p.href=g,p.download=`firebase-logs-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(g)};Af.useEffect(()=>{t&&s()},[t]);const c=d=>d?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400",u=d=>{switch(d){case"ADD":return"➕";case"UPDATE":return"🔄";case"DELETE":return"🗑️";case"MIGRATE":return"📦";default:return"🔥"}};return o.jsxs("div",{className:"fixed bottom-4 right-4 z-50",children:[o.jsxs("button",{onClick:()=>e(!t),className:"flex items-center space-x-2 bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-lg shadow-lg transition-colors",children:[o.jsx(MR,{className:"w-4 h-4"}),o.jsx("span",{children:"Debug"}),t?o.jsx(U1,{className:"w-4 h-4"}):o.jsx(FR,{className:"w-4 h-4"})]}),t&&o.jsxs("div",{className:"absolute bottom-12 right-0 w-96 max-h-96 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-lg shadow-xl overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800",children:[o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Firebase Logs"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:a,className:"p-1 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:"Télécharger les logs",children:o.jsx(B1,{className:"w-4 h-4"})}),o.jsx("button",{onClick:i,className:"p-1 text-gray-500 hover:text-red-600 dark:hover:text-red-400",title:"Effacer les logs",children:o.jsx(G1,{className:"w-4 h-4"})})]})]}),o.jsx("div",{className:"max-h-80 overflow-y-auto",children:r.length===0?o.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"Aucun log disponible"}):r.map((d,f)=>o.jsxs("div",{className:"p-3 border-b border-gray-100 dark:border-gray-800 last:border-b-0",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{children:u(d.operation)}),o.jsxs("span",{className:"font-medium text-sm text-gray-900 dark:text-white",children:[d.operation," - ",d.collection]})]}),o.jsx("span",{className:`text-xs font-medium ${c(d.success)}`,children:d.success?"✅":"❌"})]}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:new Date(d.timestamp).toLocaleString("fr-FR")}),d.error&&o.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 p-2 rounded",children:d.error})]},f))})]})]})};function jP(){const{contacts:t,products:e,orders:r,notes:n,reminders:s,vendorInfo:i,loading:a,error:c,addContact:u,updateContact:d,deleteContact:f,addProduct:g,updateProduct:p,deleteProduct:_,addOrder:A,updateOrder:P,addNote:S,updateReminder:w,saveVendorInfo:k}=jR(),[I,N]=L.useState(!1),[O,F]=L.useState(!1),[x,y]=L.useState(!1),[E,T]=L.useState("dashboard"),[C,R]=L.useState(!1),[b,ce]=L.useState(!1),[rr,xr]=L.useState(!1),[Rt,$]=L.useState(!1),[Y,ee]=L.useState(!1),[_e,he]=L.useState(!1),[Ne,$t]=L.useState(!1),[nr,qt]=L.useState(!1),[sr,Jo]=L.useState(!1),[Yu,rs]=L.useState(!1),[Hs,Ws]=L.useState(!1),[vr,dn]=L.useState(AP),[Fr,Ks]=L.useState(CP),[ns,ra]=L.useState(SP),[Gs,na]=L.useState([]),[Qs,Xu]=L.useState(RP),[Ys,sa]=L.useState({name:"Kéfir Madagascar SARL",address:"Lot II M 15 Bis Antanimena, 101 Antananarivo, Madagascar",phone:"+261 32 12 345 67",email:"contact@kefir-madagascar.mg",nif:"1234567890123",stat:"12345 12 2023 0 12345"}),wt=O&&x?t:vr,ye=O&&x?r:Fr,Fe=O&&x?e:ns,Xs=O&&x?n:Gs,Zo=O&&x?s:Qs,ia=O&&x?i:Ys,[Ju,hn]=L.useState(null),[ss,ir]=L.useState(null),[aa,el]=L.useState(null);Af.useEffect(()=>{!localStorage.getItem("firebase-migration-shown")&&!a&&t.length===0?(N(!0),localStorage.setItem("firebase-migration-shown","true")):t.length>0&&(F(!0),y(!0))},[a,t.length]);const Zu={totalRevenue:wt.reduce((z,q)=>z+q.totalSpent,0),monthlyRevenue:ye.filter(z=>z.orderDate.getMonth()===new Date().getMonth()).reduce((z,q)=>z+q.totalAmount,0),totalCustomers:wt.length,activeCustomers:wt.filter(z=>z.customerStatus==="active").length,averageOrderValue:ye.length>0?ye.reduce((z,q)=>z+q.totalAmount,0)/ye.length:0,topProducts:Fe.map(z=>({productId:z.id,productName:z.name,quantity:ye.reduce((q,Se)=>{var _r;return q+(((_r=(Array.isArray(Se.items)?Se.items:[]).find(Ht=>Ht.productId===z.id))==null?void 0:_r.quantity)||0)},0),revenue:ye.reduce((q,Se)=>{var _r;return q+(((_r=(Array.isArray(Se.items)?Se.items:[]).find(Ht=>Ht.productId===z.id))==null?void 0:_r.totalPrice)||0)},0)})).sort((z,q)=>q.revenue-z.revenue),topCustomers:wt.map(z=>({customerId:z.id,customerName:z.name,totalSpent:z.totalSpent,orderCount:ye.filter(q=>q.customerId===z.id).length})).sort((z,q)=>q.totalSpent-z.totalSpent),deliveryStats:{onTime:rh.filter(z=>z.status==="delivered").length,delayed:0,failed:rh.filter(z=>z.status==="failed").length}},oa=z=>{if(O&&x){const q=wt.find(Se=>Se.id===z);q&&d(z,{starred:!q.starred})}else dn(vr.map(q=>q.id===z?{...q,starred:!q.starred}:q))},tl=z=>{O&&x?w(z,{completed:!0}):Xu(Qs.map(q=>q.id===z?{...q,completed:!0}:q))},la=z=>{hn(z),xr(!0)},is=z=>{if(O&&x)return S(z).then(()=>d(z.contactId,{lastContact:new Date})).catch(q=>{console.error("Erreur lors de la sauvegarde de la note:",q),alert("Erreur lors de la sauvegarde de la note. Veuillez réessayer.")});{const q={...z,id:Math.random().toString(36).substr(2,9)};na([...Gs,q]),dn(vr.map(Se=>Se.id===z.contactId?{...Se,lastContact:new Date,notes:[...Se.notes,q]}:Se))}},ca=z=>{if(O&&x)return u({...z,notes:[],totalSpent:0,averageOrderValue:0,preferredProducts:[],deliveryPreferences:{preferredDay:"saturday",preferredTime:"morning",frequency:"weekly"}}).catch(q=>{console.error("Erreur lors de la sauvegarde du contact:",q),alert("Erreur lors de la sauvegarde du contact. Veuillez réessayer.")});{const q={...z,id:Math.random().toString(36).substr(2,9),notes:[],totalSpent:0,averageOrderValue:0,preferredProducts:[],deliveryPreferences:{preferredDay:"saturday",preferredTime:"morning",frequency:"weekly"}};dn([...vr,q])}},ua=z=>{O&&x?d(z.id,z).catch(q=>{console.error("Erreur lors de la mise à jour du contact:",q),alert("Erreur lors de la mise à jour du contact. Veuillez réessayer.")}):dn(vr.map(q=>q.id===z.id?z:q))},Ur=z=>{if(O&&x)return A(z).catch(q=>{console.error("Erreur lors de la sauvegarde de la commande:",q),alert("Erreur lors de la sauvegarde de la commande. Veuillez réessayer.")});{const q={...z,id:Math.random().toString(36).substr(2,9)};Ks([...Fr,q])}},rl=z=>{if(O&&x)return g(z).catch(q=>{console.error("Erreur lors de la sauvegarde du produit:",q),alert("Erreur lors de la sauvegarde du produit. Veuillez réessayer.")});{const q={...z,id:Math.random().toString(36).substr(2,9)};ra([...ns,q])}},Js=z=>{ir(z),$(!0)},nl=z=>{console.log("Modifier commande",z)},as=z=>{ir(z),rs(!0)},sl=z=>{ir(z),Ws(!0)},Xe=async(z,q)=>{if(O&&x)try{await P(z,{status:"confirmed",paymentStatus:q})}catch(Se){throw console.error("Erreur lors de la validation de la commande:",Se),Se}else Ks(Fr.map(Se=>Se.id===z?{...Se,status:"confirmed",paymentStatus:q}:Se))},il=async z=>{if(O&&x)try{await P(z,{paymentStatus:"paid"})}catch(q){throw console.error("Erreur lors de la validation du paiement:",q),q}else Ks(Fr.map(q=>q.id===z?{...q,paymentStatus:"paid"}:q))},os=z=>{confirm("Êtes-vous sûr de vouloir supprimer ce produit ?")&&(O&&x?_(z).catch(q=>{console.error("Erreur lors de la suppression du produit:",q),alert("Erreur lors de la suppression du produit. Veuillez réessayer.")}):ra(ns.filter(q=>q.id!==z)))},ls=z=>{el(z),Jo(!0)},ed=z=>{O&&x?p(z.id,z).catch(q=>{console.error("Erreur lors de la mise à jour du produit:",q),alert("Erreur lors de la mise à jour du produit. Veuillez réessayer.")}):ra(ns.map(q=>q.id===z.id?z:q))},td=z=>{ir(z),he(!0)},fn=()=>{F(!0),y(!0)},rd=z=>{O&&x?k(z).catch(q=>{console.error("Erreur lors de la sauvegarde des informations vendeur:",q),alert("Erreur lors de la sauvegarde des informations vendeur. Veuillez réessayer.")}):sa(z)};if(a&&!x)return o.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sage-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Chargement de l'application..."})]})});const nd=()=>{switch(E){case"dashboard":return o.jsx(dP,{customers:wt,orders:ye,deliveries:rh,analytics:Zu,reminders:Zo,onContactClick:la,onReminderComplete:tl});case"contacts":return o.jsx(fP,{contacts:wt,onContactClick:la,onToggleStar:oa,onAddContact:()=>ce(!0)});case"orders":return o.jsx(mP,{orders:ye,customers:wt,products:Fe,onCreateOrder:()=>$t(!0),onViewOrder:Js,onEditOrder:nl,onValidateOrder:as,onValidatePayment:sl,onShowReceipt:td});case"products":return o.jsx(pP,{products:Fe,onAddProduct:()=>qt(!0),onEditProduct:ls,onDeleteProduct:os});case"timeline":return o.jsx(gP,{notes:Xs,contacts:wt});default:return null}};return o.jsxs(iP,{children:[o.jsx(uP,{activeTab:E,onTabChange:T,onNewNote:()=>R(!0),onVendorSettings:()=>ee(!0),children:nd()}),o.jsx(yP,{isOpen:C,onClose:()=>R(!1),contacts:wt,onSave:is}),o.jsx(xP,{isOpen:b,onClose:()=>ce(!1),onSave:ca}),o.jsx(vP,{isOpen:rr,onClose:()=>{xr(!1),hn(null)},contact:Ju,onSave:ua}),o.jsx(_P,{isOpen:Rt,onClose:()=>{$(!1),ir(null)},order:ss}),o.jsx(wP,{isOpen:Y,onClose:()=>ee(!1),vendorInfo:ia,onSave:rd}),o.jsx(kP,{isOpen:_e,onClose:()=>{he(!1),ir(null)},order:ss,vendorInfo:ia}),o.jsx(bP,{isOpen:Ne,onClose:()=>$t(!1),customers:wt,products:Fe,onSave:Ur}),o.jsx(EP,{isOpen:nr,onClose:()=>qt(!1),onSave:rl}),o.jsx(TP,{isOpen:sr,onClose:()=>{Jo(!1),el(null)},product:aa,onSave:ed}),o.jsx(IP,{isOpen:Yu,onClose:()=>{rs(!1),ir(null)},order:ss,onValidate:Xe}),o.jsx(NP,{isOpen:Hs,onClose:()=>{Ws(!1),ir(null)},order:ss,onValidate:il}),o.jsx(nP,{isOpen:I,onClose:()=>N(!1),localData:{contacts:vr,products:ns,orders:Fr,notes:Gs,reminders:Qs,vendorInfo:Ys},onMigrationComplete:fn}),o.jsx(PP,{})]})}u_(document.getElementById("root")).render(o.jsx(L.StrictMode,{children:o.jsx(oP,{children:o.jsx(RR,{children:o.jsx(jP,{})})})}));
